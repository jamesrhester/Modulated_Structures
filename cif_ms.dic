#\#CIF_2.0
################################################################################
#                                                                              #
#                   CIF Dictionary for Modulated Structures                    #
#                   ---------------------------------------                    #
#                                                                              #
#  CIF data definitions specifically for Modulated Structures. These are in    #
#  addition to those defined in the CIF Core Dictionary version 2.3 (2003).    #
#                                                                              #
#  The data included in this dictionary are intended to fulfil the Checklist   #
#  for the Description of Incommensurate Modulated Crystal Structures,         #
#  published by the Commission on Aperiodic Crystals. Acta Cryst. (1997),      #
#  A53, 95-100.                                                                #
#                                                                              #
#                                                                              #
#                                                                              #
#  The DDL1 version of this dictionary was converted to DDLm on 27 June 2014.  #
#                                                                              #
################################################################################

data_CIF_MS

    _dictionary.title             CIF_MS
    _dictionary.formalism         Modulated
    _dictionary.class             Instance
    _dictionary.version           3.2.4
    _dictionary.date              2024-12-12
    _dictionary.uri               http://www.iucr.org/cif/dic/cif_ms.dic
    _dictionary.ddl_conformance   4.1.0
    _dictionary.namespace         ModStruct
    _description.text
;
       The DICTIONARY group encompassing the definitions of data items
       for the study of modulated structures with the Crystallographic
       Information Framework (CIF).
;

save_CIF_MS_HEAD

    _definition.id                CIF_MS_HEAD
    _definition.scope             Category
    _definition.class             Head
    _definition.update            2024-08-09
    _description.text
;
      Encompasses groups of categories applicable to modulated structures.
;
    _name.category_id             CIF_MS
    _name.object_id               CIF_MS_HEAD

    _import.get
        [{'dupl':Ignore 'file':cif_core.dic 'mode':Full 'save':CIF_CORE_HEAD}]

save_

save_atom_site.displace_modulation_flag

    _definition.id                '_atom_site.displace_modulation_flag'
    _alias.definition_id          '_atom_site_displace_modulation_flag'
    _definition.update            2014-06-27
    _description.text
;
      A code that signals whether the structural model includes the
      modulation of the positional coordinates of a given atom site.
;
    _name.category_id             atom_site
    _name.object_id               displace_modulation_flag
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         yes                      'displacive modulation'
         y                        'abbreviation for "yes"'
         no                       'no displacive modulation'
         n                        'abbreviation for "no"'

    _enumeration.default          no

save_

save_atom_site.occ_modulation_flag

    _definition.id                '_atom_site.occ_modulation_flag'
    _alias.definition_id          '_atom_site_occ_modulation_flag'
    _definition.update            2014-06-27
    _description.text
;
      A code that signals whether the structural model includes the
      modulation of the occupation of a given atom site.
;
    _name.category_id             atom_site
    _name.object_id               occ_modulation_flag
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         yes                      'occupational modulation'
         y                        'abbreviation for "yes"'
         no                       'no occupational modulation'
         n                        'abbreviation for "no"'

    _enumeration.default          no

save_

save_atom_site.subsystem_code

    _definition.id                '_atom_site.subsystem_code'
    _alias.definition_id          '_atom_site_subsystem_code'
    _definition.update            2014-06-27
    _description.text
;
      A code that links a given atom or rigid-group site to one of the
      subsystems present in a composite. This code provides an
      alternative description for composites which is less explicit
      than that based on linked data blocks (see the description in
      this dictionary of audit_link.*). It must match one of
      the labels specified for _cell_subsystem.code.
;
    _name.category_id             atom_site
    _name.object_id               subsystem_code
    _name.linked_item_id          '_cell_subsystem.code'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site.u_modulation_flag

    _definition.id                '_atom_site.U_modulation_flag'
    _alias.definition_id          '_atom_site_U_modulation_flag'
    _definition.update            2014-06-27
    _description.text
;
      A code that signals whether the structural model includes the
      modulation of the ADP of a given atom site.
;
    _name.category_id             atom_site
    _name.object_id               U_modulation_flag
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         yes                      'modulation of ADP'
         y                        'abbreviation for "yes"'
         no                       'no modulation of ADP'
         n                        'abbreviation for "no"'

    _enumeration.default          no

save_

save_ATOM_SITE_ANHARMONIC_ADP

    _definition.id                ATOM_SITE_ANHARMONIC_ADP
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_ANHARMONIC_ADP category record details
      about the anharmonic corrections of ADPs of an atom site.
      Among the different expansions used to handle those corrections
      (see for example, Kuznetsov, 1960, Kuhs, 1992, Brown et al., 2014
      and references therein) the Gram-Charlier parameterization has been
      chosen, as it is the one implemented in the package JANA (Petricek et al.,
      2014, Petricek et al., 2023). Within this approximation the generalized
      ADPs are written as:

      T(H) = Ta(H)[1 - iC^jkl h_jh_kh_l + D^jklm h_jh_kh_lh_m +

             i E^jklmn h_jh_kh_lh_mh_n - F^jklmnp h_jh_kh_lh_mh_nh_p ...]

      where Ta(H) is the ADP in the harmonic approximation. C^jkl, D^jklm,
      D^jklm, F^jklmn, ... are the contravariant components of the
      corresponding symmetrical (for all permutations of indices) tensors
      of order 3, 4, 5, 6, ... h_j represents the Miller indices, with j=1,2,3.

      In this version of the dictionary, by practical reasons, tensors
      of order higher than 6 have not been considered. Owing to the atomic
      environment variation induced by the modulation, the components of
      the tensors describing the anharmonicity could become also modulated.
      In that case, the additional modulation parameters would be
      described by items belong to the _ATOM_SITE_ANHARMONIC_ADP_FOURIER
      category.

      References: Kuznetsov, P.I., Stratonovich, R.L. & Tikhonov, V.I. (1960).
                  Theory of Probability & Its Applications 5(1), 80-97.
                  DOI 10.1137/1105007
                  Quasi-Moment Functions in the Theory of Random Processes

                  Kuhs, W.F. (1998). Acta Cryst. A 48(2), 80-98.
                  DOI 10.1107/S0108767391009510
                  Generalized atomic displacements in crystallographic
                  structure analysis

                  Brown, P.J., Fox, A.G., Maslen, E.N., O'Keefe, M.A. &
                  Willis, B.T.M. (2014). International Tables for
                  Crystallography Volume C: Mathematical, physical and
                  chemical tables. Edited by E. Prince, 554-585,
                  DOI 10.1107/97809553602060000600
                  Intensity of diffracted intensities

                  Petricek, V., Dusek, M. & Palatinus, L. (2014).
                  Z. Kristallogr. 229(5), 345-352.  DOI 10.1515/zkri-2014-1737
                  Crystallographic Computing System JANA2006: General features

                  Petricek, V., Palatinus, L., Plasil, J. & Dusek, M.  (2023).
                  Z. Kristallogr. 238(7-8), 271-282.  DOI 10.1515/zkri-2023-0005
                  Jana2020 - a new version of the crystallographic computing
                  system Jana

;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_ANHARMONIC_ADP

    loop_
      _category_key.name
         '_atom_site_anharmonic_ADP.atom_site_label'
         '_atom_site_anharmonic_ADP.tens_elem'

    loop_
      _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension        1

        loop_
          _atom_site.label
          _atom_site.type_symbol
          _atom_site.fract_x
          _atom_site.fract_y
          _atom_site.fract_z
          _atom_site.U_iso_or_equiv
          _atom_site.site_symmetry_multiplicity
          _atom_site.occupancy
          _atom_site.calc_flag
          Co1  Co          0.5            0             0  0.0259(10)  4  1  d
          O1   O   0.59580(13)  -0.07083(9)  -0.21413(13)   0.0280(4)  8  1  d
          O2   O   0.77265(13)  -0.05973(9)  -0.41846(12)   0.0272(3)  8  1  d
          O3   O   0.47451(14)   0.15486(9)  -0.12793(12)   0.0274(3)  8  1  d

        # - - - - data truncated for brevity - - - -

        loop_
          _atom_site_anharmonic_ADP.atom_site_label
          _atom_site_anharmonic_ADP.tens_elem
          _atom_site_anharmonic_ADP.coeff
          Co1 C111  0
          Co1 C112  0
          Co1 C113  0
          Co1 C122  0
          Co1 C123  0
          Co1 C133  0
          Co1 C222  0
          Co1 C223  0
          Co1 C233  0
          Co1 C333  0
          O2  C111 -0.0014(13)
          O2  C112 -0.0008(4)
          O2  C113 -0.0002(7)
          O2  C122  0.0002(3)
          O2  C123  0.0002(2)
          O2  C133 -0.0011(6)
          O2  C222  0.0001(4)
          O2  C223  0.0002(3)
          O2  C233  0.0005(3)
          O2  C333  0.0016(10)
          O1  C111  0.0045(9)
          O1  C112 -0.0003(3)
          O1  C113 -0.0011(5)
          O1  C122  0.0010(3)
          O1  C123 -0.0006(2)
          O1  C133  0.0012(6)
          O1  C222 -0.0001(4)
          O1  C223 -0.0006(3)
          O1  C233 -0.0001(4)
          O1  C333 -0.0039(13)
          O3  C111  0.0011(9)
          O3  C112  0.0008(3)
          O3  C113  0.0006(5)
          O3  C122  0.0000(3)
          O3  C123  0.0006(2)
          O3  C133  0.0007(5)
          O3  C222  0.0002(5)
          O3  C223  0.0003(3)
          O3  C233  0.0003(4)
          O3  C333  0.0004(10)
          N2  C111  0.0030(12)
          N2  C112  0
          N2  C113  0.0004(8)
          N2  C122  0.0009(4)
          N2  C123  0
          N2  C133  0.0017(10)
          N2  C222  0
          N2  C223  0.0005(4)
          N2  C233  0
          N2  C333  0.0006(17)

        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Laura Canadillas-Delgado, Lidia Mazzuca, Oscar Fabelo and
        Juan Rodriguez-Carvajal (2019) IUCrJ. 6, 105-115.
        doi:10.1107/S2052252518015026
        Incommensurate structures of the [CH~3~NH~3~][Co(COOH)~3~] compound
;
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension        1

        loop_
         _atom_site.label
         _atom_site.type_symbol
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.adp_type
         _atom_site.U_iso_or_equiv
         _atom_site.site_symmetry_multiplicity
         _atom_site.occupancy
         _atom_site.calc_flag
         _atom_site.refinement_flags_posn
         _atom_site.disorder_assembly
         _atom_site.disorder_group
          Pr1 Pr 0.16224(4) 0.5 0 Uani 0.00926(12) 4 1 d . . .
          Sb1 Sb 0.5 0.5 0.0234(5) Uani 0.0511(8) 4 0.5 d . . .
          O1 O 0.2504(3) 0 0 Uani 0.0112(9) 4 1 d . . .

        # - - - - data truncated for brevity - - - -

        loop_
          _atom_site_anharmonic_ADP.atom_site_label
          _atom_site_anharmonic_ADP.tens_elem
          _atom_site_anharmonic_ADP.coeff
          Sb D1111  0.00057(8)
          Sb D1112  0
          Sb D1113  0
          Sb D1122  0.0072(7)
          Sb D1123  0
          Sb D1133  0.008(2)
          Sb D1222  0
          Sb D1223  0
          Sb D1233  0
          Sb D1333  0
          Sb D2222  0.98(6)
          Sb D2223  0
          Sb D2233 -0.82(9)
          Sb D2333  0
          Sb D3333  0.24(12)

        # - - - - data truncated for brevity - - - -

        #=====================================================================

        Example based on the article:
        Oxana V. Magdysyuk, Jurgen Nuss and Martin Jansen (2013)
        Acta Cryst. B 69, 547-555. doi:10.1107/S2052519213029436
        Modulated crystal structure of Pr~2~SbO~2~
;
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site.label
         _atom_site.type_symbol
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.adp_type
         _atom_site.U_iso_or_equiv
         _atom_site.site_symmetry_multiplicity
         _atom_site.occupancy
         _atom_site.calc_flag
         Hf1  Hf          0          0           0  Uani    0.012(4)  4    1  d
         Pb1  Pb  0.0292(5)       0.75  0.50222(6)  Uani   0.0220(6)  8  0.5  d
         O1   O           0       0.75  0.0467(11)  Uani    0.009(3)  4    1  d
         O2   O        0.25  0.0227(6)        0.25  Uani  0.0197(19)  8    1  d

        # - - - - data truncated for brevity - - - -

            loop_
          _atom_site_anharmonic_ADP.atom_site_label
          _atom_site_anharmonic_ADP.tens_elem
          _atom_site_anharmonic_ADP.coeff
          Hf1 F111111  0.13(5)
          Hf1 F111112  0
          Hf1 F111113  0
          Hf1 F111122  0.005(5)
          Hf1 F111123 -0.0012(6)
          Hf1 F111133 -0.007(8)
          Hf1 F111222  0
          Hf1 F111223  0
          Hf1 F111233  0
          Hf1 F111333  0
          Hf1 F112222  0.018(8)
          Hf1 F112223  0.0000(3)
          Hf1 F112233  0.0002(15)
          Hf1 F112333  0.0000(4)
          Hf1 F113333  0.003(8)
          Hf1 F122222  0
          Hf1 F122223  0
          Hf1 F122233  0
          Hf1 F122333  0
          Hf1 F123333  0
          Hf1 F133333  0
          Hf1 F222222  0.08(6)
          Hf1 F222223  0.045(5)
          Hf1 F222233  0.004(4)
          Hf1 F222333  0.0003(8)
          Hf1 F223333  0.005(5)
          Hf1 F233333  0.003(2)
          Hf1 F333333  0.09(2)

        # - - - - data truncated for brevity - - - -

        #======================================================================

        Example based on the article:
        Alexei Bosak, Volodymir Svitlyk, Alla Arakcheeva, Roman Burkovskiy,
        Vadim Diadkin, Krystian Roleder and Dmitry Chernyshov (2020)
        Acta Cryst. B 76, 7-12. doi:10.1107/S205252061901494X
        Incommensurate crystal structure of PbHfO~3~
;

save_

save_atom_site_anharmonic_adp.atom_site_label

    _definition.id                '_atom_site_anharmonic_ADP.atom_site_label'
    _definition.update            2024-05-02
    _description.text
;
       The code that identifies an atom in a loop in which the Gram-Charlier
       tensor components describing the anharmonic corrections of ADPs
       are listed. This code must match the _atom_site.label of the
       associated coordinate list and conform to the rules described in
       _atom_site.label.
;
    _name.category_id             atom_site_anharmonic_ADP
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp.coeff

    _definition.id                '_atom_site_anharmonic_ADP.coeff'
    _definition.update            2024-04-11
    _description.text
;
       The contravariant component of the symmetric tensor given by
       _atom_site_anharmonic_ADP.tens_elem, appearing in the Gram-Charlier
       expansion of the atomic anharmonic ADPs.
;
    _name.category_id             atom_site_anharmonic_ADP
    _name.object_id               coeff
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_anharmonic_adp.coeff_su

    _definition.id                '_atom_site_anharmonic_ADP.coeff_su'
    _definition.update            2024-08-02
    _description.text
;
       Standard uncertainty of _atom_site_anharmonic_ADP.coeff
;
    _name.category_id             atom_site_anharmonic_ADP
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_anharmonic_ADP.coeff'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_anharmonic_adp.tens_elem

    _definition.id                '_atom_site_anharmonic_ADP.tens_elem'
    _definition.update            2024-08-06
    _description.text
;
       A label identifying each anharmonic ADP tensor element of a given
       atom.
;
    _name.category_id             atom_site_anharmonic_ADP
    _name.object_id               tens_elem
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         C111               'average value or modulation components of C111'
         C112               'average value or modulation components of C112'
         C113               'average value or modulation components of C113'
         C122               'average value or modulation components of C122'
         C123               'average value or modulation components of C123'
         C133               'average value or modulation components of C133'
         C222               'average value or modulation components of C222'
         C223               'average value or modulation components of C223'
         C233               'average value or modulation components of C233'
         C333               'average value or modulation components of C333'
         D1111              'average value or modulation components of D1111'
         D1112              'average value or modulation components of D1112'
         D1113              'average value or modulation components of D1113'
         D1122              'average value or modulation components of D1122'
         D1123              'average value or modulation components of D1123'
         D1133              'average value or modulation components of D1133'
         D1222              'average value or modulation components of D1222'
         D1223              'average value or modulation components of D1223'
         D1233              'average value or modulation components of D1233'
         D1333              'average value or modulation components of D1333'
         D2222              'average value or modulation components of D2222'
         D2223              'average value or modulation components of D2223'
         D2233              'average value or modulation components of D2233'
         D2333              'average value or modulation components of D2333'
         D3333              'average value or modulation components of D3333'
         E11111             'average value or modulation components of E11111'
         E11112             'average value or modulation components of E11112'
         E11113             'average value or modulation components of E11113'
         E11122             'average value or modulation components of E11122'
         E11123             'average value or modulation components of E11123'
         E11133             'average value or modulation components of E11133'
         E11222             'average value or modulation components of E11222'
         E11223             'average value or modulation components of E11223'
         E11233             'average value or modulation components of E11233'
         E11333             'average value or modulation components of E11333'
         E12222             'average value or modulation components of E12222'
         E12223             'average value or modulation components of E12223'
         E12233             'average value or modulation components of E12233'
         E12333             'average value or modulation components of E12333'
         E13333             'average value or modulation components of E13333'
         E22222             'average value or modulation components of E22222'
         E22223             'average value or modulation components of E22223'
         E22233             'average value or modulation components of E22233'
         E22333             'average value or modulation components of E22333'
         E23333             'average value or modulation components of E23333'
         F111111            'average value or modulation components of F111111'
         F111112            'average value or modulation components of F111112'
         F111113            'average value or modulation components of F111113'
         F111122            'average value or modulation components of F111122'
         F111123            'average value or modulation components of F111123'
         F111133            'average value or modulation components of F111133'
         F111222            'average value or modulation components of F111222'
         F111223            'average value or modulation components of F111223'
         F111233            'average value or modulation components of F111233'
         F111333            'average value or modulation components of F111333'
         F112222            'average value or modulation components of F112222'
         F112223            'average value or modulation components of F112223'
         F112233            'average value or modulation components of F112233'
         F112333            'average value or modulation components of F112333'
         F113333            'average value or modulation components of F113333'
         F122222            'average value or modulation components of F122222'
         F122223            'average value or modulation components of F122223'
         F122233            'average value or modulation components of F122233'
         F122333            'average value or modulation components of F122333'
         F123333            'average value or modulation components of F123333'
         F133333            'average value or modulation components of F133333'
         F222222            'average value or modulation components of F222222'
         F222223            'average value or modulation components of F222223'
         F222233            'average value or modulation components of F222233'
         F222333            'average value or modulation components of F222333'
         F223333            'average value or modulation components of F223333'
         F233333            'average value or modulation components of F233333'
         F333333            'average value or modulation components of F333333'

save_

save_ATOM_SITE_ANHARMONIC_ADP_FOURIER

    _definition.id                ATOM_SITE_ANHARMONIC_ADP_FOURIER
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
       Data items in the ATOM_SITE_ANHARMONIC_ADP_FOURIER category record
       details about the Fourier components of the tensors that describe
       the modulation of the anharmonic ADPs in a modulated structure.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_ANHARMONIC_ADP_FOURIER
    _category_key.name            '_atom_site_anharmonic_ADP_Fourier.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension        1

        loop_
          _cell_wave_vector.seq_id
          _cell_wave_vector.x
          _cell_wave_vector.y
          _cell_wave_vector.z
          1  0.000000  0.000000  0.143000

        loop_
          _atom_site.label
          _atom_site.type_symbol
          _atom_site.fract_x
          _atom_site.fract_y
          _atom_site.fract_z
          _atom_site.U_iso_or_equiv
          _atom_site.site_symmetry_multiplicity
          _atom_site.occupancy
          _atom_site.calc_flag
          Co1  Co          0.5            0             0  0.0259(10)  4  1  d
          O1   O   0.59580(13)  -0.07083(9)  -0.21413(13)   0.0280(4)  8  1  d
          O2   O   0.77265(13)  -0.05973(9)  -0.41846(12)   0.0272(3)  8  1  d
          O3   O   0.47451(14)   0.15486(9)  -0.12793(12)   0.0274(3)  8  1  d

        # - - - - data truncated for brevity - - - -

        loop_
          _atom_site_Fourier_wave_vector.seq_id
          _atom_site_Fourier_wave_vector.q1_coeff
          1  1
          2  2

        # - - - - data truncated for brevity - - - -

        loop_
          _atom_site_anharmonic_ADP_Fourier.id
          _atom_site_anharmonic_ADP_Fourier.atom_site_label
          _atom_site_anharmonic_ADP_Fourier.tens_elem
          _atom_site_anharmonic_ADP_Fourier.wave_vector_seq_id
          _atom_site_anharmonic_ADP_Fourier_param.cos
          _atom_site_anharmonic_ADP_Fourier_param.sin
           1 Co1   C111  1            0    -0.008(4)
           2 Co1   C112  1            0   0.0031(15)
           3 Co1   C113  1            0   0.0012(19)
           4 Co1   C122  1            0  -0.0018(11)
           5 Co1   C123  1            0    0.0009(9)
           6 Co1   C133  1            0   0.0004(19)
           7 Co1   C222  1            0   0.0013(17)
           8 Co1   C223  1            0  -0.0002(11)
           9 Co1   C233  1            0   0.0027(13)
          10 Co1   C333  1            0     0.005(3)
          11 O2    C111  1  -0.0016(13)   0.0020(14)
          12 O2    C112  1   -0.0001(5)    0.0003(5)

        #======================================================================

        Example based on the article:
        Laura Canadillas-Delgado, Lidia Mazzuca, Oscar Fabelo and
        Juan Rodriguez-Carvajal (2019) IUCrJ. 6, 105-115.
        doi:10.1107/S2052252518015026
        Incommensurate structures of the [CH~3~NH~3~][Co(COOH)~3~] compound
;

save_

save_atom_site_anharmonic_adp_fourier.atom_site_label

    _definition.id
        '_atom_site_anharmonic_ADP_Fourier.atom_site_label'
    _definition.update            2024-04-13
    _description.text
;
          The code the that identifies an atom in a loop in which the Fourier
          components of the tensors that parameterize its anharmonic ADP
          modulation are listed. This code must match the _atom_site.label of
          the associated coordinate list and conform to the rules described
          in _atom_site.label.
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp_fourier.id

    _definition.id                '_atom_site_anharmonic_ADP_Fourier.id'
    _definition.update            2024-04-13
    _description.text
;
       A code identifying each Fourier component used to describe
       the modulation of the tensors that parameterize an anharmonic
       ADP.
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp_fourier.tens_elem

    _definition.id                '_atom_site_anharmonic_ADP_Fourier.tens_elem'
    _definition.update            2024-08-06
    _description.text
;
       A label identifying the anharmonic ADP tensor elements of a
       given atom whose modulation is being parameterized by Fourier
       series. This code must match one of the codes listed in
       _atom_site_anharmonic_ADP.tens_elem.
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier
    _name.object_id               tens_elem
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         C111               'average value or modulation components of C111'
         C112               'average value or modulation components of C112'
         C113               'average value or modulation components of C113'
         C122               'average value or modulation components of C122'
         C123               'average value or modulation components of C123'
         C133               'average value or modulation components of C133'
         C222               'average value or modulation components of C222'
         C223               'average value or modulation components of C223'
         C233               'average value or modulation components of C233'
         C333               'average value or modulation components of C333'
         D1111              'average value or modulation components of D1111'
         D1112              'average value or modulation components of D1112'
         D1113              'average value or modulation components of D1113'
         D1122              'average value or modulation components of D1122'
         D1123              'average value or modulation components of D1123'
         D1133              'average value or modulation components of D1133'
         D1222              'average value or modulation components of D1222'
         D1223              'average value or modulation components of D1223'
         D1233              'average value or modulation components of D1233'
         D1333              'average value or modulation components of D1333'
         D2222              'average value or modulation components of D2222'
         D2223              'average value or modulation components of D2223'
         D2233              'average value or modulation components of D2233'
         D2333              'average value or modulation components of D2333'
         D3333              'average value or modulation components of D3333'
         E11111             'average value or modulation components of E11111'
         E11112             'average value or modulation components of E11112'
         E11113             'average value or modulation components of E11113'
         E11122             'average value or modulation components of E11122'
         E11123             'average value or modulation components of E11123'
         E11133             'average value or modulation components of E11133'
         E11222             'average value or modulation components of E11222'
         E11223             'average value or modulation components of E11223'
         E11233             'average value or modulation components of E11233'
         E11333             'average value or modulation components of E11333'
         E12222             'average value or modulation components of E12222'
         E12223             'average value or modulation components of E12223'
         E12233             'average value or modulation components of E12233'
         E12333             'average value or modulation components of E12333'
         E13333             'average value or modulation components of E13333'
         E22222             'average value or modulation components of E22222'
         E22223             'average value or modulation components of E22223'
         E22233             'average value or modulation components of E22233'
         E22333             'average value or modulation components of E22333'
         E23333             'average value or modulation components of E23333'
         F111111            'average value or modulation components of F111111'
         F111112            'average value or modulation components of F111112'
         F111113            'average value or modulation components of F111113'
         F111122            'average value or modulation components of F111122'
         F111123            'average value or modulation components of F111123'
         F111133            'average value or modulation components of F111133'
         F111222            'average value or modulation components of F111222'
         F111223            'average value or modulation components of F111223'
         F111233            'average value or modulation components of F111233'
         F111333            'average value or modulation components of F111333'
         F112222            'average value or modulation components of F112222'
         F112223            'average value or modulation components of F112223'
         F112233            'average value or modulation components of F112233'
         F112333            'average value or modulation components of F112333'
         F113333            'average value or modulation components of F113333'
         F122222            'average value or modulation components of F122222'
         F122223            'average value or modulation components of F122223'
         F122233            'average value or modulation components of F122233'
         F122333            'average value or modulation components of F122333'
         F123333            'average value or modulation components of F123333'
         F133333            'average value or modulation components of F133333'
         F222222            'average value or modulation components of F222222'
         F222223            'average value or modulation components of F222223'
         F222233            'average value or modulation components of F222233'
         F222333            'average value or modulation components of F222333'
         F223333            'average value or modulation components of F223333'
         F233333            'average value or modulation components of F233333'
         F333333            'average value or modulation components of F333333'

save_

save_atom_site_anharmonic_adp_fourier.wave_vector_seq_id

    _definition.id
        '_atom_site_anharmonic_ADP_Fourier.wave_vector_seq_id'
    _definition.update            2024-04-13
    _description.text
;
       A numeric code identifying the wave vectors of the Fourier terms
       used to describe the modulation functions corresponding to the
       anharmonic ADP tensors of an atom. This code must match
       _atom_site_Fourier_wave_vector.seq_id.
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier
    _name.object_id               wave_vector_seq_id
    _name.linked_item_id          '_atom_site_Fourier_wave_vector.seq_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_ATOM_SITE_ANHARMONIC_ADP_FOURIER_PARAM

    _definition.id                ATOM_SITE_ANHARMONIC_ADP_FOURIER_PARAM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-02
    _description.text
;
          Data items in the ATOM_SITE_ANHARMONIC_ADP_FOURIER_PARAM category
          record details about the coefficients of the Fourier series used to
          describe the modulation of the anharmonic ADP tensor components
          in a modulated structure. The Fourier components are defined in
          the parent category ATOM_SITE_ANHARMONIC_ADP_FOURIER. Notice that
          items in this category may be listed together with those of the
          ATOM_SITE_ANHARMONIC_ADP_FOURIER  category. To simplify the
          description, below is explained the one-dimensional case.

          The modulation of the anharmonic ADP tensor elements (listed under
          _atom_site_anharmonic_ADP_Fourier.tens_elem) are parameterized by
          Fourier series. Each term of the series commonly adopts two
          different representations: the sine-cosine form,
                   T(j...)cn cos(2\\p n x4)+T(j...)sn sin(2\\p n x4),
          and the modulus-argument form,
                   |T(j...)n| cos[2\\p n x4+\\q(j...l)n],
          where x4=q*(r+T)+t. q is the modulation wave vector and r and T
          stand for a phase reference position and a lattice translation of
          the reference structure, respectively. The phase reference position
          can be chosen as the average position of the modulated atom, if
          not in a rigid group or, in case of rigid groups a common point
          for all atoms in the group. t is an arbitrary phase, irrelevant for
          incommensurate modulated structures, but essential in the
          commensurate case (see _atom_sites_modulation_global_phase_t_).
;
    _name.category_id             ATOM_SITE_ANHARMONIC_ADP_FOURIER
    _name.object_id               ATOM_SITE_ANHARMONIC_ADP_FOURIER_PARAM
    _category_key.name            '_atom_site_anharmonic_ADP_Fourier_param.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension        1

        loop_
          _cell_wave_vector.seq_id
          _cell_wave_vector.x
          _cell_wave_vector.y
          _cell_wave_vector.z
          1  0.000000  0.000000  0.143000

        loop_
          _atom_site.label
          _atom_site.type_symbol
          _atom_site.fract_x
          _atom_site.fract_y
          _atom_site.fract_z
          _atom_site.U_iso_or_equiv
          _atom_site.site_symmetry_multiplicity
          _atom_site.occupancy
          _atom_site.calc_flag
          Co1  Co          0.5            0             0   0.0259(10)  4  1  d
          O1   O   0.59580(13)  -0.07083(9)  -0.21413(13)    0.0280(4)  8  1  d
          O2   O   0.77265(13)  -0.05973(9)  -0.41846(12)    0.0272(3)  8  1  d
          O3   O   0.47451(14)   0.15486(9)  -0.12793(12)    0.0274(3)  8  1  d

        # - - - - data truncated for brevity - - - -

        loop_
          _atom_site_Fourier_wave_vector.seq_id
          _atom_site_Fourier_wave_vector.q1_coeff
          1  1
          2  2

        # - - - - data truncated for brevity - - - -

        loop_
          _atom_site_anharmonic_ADP_Fourier.id
          _atom_site_anharmonic_ADP_Fourier.atom_site_label
          _atom_site_anharmonic_ADP_Fourier.tens_elem
          _atom_site_anharmonic_ADP_Fourier.wave_vector_seq_id
           1 Co1   C111  1
           2 Co1   C112  1
           3 Co1   C113  1
           4 Co1   C122  1
           5 Co1   C123  1
           6 Co1   C133  1
           7 Co1   C222  1
           8 Co1   C223  1
           9 Co1   C233  1
          10 Co1   C333  1
          11 O2    C111  1
          12 O2    C112  1

        loop_
          _atom_site_anharmonic_ADP_Fourier_param.id
          _atom_site_anharmonic_ADP_Fourier_param.cos
          _atom_site_anharmonic_ADP_Fourier_param.sin
           1           0    -0.008(4)
           2           0   0.0031(15)
           3           0   0.0012(19)
           4           0  -0.0018(11)
           5           0    0.0009(9)
           6           0   0.0004(19)
           7           0   0.0013(17)
           8           0  -0.0002(11)
           9           0   0.0027(13)
          10           0     0.005(3)
          11 -0.0016(13)   0.0020(14)
          12  -0.0001(5)    0.0003(5)

        # - - - - data truncated for brevity - - - -

        #======================================================================

        Example based on the article:
        Laura Canadillas-Delgado, Lidia Mazzuca, Oscar Fabelo and
        Juan Rodriguez-Carvajal (2019) IUCrJ. 6, 105-115.
        doi:10.1107/S2052252518015026
        Incommensurate structures of the [CH~3~NH~3~][Co(COOH)~3~] compound
;

save_

save_atom_site_anharmonic_adp_fourier_param.cos

    _definition.id                '_atom_site_anharmonic_ADP_Fourier_param.cos'
    _definition.update            2024-04-13
    _description.text
;
       The cosine coefficient [T(j...)c], corresponding to the Fourier term
       defined by _atom_site_anharmonic_ADP_Fourier.atom_site_label,
       _atom_site_anharmonic_ADP_Fourier.tens_elem and
       _atom_site_anharmonic_ADP_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier_param
    _name.object_id               cos
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  p  as  atom_site_anharmonic_ADP_Fourier_param

       atom_site_anharmonic_ADP_Fourier_param.cos =
                                    p.modulus*Cos(TwoPi*p.phase)
;

save_

save_atom_site_anharmonic_adp_fourier_param.cos_su

    _definition.id
        '_atom_site_anharmonic_ADP_Fourier_param.cos_su'
    _definition.update            2024-08-02
    _description.text
;
       Standard uncertainty of _atom_site_anharmonic_ADP_Fourier_param.cos
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier_param
    _name.object_id               cos_su
    _name.linked_item_id          '_atom_site_anharmonic_ADP_Fourier_param.cos'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_anharmonic_adp_fourier_param.id

    _definition.id                '_atom_site_anharmonic_ADP_Fourier_param.id'
    _definition.update            2024-04-13
    _description.text
;
       A code identifying the (in general complex) coefficient of each
       term present in the Fourier series describing the modulation of
       the ADP. This code must match _atom_site_anharmonic_ADP_Fourier.id.
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier_param
    _name.object_id               id
    _name.linked_item_id          '_atom_site_anharmonic_ADP_Fourier.id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp_fourier_param.modulus

    _definition.id
        '_atom_site_anharmonic_ADP_Fourier_param.modulus'
    _definition.update            2024-04-13
    _description.text
;
       The modulus [|T(j...)n|] of the complex amplitudes corresponding to
       the Fourier term defined by
       _atom_site_anharmonic_ADP_Fourier.atom_site_label,
       _atom_site_anharmonic_ADP_Fourier.tens_elem and
       _atom_site_anharmonic_ADP_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier_param
    _name.object_id               modulus
    _enumeration.range            0.0:
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  p  as  atom_site_anharmonic_ADP_Fourier_param

       atom_site_anharmonic_ADP_Fourier_param.modulus =  Sqrt(p.cos**2+p.sin**2)
;

save_

save_atom_site_anharmonic_adp_fourier_param.modulus_su

    _definition.id
        '_atom_site_anharmonic_ADP_Fourier_param.modulus_su'
    _definition.update            2024-08-02
    _description.text
;
       Standard uncertainty of _atom_site_anharmonic_ADP_Fourier_param.modulus
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier_param
    _name.object_id               modulus_su
    _name.linked_item_id
        '_atom_site_anharmonic_ADP_Fourier_param.modulus'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_anharmonic_adp_fourier_param.phase

    _definition.id
        '_atom_site_anharmonic_ADP_Fourier_param.phase'
    _definition.update            2024-04-13
    _description.text
;
       _The phase [\q(j...)n/2\\p], in cycles, of the complex amplitude
       corresponding to the Fourier term defined by
       _atom_site_anharmonic_ADP_Fourier.atom_site_label,
       _atom_site_anharmonic_ADP_Fourier.tens_elem and
       _atom_site_anharmonic_ADP_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier_param
    _name.object_id               phase
    _enumeration.range            -1.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  p  as  atom_site_anharmonic_ADP_Fourier_param

       atom_site_anharmonic_ADP_Fourier_param.phase =
                                 Phase(Complex(p.cos,-p.sin))/TwoPi
;

save_

save_atom_site_anharmonic_adp_fourier_param.phase_su

    _definition.id
        '_atom_site_anharmonic_ADP_Fourier_param.phase_su'
    _definition.update            2024-08-02
    _description.text
;
       Standard uncertainty of _atom_site_anharmonic_ADP_Fourier_param.phase
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier_param
    _name.object_id               phase_su
    _name.linked_item_id
        '_atom_site_anharmonic_ADP_Fourier_param.phase'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_anharmonic_adp_fourier_param.sin

    _definition.id                '_atom_site_anharmonic_ADP_Fourier_param.sin'
    _definition.update            2024-04-13
    _description.text
;
      The sine coefficient [T(j...)sn] corresponding to the Fourier term
      defined by _atom_site_anharmonic_ADP_Fourier.atom_site_label,
      _atom_site_anharmonic_ADP_Fourier.tens_elem and
      _atom_site_anharmonic_AD_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier_param
    _name.object_id               sin
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_anharmonic_ADP_Fourier_param

       atom_site_anharmonic_ADP_Fourier_param.sin =
             -p.modulus*Sin(TwoPi*p.phase)
;

save_

save_atom_site_anharmonic_adp_fourier_param.sin_su

    _definition.id
        '_atom_site_anharmonic_ADP_Fourier_param.sin_su'
    _definition.update            2024-08-02
    _description.text
;
      Standard uncertainty of _atom_site_anharmonic_ADP_Fourier_param.sin
;
    _name.category_id             atom_site_anharmonic_ADP_Fourier_param
    _name.object_id               sin_su
    _name.linked_item_id          '_atom_site_anharmonic_ADP_Fourier_param.sin'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_ATOM_SITE_ANHARMONIC_ADP_LEGENDRE

    _definition.id                ATOM_SITE_ANHARMONIC_ADP_LEGENDRE
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_ANHARMONIC_ADP_LEGENDRE category record
      details about the Legendre polynomials used to describe the
      modulations of the anharmonic ADP tensor elements when the atomic
      domain of a given atom is restricted by a crenel function.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_ANHARMONIC_ADP_LEGENDRE
    _category_key.name            '_atom_site_anharmonic_ADP_legendre.id'

save_

save_atom_site_anharmonic_adp_legendre.atom_site_label

    _definition.id
        '_atom_site_anharmonic_ADP_legendre.atom_site_label'
    _definition.update            2024-05-02
    _description.text
;
      The code the identifies an atom in a loop in which the Legendre
      components of the tensors that parameterize its anharmonic ADP
      modulation are listed. This code must match the _atom_site.label of
      the associated coordinate list and conform to the rules described
      in _atom_site.label.
;
    _name.category_id             atom_site_anharmonic_ADP_Legendre
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp_legendre.coeff

    _definition.id                '_atom_site_anharmonic_ADP_Legendre.coeff'
    _definition.update            2024-05-02
    _description.text
;
      The coefficient corresponding to the Legendre polynomial defined by
      _atom_site_anharmonic_ADP_Legendre.atom_site_label,
      _atom_site_anharmonic_ADP_Legendre.tens_elem and
      _atom_site_anharmonic_ADP_Legendre.order.
;
    _name.category_id             atom_site_anharmonic_ADP_Legendre
    _name.object_id               coeff
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_anharmonic_adp_legendre.coeff_su

    _definition.id                '_atom_site_anharmonic_ADP_Legendre.coeff_su'
    _definition.update            2024-08-02
    _description.text
;
      Standard uncertainty of _atom_site_anharmonic_ADP_Legendre.coeff
;
    _name.category_id             atom_site_anharmonic_ADP_Legendre
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_anharmonic_ADP_Legendre.coeff'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_anharmonic_adp_legendre.id

    _definition.id                '_atom_site_anharmonic_ADP_Legendre.id'
    _definition.update            2024-05-02
    _description.text
;
      A code identifying each component used to describe the modulation
      of the tensors, expressed in terms of Legendre polynomials, that
      parameterize an anharmonic ADP.
;
    _name.category_id             atom_site_anharmonic_ADP_Legendre
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp_legendre.order

    _definition.id                '_atom_site_anharmonic_ADP_Legendre.order'
    _definition.update            2024-05-02
    _description.text
;
      The order of the Legendre polynomial.
;
    _name.category_id             atom_site_anharmonic_ADP_Legendre
    _name.object_id               order
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_atom_site_anharmonic_adp_legendre.tens_elem

    _definition.id                '_atom_site_anharmonic_ADP_Legendre.tens_elem'
    _definition.update            2024-05-02
    _description.text
;
      A label identifying the anharmonic ADP tensor elements of a given
      atom whose modulation is being parameterized by Legendre polynomials.
      This code must match one of the codes listed in
      'atom_site_anharmonic_ADP.tens_elem.
;
    _name.category_id             atom_site_anharmonic_ADP_Legendre
    _name.object_id               tens_elem
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         C111               'average value or modulation components of C111'
         C112               'average value or modulation components of C112'
         C113               'average value or modulation components of C113'
         C122               'average value or modulation components of C122'
         C123               'average value or modulation components of C123'
         C133               'average value or modulation components of C133'
         C222               'average value or modulation components of C222'
         C223               'average value or modulation components of C223'
         C233               'average value or modulation components of C233'
         C333               'average value or modulation components of C333'
         D1111              'average value or modulation components of D1111'
         D1112              'average value or modulation components of D1112'
         D1113              'average value or modulation components of D1113'
         D1122              'average value or modulation components of D1122'
         D1123              'average value or modulation components of D1123'
         D1133              'average value or modulation components of D1133'
         D1222              'average value or modulation components of D1222'
         D1223              'average value or modulation components of D1223'
         D1233              'average value or modulation components of D1233'
         D1333              'average value or modulation components of D1333'
         D2222              'average value or modulation components of D2222'
         D2223              'average value or modulation components of D2223'
         D2233              'average value or modulation components of D2233'
         D2333              'average value or modulation components of D2333'
         D3333              'average value or modulation components of D3333'
         E11111             'average value or modulation components of E11111'
         E11112             'average value or modulation components of E11112'
         E11113             'average value or modulation components of E11113'
         E11122             'average value or modulation components of E11122'
         E11123             'average value or modulation components of E11123'
         E11133             'average value or modulation components of E11133'
         E11222             'average value or modulation components of E11222'
         E11223             'average value or modulation components of E11223'
         E11233             'average value or modulation components of E11233'
         E11333             'average value or modulation components of E11333'
         E12222             'average value or modulation components of E12222'
         E12223             'average value or modulation components of E12223'
         E12233             'average value or modulation components of E12233'
         E12333             'average value or modulation components of E12333'
         E13333             'average value or modulation components of E13333'
         E22222             'average value or modulation components of E22222'
         E22223             'average value or modulation components of E22223'
         E22233             'average value or modulation components of E22233'
         E22333             'average value or modulation components of E22333'
         E23333             'average value or modulation components of E23333'
         F111111            'average value or modulation components of F111111'
         F111112            'average value or modulation components of F111112'
         F111113            'average value or modulation components of F111113'
         F111122            'average value or modulation components of F111122'
         F111123            'average value or modulation components of F111123'
         F111133            'average value or modulation components of F111133'
         F111222            'average value or modulation components of F111222'
         F111223            'average value or modulation components of F111223'
         F111233            'average value or modulation components of F111233'
         F111333            'average value or modulation components of F111333'
         F112222            'average value or modulation components of F112222'
         F112223            'average value or modulation components of F112223'
         F112233            'average value or modulation components of F112233'
         F112333            'average value or modulation components of F112333'
         F113333            'average value or modulation components of F113333'
         F122222            'average value or modulation components of F122222'
         F122223            'average value or modulation components of F122223'
         F122233            'average value or modulation components of F122233'
         F122333            'average value or modulation components of F122333'
         F123333            'average value or modulation components of F123333'
         F133333            'average value or modulation components of F133333'
         F222222            'average value or modulation components of F222222'
         F222223            'average value or modulation components of F222223'
         F222233            'average value or modulation components of F222233'
         F222333            'average value or modulation components of F222333'
         F223333            'average value or modulation components of F223333'
         F233333            'average value or modulation components of F233333'
         F333333            'average value or modulation components of F333333'

save_

save_ATOM_SITE_ANHARMONIC_ADP_ORTHO

    _definition.id                ATOM_SITE_ANHARMONIC_ADP_ORTHO
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_ANHARMONIC_ADP_ORTHO category record
      details about the orthogonalized functions defined to solve
      correlation problems during the refinement of the modulations of the
      anharmonic ADP tensor elements, when the atomic domain of a given
      atom is restricted by a crenel function. The functions are constructed
      selecting Fourier harmonics until the desired degree of orthogonality
      and completeness is reached (see
      _atom_site_occ_special_func.crenel_ortho_eps).
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_ANHARMONIC_ADP_ORTHO
    _category_key.name            '_atom_site_anharmonic_ADP_ortho.id'

save_

save_atom_site_anharmonic_adp_ortho.atom_site_label

    _definition.id
        '_atom_site_anharmonic_ADP_ortho.atom_site_label'
    _definition.update            2024-04-17
    _description.text
;
      The code that identifies an atom in a loop in which the ortho
      components of the tensors that parameterize its anharmonic ADP
      modulation are listed. This code must match the _atom_site.label of
      the associated coordinate list and conform to the rules described
      in _atom_site.label.

      Notice that the global results could also be expressed (losing
      information about the orthogonalized functions )using the data items
      defined in the categories ATOM_SITE_ANHARMONIC_ADP_FOURIER and
      ATOM_SITE_ANHARMONIC_ADP_FOURIER_PARAM.
;
    _name.category_id             atom_site_anharmonic_ADP_ortho
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp_ortho.coeff

    _definition.id                '_atom_site_anharmonic_ADP_ortho.coeff'
    _definition.update            2024-04-17
    _description.text
;
      The coefficient, corresponding to the orthogonalized function
      defined by _atom_site_anharmonic_ADP_ortho.atom_site_label,
      _atom_site_anharmonic_ADP_ortho.tens_elem and
      _atom_site_anharmonic_ADP_ortho.func_id.
;
    _name.category_id             atom_site_anharmonic_ADP_ortho
    _name.object_id               coeff
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_anharmonic_adp_ortho.coeff_su

    _definition.id                '_atom_site_anharmonic_ADP_ortho.coeff_su'
    _definition.update            2024-08-02
    _description.text
;
      Standard uncertainty of _atom_site_anharmonic_ADP_ortho.coeff
;
    _name.category_id             atom_site_anharmonic_ADP_ortho
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_anharmonic_ADP_ortho.coeff'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_anharmonic_adp_ortho.func_id

    _definition.id                '_atom_site_anharmonic_ADP_ortho.func_id'
    _definition.update            2024-04-17
    _description.text
;
      A code identifying the orthogonalized function used in the structural
      model to describe the anharmonic tensor elements modulation
      of an atom, when orthogonalized functions are used. This code must
      match _atom_sites_ortho.func_id.
;
    _name.category_id             atom_site_anharmonic_ADP_ortho
    _name.object_id               func_id
    _name.linked_item_id          '_atom_sites_ortho.func_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp_ortho.id

    _definition.id                '_atom_site_anharmonic_ADP_ortho.id'
    _definition.update            2024-04-17
    _description.text
;
      A code identifying each component of the ADP modulation of
      a given atom when the modulation is expressed in terms of ortho
      series.
;
    _name.category_id             atom_site_anharmonic_ADP_ortho
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp_ortho.tens_elem

    _definition.id                '_atom_site_anharmonic_ADP_ortho.tens_elem'
    _definition.update            2024-04-17
    _description.text
;
      A code identifying each component used to describe the modulation
      of the tensors, expressed in terms of orthogonalized functions, that
      parameterize an anharmonic ADP.
;
    _name.category_id             atom_site_anharmonic_ADP_ortho
    _name.object_id               tens_elem
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         C111               'average value or modulation components of C111'
         C112               'average value or modulation components of C112'
         C113               'average value or modulation components of C113'
         C122               'average value or modulation components of C122'
         C123               'average value or modulation components of C123'
         C133               'average value or modulation components of C133'
         C222               'average value or modulation components of C222'
         C223               'average value or modulation components of C223'
         C233               'average value or modulation components of C233'
         C333               'average value or modulation components of C333'
         D1111              'average value or modulation components of D1111'
         D1112              'average value or modulation components of D1112'
         D1113              'average value or modulation components of D1113'
         D1122              'average value or modulation components of D1122'
         D1123              'average value or modulation components of D1123'
         D1133              'average value or modulation components of D1133'
         D1222              'average value or modulation components of D1222'
         D1223              'average value or modulation components of D1223'
         D1233              'average value or modulation components of D1233'
         D1333              'average value or modulation components of D1333'
         D2222              'average value or modulation components of D2222'
         D2223              'average value or modulation components of D2223'
         D2233              'average value or modulation components of D2233'
         D2333              'average value or modulation components of D2333'
         D3333              'average value or modulation components of D3333'
         E11111             'average value or modulation components of E11111'
         E11112             'average value or modulation components of E11112'
         E11113             'average value or modulation components of E11113'
         E11122             'average value or modulation components of E11122'
         E11123             'average value or modulation components of E11123'
         E11133             'average value or modulation components of E11133'
         E11222             'average value or modulation components of E11222'
         E11223             'average value or modulation components of E11223'
         E11233             'average value or modulation components of E11233'
         E11333             'average value or modulation components of E11333'
         E12222             'average value or modulation components of E12222'
         E12223             'average value or modulation components of E12223'
         E12233             'average value or modulation components of E12233'
         E12333             'average value or modulation components of E12333'
         E13333             'average value or modulation components of E13333'
         E22222             'average value or modulation components of E22222'
         E22223             'average value or modulation components of E22223'
         E22233             'average value or modulation components of E22233'
         E22333             'average value or modulation components of E22333'
         E23333             'average value or modulation components of E23333'
         F111111            'average value or modulation components of F111111'
         F111112            'average value or modulation components of F111112'
         F111113            'average value or modulation components of F111113'
         F111122            'average value or modulation components of F111122'
         F111123            'average value or modulation components of F111123'
         F111133            'average value or modulation components of F111133'
         F111222            'average value or modulation components of F111222'
         F111223            'average value or modulation components of F111223'
         F111233            'average value or modulation components of F111233'
         F111333            'average value or modulation components of F111333'
         F112222            'average value or modulation components of F112222'
         F112223            'average value or modulation components of F112223'
         F112233            'average value or modulation components of F112233'
         F112333            'average value or modulation components of F112333'
         F113333            'average value or modulation components of F113333'
         F122222            'average value or modulation components of F122222'
         F122223            'average value or modulation components of F122223'
         F122233            'average value or modulation components of F122233'
         F122333            'average value or modulation components of F122333'
         F123333            'average value or modulation components of F123333'
         F133333            'average value or modulation components of F133333'
         F222222            'average value or modulation components of F222222'
         F222223            'average value or modulation components of F222223'
         F222233            'average value or modulation components of F222233'
         F222333            'average value or modulation components of F222333'
         F223333            'average value or modulation components of F223333'
         F233333            'average value or modulation components of F233333'
         F333333            'average value or modulation components of F333333'

save_

save_ATOM_SITE_ANHARMONIC_ADP_XHARM

    _definition.id                ATOM_SITE_ANHARMONIC_ADP_XHARM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_ANHARMONIC_ADP_XHARM category record
      details about the x-harmonics used to describe the  modulations of
      the anharmonic ADP tensor elements when the atomic domain of a
      given atom is restricted by a crenel function.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_ANHARMONIC_ADP_XHARM
    _category_key.name            '_atom_site_anharmonic_ADP_xharm.id'

save_

save_atom_site_anharmonic_adp_xharm.atom_site_label

    _definition.id
        '_atom_site_anharmonic_ADP_xharm.atom_site_label'
    _definition.update            2024-05-02
    _description.text
;
      The code the identifies an atom in a loop in which the x-harmonics
      components of the tensors that parameterize its anharmonic ADP
      modulation are listed. This code must match the _atom_site.label of
      the associated coordinate list and conform to the rules described
      in _atom_site.label.
;
    _name.category_id             atom_site_anharmonic_ADP_xharm
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp_xharm.coeff

    _definition.id                '_atom_site_anharmonic_ADP_xharm.coeff'
    _definition.update            2024-05-02
    _description.text
;
      The coefficient, corresponding to the x-harmonic defined by
      _atom_site_anharmonic_ADP_xharm.atom_site_label,
      _atom_site_anharmonic_ADP_xharm.tens_elem and
      _atom_site_anharmonic_ADP_xharm.order.
;
    _name.category_id             atom_site_anharmonic_ADP_xharm
    _name.object_id               coeff
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_anharmonic_adp_xharm.coeff_su

    _definition.id                '_atom_site_anharmonic_ADP_xharm.coeff_su'
    _definition.update            2024-08-02
    _description.text
;
      Standard uncertainty of _atom_site_anharmonic_ADP_xharm.coeff
;
    _name.category_id             atom_site_anharmonic_ADP_xharm
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_anharmonic_ADP_xharm.coeff'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_anharmonic_adp_xharm.id

    _definition.id                '_atom_site_anharmonic_ADP_xharm.id'
    _definition.update            2024-05-02
    _description.text
;
      A code identifying each component used to describe the modulation
      of the tensors, expressed in terms of x-harmonics, that
      parameterize an anharmonic ADP.
;
    _name.category_id             atom_site_anharmonic_ADP_xharm
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_anharmonic_adp_xharm.order

    _definition.id                '_atom_site_anharmonic_ADP_xharm.order'
    _definition.update            2024-05-02
    _description.text
;
      The order of each x-harmonic function.
;
    _name.category_id             atom_site_anharmonic_ADP_xharm
    _name.object_id               order
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_atom_site_anharmonic_adp_xharm.tens_elem

    _definition.id                '_atom_site_anharmonic_ADP_xharm.tens_elem'
    _definition.update            2024-08-06
    _description.text
;
      A label identifying the anharmonic ADP tensor elements of a given
      atom whose modulation is being parameterized by x-harmonics.
;
    _name.category_id             atom_site_anharmonic_ADP_xharm
    _name.object_id               tens_elem
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         C111               'average value or modulation components of C111'
         C112               'average value or modulation components of C112'
         C113               'average value or modulation components of C113'
         C122               'average value or modulation components of C122'
         C123               'average value or modulation components of C123'
         C133               'average value or modulation components of C133'
         C222               'average value or modulation components of C222'
         C223               'average value or modulation components of C223'
         C233               'average value or modulation components of C233'
         C333               'average value or modulation components of C333'
         D1111              'average value or modulation components of D1111'
         D1112              'average value or modulation components of D1112'
         D1113              'average value or modulation components of D1113'
         D1122              'average value or modulation components of D1122'
         D1123              'average value or modulation components of D1123'
         D1133              'average value or modulation components of D1133'
         D1222              'average value or modulation components of D1222'
         D1223              'average value or modulation components of D1223'
         D1233              'average value or modulation components of D1233'
         D1333              'average value or modulation components of D1333'
         D2222              'average value or modulation components of D2222'
         D2223              'average value or modulation components of D2223'
         D2233              'average value or modulation components of D2233'
         D2333              'average value or modulation components of D2333'
         D3333              'average value or modulation components of D3333'
         E11111             'average value or modulation components of E11111'
         E11112             'average value or modulation components of E11112'
         E11113             'average value or modulation components of E11113'
         E11122             'average value or modulation components of E11122'
         E11123             'average value or modulation components of E11123'
         E11133             'average value or modulation components of E11133'
         E11222             'average value or modulation components of E11222'
         E11223             'average value or modulation components of E11223'
         E11233             'average value or modulation components of E11233'
         E11333             'average value or modulation components of E11333'
         E12222             'average value or modulation components of E12222'
         E12223             'average value or modulation components of E12223'
         E12233             'average value or modulation components of E12233'
         E12333             'average value or modulation components of E12333'
         E13333             'average value or modulation components of E13333'
         E22222             'average value or modulation components of E22222'
         E22223             'average value or modulation components of E22223'
         E22233             'average value or modulation components of E22233'
         E22333             'average value or modulation components of E22333'
         E23333             'average value or modulation components of E23333'
         F111111            'average value or modulation components of F111111'
         F111112            'average value or modulation components of F111112'
         F111113            'average value or modulation components of F111113'
         F111122            'average value or modulation components of F111122'
         F111123            'average value or modulation components of F111123'
         F111133            'average value or modulation components of F111133'
         F111222            'average value or modulation components of F111222'
         F111223            'average value or modulation components of F111223'
         F111233            'average value or modulation components of F111233'
         F111333            'average value or modulation components of F111333'
         F112222            'average value or modulation components of F112222'
         F112223            'average value or modulation components of F112223'
         F112233            'average value or modulation components of F112233'
         F112333            'average value or modulation components of F112333'
         F113333            'average value or modulation components of F113333'
         F122222            'average value or modulation components of F122222'
         F122223            'average value or modulation components of F122223'
         F122233            'average value or modulation components of F122233'
         F122333            'average value or modulation components of F122333'
         F123333            'average value or modulation components of F123333'
         F133333            'average value or modulation components of F133333'
         F222222            'average value or modulation components of F222222'
         F222223            'average value or modulation components of F222223'
         F222233            'average value or modulation components of F222233'
         F222333            'average value or modulation components of F222333'
         F223333            'average value or modulation components of F223333'
         F233333            'average value or modulation components of F233333'
         F333333            'average value or modulation components of F333333'

save_

save_ATOM_SITE_DISPLACE_FOURIER

    _definition.id                ATOM_SITE_DISPLACE_FOURIER
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_DISPLACE_FOURIER category record
      details about the Fourier components of the displacive modulation
      of an atom site in a modulated structure. In the case of rigid
      groups, items in this category would only include the
      translational part of the modulation. The rotational part would
      appear in a separate list of items belonging to the
      ATOM_SITE_ROT_FOURIER category. The (in general complex)
      coefficients of each Fourier component belong to the child category
      ATOM_SITE_DISPLACE_FOURIER_PARAM and may be listed separately.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_DISPLACE_FOURIER
    _category_key.name            '_atom_site_displace_Fourier.id'
    _description_example.case
;
        #\#CIF_2.0

        data_I

        # - - - - data truncated for brevity - - - -

        loop_
         _cell_wave_vector.seq_id
         _cell_wave_vector.xyz
             1  [0.00338(6),0.15278(14),-0.0138(3)]
             2  [0.63105(7),1.07460(17),-0.4438(3)]

        loop_
         _atom_site.type_symbol
         _atom_site.label
         _atom_site.subsystem_code
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.U_iso_or_equiv
         _atom_site.calc_flag
         _atom_site.occupancy
          Sn Sn  H  0          0            0           0.01480(12)  d 0.851(2)
          Cu Cu  H  0.0029(9)  0.0057(5)    0.1147(3)   0.0229(11)   d 0.149(2)
          S  S1  H  0.5033(2)  0.84278(12)  0.12342(7)  0.0177(3)    d 1
          Pb Pb  Q  0.05541(5) 0.24113(4)   0.36783(2)  0.03573(12)  d 0.701(10)
          Sb Sb  Q  0.055408   0.241132     0.367832    0.03573(12)  d 0.299(10)
          S  S2  Q -0.0402(3)  0.2583(2)    0.59639(13) 0.0310(4)    d 1

        loop_
         _atom_site_Fourier_wave_vector.seq_id
         _atom_site_Fourier_wave_vector.xyz
         _atom_site_Fourier_wave_vector.q_coeff_seq_id
         _atom_site_Fourier_wave_vector.q_coeff
            1  [0.00338,0.15278,-0.0138]  [1]   [1]
            2  [0.63105,1.07460,-0.4438]  [2]   [1]
            3  [0.00676,0.30556,-0.0276]  [1]   [2]
            4  [0.01014,0.45834,-0.0414]  [1]   [2]
            5  [0.01352,0.61112,-0.0552]  [1]   [2]
            6  [0.63443,1.22738,-0.4576]  [1,2] [1,1]

        loop_
         _atom_site_displace_Fourier.id
         _atom_site_displace_Fourier.atom_site_label
         _atom_site_displace_Fourier.axis
         _atom_site_displace_Fourier.wave_vector_seq_id
         _atom_site_displace_Fourier_param.cos
         _atom_site_displace_Fourier_param.sin
         Sn_x_1  Sn  x  1   0            -0.00159(16)
         Sn_y_1  Sn  y  1   0            -0.00481(8)
         Sn_z_1  Sn  z  1   0            -0.06455(5)
         Sn_x_3  Sn  x  3   0             0.00004(18)
         Sn_y_3  Sn  y  3   0            -0.00395(8)
         Sn_z_3  Sn  z  3   0            -0.00108(5)
         Sn_x_4  Sn  x  4   0             0.0003(2)
         Sn_y_4  Sn  y  4   0            -0.00075(10)
         Sn_z_4  Sn  z  4   0             0.00042(6)
         Cu_x_1  Cu  x  1   0.0018(11)   -0.0012(13)
         Cu_y_1  Cu  y  1   0.0184(6)    -0.0092(6)
         Cu_z_1  Cu  z  1  -0.0013(4)    -0.0611(4)
         Sb_x_5  Sb  x  5  -0.00129(15)  -0.00043(15)
         Sb_y_5  Sb  y  5  -0.00002(10)   0.00106(10)
         Sb_z_5  Sb  z  5   0.00023(6)    0.00015(6)
         Sb_x_6  Sb  x  6  -0.0053(3)     0.0022(3)
         Sb_y_6  Sb  y  6   0.00496(16)  -0.00435(17)
         Sb_z_6  Sb  z  6   0.00287(9)    0.00189(9)
        # - - - - data truncated for brevity - - - -

        #======================================================================

        Example based on the article:
        Michel Evain, Vaclav Petricek, Yves Moelo and Colette Maurel (2006)
        Acta Cryst. B62, 775-789. doi:10.1107/S010876810602547X
        First (3 + 2)-dimensional superspace approach to the structure of
        levyclaudite-(Sb), a member of the cylindrite-type minerals
;

save_

save_atom_site_displace_fourier.atom_site_label

    _definition.id                '_atom_site_displace_Fourier.atom_site_label'
    _alias.definition_id          '_atom_site_displace_Fourier_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      Modulation parameters are usually looped in separate lists.
      Modulated parameters are the atom positions (displacive
      modulation), the atomic occupation (occupational modulation)
      and the isotropic or anisotropic (harmonic or anharmonic) ADPs.
      _atom_site_displace_Fourier.atom_site_label is the code that
      identifies an atom or rigid group in a loop in which the Fourier
      components of its displacive modulation are listed. In the case
      of a rigid group, this list would only include the translational
      part of its displacive modulation. The rotational part (if any)
      would appear in a separate list (see
      _atom_site_rot_Fourier.atom_site_label). This code must match
      the _atom_site.label of the associated coordinate list and
      conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_displace_Fourier
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_fourier.axis

    _definition.id                '_atom_site_displace_Fourier.axis'
    _alias.definition_id          '_atom_site_displace_Fourier_axis'
    _definition.update            2024-07-27
    _description.text
;
      A label identifying the displacement component of a given atom
      or rigid group that is being parameterized by Fourier series. a,
      b and c are the basic lattice vectors of the reference structure.
      For composites they refer to the reference structure of each
      subsystem. a~1~, a~2~ and a~3~ are defined by the
      items belonging to the ATOM_SITES_AXES category, through
      _atom_site_displace_Fourier.matrix_seq_id.
      Use of _atom_sites_displace_Fourier.axes_description is DEPRECATED
      and retained only for backward compatibility.

;
    _name.category_id             atom_site_displace_Fourier
    _name.object_id               axis
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         x
;
         displacement along the a axis
;
         y
;
         displacement along the b axis
;
         z
;
         displacement along the c axis
;
         a1
;
         displacement along the first axis after applying
         _atom_sites_axes.matrix
;
         a2
;
         displacement along the second axis after applying
         _atom_sites_axes.matrix
;
         a3
;
         displacement along the third axis after applying
         _atom_sites_axes.matrix
;

save_

save_atom_site_displace_fourier.id

    _definition.id                '_atom_site_displace_Fourier.id'
    _alias.definition_id          '_atom_site_displace_Fourier_id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying each component of the displacive modulation of
      a given atom or rigid group when the modulation is expressed in
      terms of Fourier series. In the case of a rigid group, it
      applies only to the translational part of the distortion.
;
    _name.category_id             atom_site_displace_Fourier
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_fourier.matrix_seq_id

    _definition.id                '_atom_site_displace_Fourier.matrix_seq_id'
    _definition.update            2024-08-01
    _name.category_id             atom_site_displace_Fourier
    _name.object_id               matrix_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':transf_matrix_id}]

save_

save_atom_site_displace_fourier.wave_vector_seq_id

    _definition.id
        '_atom_site_displace_Fourier.wave_vector_seq_id'
    _alias.definition_id
        '_atom_site_displace_Fourier_wave_vector_seq_id'
    _definition.update            2024-04-28
    _description.text
;
      A numeric code identifying the wave vectors of the Fourier terms
      used in the structural model to describe the displacive
      modulation of an atom or rigid group. In the case of a rigid
      group, it applies only to the translational part of the
      distortion. This code must match
      _atom_site_Fourier_wave_vector.seq_id.
;
    _name.category_id             atom_site_displace_Fourier
    _name.object_id               wave_vector_seq_id
    _name.linked_item_id          '_atom_site_Fourier_wave_vector.seq_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Integer

save_

save_ATOM_SITE_DISPLACE_FOURIER_PARAM

    _definition.id                ATOM_SITE_DISPLACE_FOURIER_PARAM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-07-31
    _description.text
;
      Data items in the ATOM_SITE_DISPLACE_FOURIER_PARAM category
      record details about the coefficients of the Fourier series
      used to describe the displacive modulation of an atom or rigid
      group. In the case of rigid groups, items in this category would
      only include the translational part of the modulation. The
      rotational part would appear in a separate list of items
      belonging to the ATOM_SITE_ROT_FOURIER_PARAM category. The
      Fourier components are defined in the parent category
      ATOM_SITE_DISPLACE_FOURIER. Notice that items in this category
      may be listed together with those of the ATOM_SITE_DISPLACE_FOURIER
      category. To simplify the description, below is explained the
      one-dimensional case.

      The displacive distortion of a given atom or rigid group is usually
      parameterized by Fourier series. The n-th term of the series commonly
      adopts two different representations: the sine-cosine form,
               Acn cos(2\\p n x4)+Asn sin(2\\p n x4),
      and the modulus-argument form,
               |An| cos(2\\p n x4+\\fn),
      where x4=q*(r+T)+t. q is the modulation wave vector and r and T
      stand for a phase reference position and a lattice translation of
      the reference structure, respectively. The phase reference position
      can be chosen as the average position of the modulated atom, if
      not in a rigid group or, in case of rigid groups a common point
      for all atoms in the group. t is an arbitrary phase, irrelevant for
      incommensurate modulated structures, but essential in the commensurate
      case (see _atom_sites_modulation_global_phase_t_).

      Atomic or rigid-group displacements must be
      expressed as fractions, either of the unit cell axes or of the
      axes defined by the items belonging to the ATOM_SITES_AXES category,
      through _atom_site_displace_Fourier.matrix_seq_id.

      Use of _atom_sites_displace_Fourier.axes_description is DEPRECATED
      and retained only for backward compatibility. Notice that in this
      case displacements were expressed in angstroms.
;
    _name.category_id             ATOM_SITE_DISPLACE_FOURIER
    _name.object_id               ATOM_SITE_DISPLACE_FOURIER_PARAM
    _category_key.name            '_atom_site_displace_Fourier_param.id'
    _description_example.case
;
        #\#CIF_2.0

        data_I

        # - - - - data truncated for brevity - - - -

        loop_
         _cell_wave_vector.seq_id
         _cell_wave_vector.xyz
             1  [0.00338(6),0.15278(14),-0.0138(3)]
             2  [0.63105(7),1.07460(17),-0.4438(3)]

        loop_
         _atom_site.type_symbol
         _atom_site.label
         _atom_site.subsystem_code
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.U_iso_or_equiv
         _atom_site.calc_flag
         _atom_site.occupancy
          Sn Sn  H  0          0            0           0.01480(12) d  0.851(2)
          Cu Cu  H  0.0029(9)  0.0057(5)    0.1147(3)   0.0229(11)  d  0.149(2)
          S  S1  H  0.5033(2)  0.84278(12)  0.12342(7)  0.0177(3)   d  1
          Pb Pb  Q  0.05541(5) 0.24113(4)   0.36783(2)  0.03573(12) d  0.701(10)
          Sb Sb  Q  0.055408   0.241132     0.367832    0.03573(12) d  0.299(10)
          S  S2  Q -0.0402(3)  0.2583(2)    0.59639(13) 0.0310(4)   d  1

        loop_
         _atom_site_Fourier_wave_vector.seq_id
         _atom_site_Fourier_wave_vector.xyz
         _atom_site_Fourier_wave_vector.q_coeff_seq_id
         _atom_site_Fourier_wave_vector.q_coeff
            1  [0.00338,0.15278,-0.0138]  [1]   [1]
            2  [0.63105,1.07460,-0.4438]  [2]   [1]
            3  [0.00676,0.30556,-0.0276]  [1]   [2]
            4  [0.01014,0.45834,-0.0414]  [1]   [2]
            5  [0.01352,0.61112,-0.0552]  [1]   [2]
            6  [0.63443,1.22738,-0.4576]  [1,2] [1,1]

        loop_
         _atom_site_displace_Fourier.id
         _atom_site_displace_Fourier.atom_site_label
         _atom_site_displace_Fourier.axis
         _atom_site_displace_Fourier.wave_vector_seq_id
         Sn_x_1  Sn  x  1
         Sn_y_1  Sn  y  1
         Sn_z_1  Sn  z  1
         Sn_x_3  Sn  x  3
         Sn_y_3  Sn  y  3
         Sn_z_3  Sn  z  3
         Sn_x_4  Sn  x  4
         Sn_y_4  Sn  y  4
         Sn_z_4  Sn  z  4
         Cu_x_1  Cu  x  1
         Cu_y_1  Cu  y  1
         Cu_z_1  Cu  z  1
         Sb_x_5  Sb  x  5
         Sb_y_5  Sb  y  5
         Sb_z_5  Sb  z  5
         Sb_x_6  Sb  x  6
         Sb_y_6  Sb  y  6
         Sb_z_6  Sb  z  6

        loop_
         _atom_site_displace_Fourier_param.id
         _atom_site_displace_Fourier_param.cos
         _atom_site_displace_Fourier_param.sin
         Sn_x_1  0            -0.00159(16)
         Sn_y_1  0            -0.00481(8)
         Sn_z_1  0            -0.06455(5)
         Sn_x_3  0             0.00004(18)
         Sn_y_3  0            -0.00395(8)
         Sn_z_3  0            -0.00108(5)
         Sn_x_4  0             0.0003(2)
         Sn_y_4  0            -0.00075(10)
         Sn_z_4  0             0.00042(6)
         Cu_x_1  0.0018(11)   -0.0012(13)
         Cu_y_1  0.0184(6)    -0.0092(6)
         Cu_z_1 -0.0013(4)    -0.0611(4)
         Sb_x_5 -0.00129(15)  -0.00043(15)
         Sb_y_5 -0.00002(10)   0.00106(10)
         Sb_z_5  0.00023(6)    0.00015(6)
         Sb_x_6 -0.0053(3)     0.0022(3)
         Sb_y_6  0.00496(16)  -0.00435(17)
         Sb_z_6  0.00287(9)    0.00189(9)

        # - - - - data truncated for brevity - - - -

        #======================================================================

        Example based on the article:
        Michel Evain, Vaclav Pericek, Yves Moelo and Colette Maurel (2006)
        Acta Cryst. B62, 775-789. doi:10.1107/S010876810602547X
        First (3 + 2)-dimensional superspace approach to the structure of
        levyclaudite-(Sb), a member of the cylindrite-type minerals
;

save_

save_atom_site_displace_fourier_param.cos

    _definition.id                '_atom_site_displace_Fourier_param.cos'
    _alias.definition_id          '_atom_site_displace_Fourier_param_cos'
    _definition.update            2024-08-01
    _description.text
;
      The cosine coefficient (Acn) corresponding to the Fourier term defined
      by _atom_site_displace_Fourier.atom_site_label,
      _atom_site_displace_Fourier.axis and
      _atom_site_displace_Fourier.wave_vector.seq_id.
;
    _name.category_id             atom_site_displace_Fourier_param
    _name.object_id               cos
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_displace_Fourier_param

       _atom_site_displace_Fourier_param.cos =  p.modulus*Cos(TwoPi*p.phase)
;

save_

save_atom_site_displace_fourier_param.cos_su

    _definition.id                '_atom_site_displace_Fourier_param.cos_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_Fourier_param.cos
;
    _name.category_id             atom_site_displace_Fourier_param
    _name.object_id               cos_su
    _name.linked_item_id          '_atom_site_displace_Fourier_param.cos'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_fourier_param.id

    _definition.id                '_atom_site_displace_Fourier_param.id'
    _alias.definition_id          '_atom_site_displace_Fourier_param_id'
    _definition.update            2024-07-31
    _description.text
;
      A code identifying the (in general complex) coefficient of each
      term present in the Fourier series describing the displacive
      modulation of a given atom or rigid group. In the case of a rigid
      group, it applies only to the translational part of the
      distortion. This code must match _atom_site_displace_Fourier.id.
;
    _name.category_id             atom_site_displace_Fourier_param
    _name.object_id               id
    _name.linked_item_id          '_atom_site_displace_Fourier.id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_fourier_param.modulus

    _definition.id                '_atom_site_displace_Fourier_param.modulus'
    _alias.definition_id          '_atom_site_displace_Fourier_param_modulus'
    _definition.update            2024-08-01
    _description.text
;
      The modulus (|An|) of the complex amplitude corresponding to the
      Fourier term defined by _atom_site_displace_Fourier.atom_site_label,
      _atom_site_displace_Fourier.axis and
      _atom_site_displace_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_displace_Fourier_param
    _name.object_id               modulus
    _enumeration.range            0.0:
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_displace_Fourier_param

       _atom_site_displace_Fourier_param.modulus =  Sqrt(p.cos**2 + p.sin**2)
;

save_

save_atom_site_displace_fourier_param.modulus_su

    _definition.id                '_atom_site_displace_Fourier_param.modulus_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_Fourier_param.modulus
;
    _name.category_id             atom_site_displace_Fourier_param
    _name.object_id               modulus_su
    _name.linked_item_id          '_atom_site_displace_Fourier_param.modulus'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_fourier_param.phase

    _definition.id                '_atom_site_displace_Fourier_param.phase'
    _alias.definition_id          '_atom_site_displace_Fourier_param_phase'
    _definition.update            2024-08-01
    _description.text
;
      The phase (\fn/2\\p), in cycles, of the complex amplitude
      corresponding to the Fourier term defined by
      _atom_site_displace_Fourier.atom_site_label,
      _atom_site_displace_Fourier.axis and
      _atom_site_displace_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_displace_Fourier_param
    _name.object_id               phase
    _enumeration.range            -1.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_displace_Fourier_param

       _atom_site_displace_Fourier_param.phase =
                     Phase(Complex(p.cos,-p.sin))/TwoPi
;

save_

save_atom_site_displace_fourier_param.phase_su

    _definition.id                '_atom_site_displace_Fourier_param.phase_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_Fourier_param.phase
;
    _name.category_id             atom_site_displace_Fourier_param
    _name.object_id               phase_su
    _name.linked_item_id          '_atom_site_displace_Fourier_param.phase'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_fourier_param.sin

    _definition.id                '_atom_site_displace_Fourier_param.sin'
    _alias.definition_id          '_atom_site_displace_Fourier_param_sin'
    _definition.update            2024-08-01
    _description.text
;
      The sine coefficient (Asn) corresponding to the Fourier term defined
      by _atom_site_displace_Fourier.atom_site_label,
      _atom_site_displace_Fourier.axis, and
      _atom_site_displace_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_displace_Fourier_param
    _name.object_id               sin
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_displace_Fourier_param

       _atom_site_displace_Fourier_param.sin = -p.modulus*Sin(TwoPi*p.phase)
;

save_

save_atom_site_displace_fourier_param.sine_su

    _definition.id                '_atom_site_displace_Fourier_param.sine_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_Fourier_param.sin
;
    _name.category_id             atom_site_displace_Fourier_param
    _name.object_id               sin_su
    _name.linked_item_id          '_atom_site_displace_Fourier_param.sin'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_ATOM_SITE_DISPLACE_LEGENDRE

    _definition.id                ATOM_SITE_DISPLACE_LEGENDRE
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      The set of harmonic functions used in the Fourier series
      describing the Modulation functions is orthogonal and complete
      in the interval [0,1).  However within the x4 interval defined
      by a Crenel function orthogonality is no longer preserved and
      therefore the Fourier coefficients are correlated and the
      refinement becomes fragile. There are several ways to avoid this
      technical problem (see Petricek et al., 2016). One of them is to
      use orthogonal or orthogonalized sets of functions defined
      within the Crenel interval. This procedure is more robust than
      the orthogonalization of harmonics described in
      *_ORTHO. categories. Moreover these sets of functions are
      complete. Two different sets of orthogonal or orthogonalized
      functions have been implemented in the package JANA (Petricek et
      al., 2016, Petricek et al., 2023): Legendre polynomials and the
      so-called x-harmonics. Legendre polynomials are orthogonal in
      the Crenel interval and can be easily calculated by the
      recurrence relation:

      P~0~(x) = 1
      P~1~(x) = x
      (n+1)P~n+1~(x) = (2n+1)x P~n~(x) - nP~n-1~(x)

      Notice that Legendre polynomials are restricted to
      one-dimensional cases and include as a particular case the
      sawtooth modulation.

      Data items in the ATOM_SITE_DISPLACE_LEGENDRE category record
      details about the Legendre polynomials used to describe the
      displacive modulations when the atomic domain of a given atom is
      restricted by a Crenel function. In the case of rigid groups,
      items in this category would only include the translational part
      of the modulation. The rotational part would appear in a
      separate list of items belonging to the ATOM_SITE_ROT_LEGENDRE
      category.

      Atomic or rigid-group displacements must be expressed as fractions,
      either of the unit cell axes or of the axes defined by the items
      belonging to the ATOM_SITES_AXES category, through
      _atom_site_displace_Legendre.matrix_seq_id.

      References: Petricek, V., Van Der Lee & Evain, M. (1995).
                  Acta Cryst. A51, 529-535. DOI 10.1107/S0108767395000365
                  On the Use of Crenel Functions for Occupationally Modulated
                  Structures

                  Petricek, V., Eigner, V., Dusek, M. & Cejchan, A. (2016). Z.
                  Kristallogr. 231(5), 301-312. DOI 10.1515/zkri-2015-1913
                  Discontinuous modulation functions and their application for
                  analysis of modulated structures with the computing system
                  JANA2006

                  Petricek, V., Palatinus, L., Plasil, J. & Dusek, M.  (2023).
                  Z. Kristallogr. 238(7-8), 271-282.  DOI 10.1515/zkri-2023-0005
                  Jana2020 - a new version of the crystallographic computing
                  system Jana
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_DISPLACE_LEGENDRE
    _category_key.name            '_atom_site_displace_Legendre.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension               1

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site.label
         _atom_site.type_symbol
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.adp_type
         _atom_site.U_iso_or_equiv
         _atom_site.symmetry_multiplicity
         _atom_site.occupancy
         _atom_site.calc_flag
         _atom_site.refinement_flags_posn
         _atom_site.disorder_assembly
         _atom_site.disorder_group
          Sr Sr 0        0        0        Uani 0.0097(3) 4 0.225  d . . .
          Bi Bi 0        0        0        Uani 0.0097(3) 8 0.075  d . . .
          Fe Fe 0        0        0        Uani 0.0097(3) 4 0.125  d . . .
          O1 O  0        0.451(3) 0        Uiso 0.024(3)  4 0.375  d . . .
          O2 O  0.238(4) 0.243(3) 0.266(4) Uiso 0.018(3)  8 0.1375 d . . .

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_occ_special_func.atom_site_label
         _atom_site_occ_special_func.crenel_c
         _atom_site_occ_special_func.crenel_w
         Sr  0.75        0.225
         Bi  0.9         0.075
         Fe  0           0.125
         O1  0.25        0.375
         O2 -0.0080(15)  0.1375

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_displace_legendre.id
         _atom_site_displace_legendre.atom_site_label
         _atom_site_displace_legendre.axis
         _atom_site_displace_legendre.order
         _atom_site_displace_legendre.coeff
         O1_L_x_1 O1  x  1     0.180(6)
         O1_L_y_1 O1  y  1     0
         O1_L_z_1 O1  z  1     0.000(6)
         O1_L_x_2 O1  x  2     0
         O1_L_y_2 O1  y  2    -0.070(6)
         O1_L_z_2 O1  z  2     0
         O1_L_x_3 O1  x  3     0.262(9)
        # - - - - data truncated for brevity - - - -

        #======================================================================

        Example based on the article:
        Luis Elcoro, Olivier P\'erez, J. M. Perez-Mato and V\'aclav
        Pet\<r\'i\<cek (2012) Acta Cryst. B68, 341-355.
        doi:10.1107/S0108768112018095
        Unified (3+1)-dimensional superspace description of the 2212-type
        stair-like [Bi~2~Sr~3~Fe~2~O~9~]~m~[Bi~4~Sr~6~Fe~2~O~16~] family of
        compounds
;

save_

save_atom_site_displace_legendre.atom_site_label

    _definition.id                '_atom_site_displace_Legendre.atom_site_label'
    _alias.definition_id
        '_jana_atom_site_displace_Legendre_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom or rigid group in a loop in which
      the Legendre components of its displacive modulation are listed.
      This code must match the _atom_site.label of the associated
      coordinate list and conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_displace_Legendre
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_legendre.axis

    _definition.id                '_atom_site_displace_Legendre.axis'
    _alias.definition_id          '_jana_atom_site_displace_Legendre_axis'
    _definition.update            2024-07-27
    _description.text
;
      A label identifying the displacement component of a given atom
      or rigid group that is being parameterized by Legendre polynomials.
      a, b and c are the basic lattice vectors of the reference
      structure. For composites they refer to the reference structure of
      each subsystem. a~1~, a~2~ and a~3~ are defined by the
      items belonging to the ATOM_SITES_AXES category, through
      _atom_site_displace_Legendre.matrix_seq_id.
;
    _name.category_id             atom_site_displace_Legendre
    _name.object_id               axis
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         x
;
         displacement along the a axis
;
         y
;
         displacement along the b axis
;
         z
;
         displacement along the c axis
;
         a1
;
         displacement along the first axis after applying
         _atom_sites_axes.matrix
;
         a2
;
         displacement along the second axis after applying
         _atom_sites_axes.matrix
;
         a3
;
         displacement along the third axis after applying
         _atom_sites_axes.matrix
;

save_

save_atom_site_displace_legendre.coeff

    _definition.id                '_atom_site_displace_Legendre.coeff'
    _alias.definition_id
        '_jana_atom_site_displace_Legendre_param_coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient corresponding to the Legendre polynomial
      defined by _atom_site_displace_Legendre.atom_site_label,
      _atom_site_displace_Legendre.axis and _atom_site_displace_Legendre.order.
;
    _name.category_id             atom_site_displace_Legendre
    _name.object_id               coeff
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_displace_legendre.coeff_su

    _definition.id                '_atom_site_displace_Legendre.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_Legendre.coeff
;
    _name.category_id             atom_site_displace_Legendre
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_displace_Legendre.coeff'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_legendre.id

    _definition.id                '_atom_site_displace_Legendre.id'
    _definition.update            2017-09-28
    _description.text
;
      A code identifying each component of the displacive modulation of
      a given atom or rigid group when the modulation is expressed in
      terms of Legendre polynomials. In the case of a rigid group, it
      applies only to the translational part of the distortion.
;
    _name.category_id             atom_site_displace_Legendre
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_legendre.matrix_seq_id

    _definition.id                '_atom_site_displace_Legendre.matrix_seq_id'
    _definition.update            2024-08-01
    _name.category_id             atom_site_displace_Legendre
    _name.object_id               matrix_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':transf_matrix_id}]

save_

save_atom_site_displace_legendre.order

    _definition.id                '_atom_site_displace_Legendre.order'
    _alias.definition_id
        '_jana_atom_site_displace_Legendre_param_order'
    _definition.update            2024-08-06
    _description.text
;
      The order of the Legendre polynomial.
;
    _name.category_id             atom_site_displace_Legendre
    _name.object_id               order
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            1:

save_

save_ATOM_SITE_DISPLACE_ORTHO

    _definition.id                ATOM_SITE_DISPLACE_ORTHO
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_DISPLACE_ORTHO category record
      details about the orthogonalized functions defined to solve
      correlation problems during the refinement of displacive
      modulations when the atomic domain of a given atom is restricted
      by a Crenel function. The functions are constructed selecting
      Fourier harmonics until the desired degree of orthogonality and
      completeness is reached (see
      _atom_site_occ_special_func.crenel_ortho_eps).

      In the case of rigid groups, items in this category would only
      include the translational part of the modulation. The rotational
      part would appear in a separate list of items belonging to the
      ATOM_SITE_ROT_ORTHO category.

      Atomic or rigid-group displacements must be expressed as fractions,
      either of the unit cell axes or of the axes defined by the items
      belonging to the ATOM_SITES_AXES category, through
      _atom_site_displace_ortho.matrix_seq_id.

      Notice that the global results could also be expressed (losing
      information about the orthogonalized set of functions) using the
      data items defined in the categories ATOM_SITE_DISPLACE_FOURIER
      and ATOM_SITE_DISPLACE_FOURIER_PARAM.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_DISPLACE_ORTHO
    _category_key.name            '_atom_site_displace_ortho.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension               1

        loop_
         _cell_wave_vector.seq_id
         _cell_wave_vector.xyz
          1  [0.000000,0.234000,0.000000]

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site.label
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.U_iso_or_equiv
         _atom_site.adp_type
         _atom_site.calc_flag
         _atom_site.refinement_flags_posn
         _atom_site.occupancy
         _atom_site.disorder_assembly
         _atom_site.disorder_group
         _atom_site.type_symbol
          Co  -0.16084(16) -0.3052(4) 0.0879(2)    0.0105(4)  Uani d . 1 . . Co
          Zn1 -0.21276(11)  0         0.09149(9)   0.0174(3)  Uani d . 1 . . Zn
          Zn2  0.41599(17)  0         0.02151(12)  0.0215(5)  Uani d . 1 . . Zn
          Zn3  0.27052(14)  0         0.23105(11)  0.0136(4)  Uani d . 1 . . Zn
          Zn4  0.07312(9)   0         0.09012(7)   0.0146(3)  Uani d . 1 . . Zn
          Zn5 -0.43014(9)   0         0.21472(7)   0.0140(3)  Uani d . 1 . . Zn

        loop_
         _atom_site_Fourier_wave_vector.seq_id
         _atom_site_Fourier_wave_vector.q_coeff_seq_id
         _atom_site_Fourier_wave_vector.q_coeff
            0  [1]  [0]
            1  [1]  [1]
            2  [1]  [2]
            3  [1]  [3]
            4  [1]  [4]

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_occ_special_func.atom_site_label
         _atom_site_occ_special_func.crenel_c
         _atom_site_occ_special_func.crenel_w
         Zn2  0.75   0.5
         Zn3  0.75   0.5

        loop_
         _atom_site_displace_special_func.atom_site_label
         _atom_site_displace_special_func.sawtooth_ay
         _atom_site_displace_special_func.sawtooth_c
         _atom_site_displace_special_func.sawtooth_w
         Co   0.01(2)   0.161(6)  0.241(1)
         Zn1  0.082(7)  0.75      0.759(1)

        loop_
         _atom_sites_ortho.func_id
         _atom_sites_ortho.wave_vector_seq_id_list
         _atom_sites_ortho.coeff_cos_list
         _atom_sites_ortho.coeff_sin_list
         o1  [0,1]      [-3.322,0]        [0,4.323]
         o2  [0,1]      [-20.803,11.454]  [0,31.365]
         o3  [0,1]      [0.497,0]         [0,1.774]
         o4  [0,1]      [0,1.287]         [0,0]
         o5  [0,1,2]    [0,0.199,0]       [0,0,1.417]
         o6  [0,1,2]    [-0.870,0,2.020]  [0,-1.611,0]
         o7  [0,1]      [2.069,0]         [0,3.249]
         o8  [0,1]      [0,1.414]         [0,0]
         o9  [0,1,2]    [0,2.271,0]       [0,0,2.267]
         o10 [0,1,2]    [2.187,0,1.973]   [0,2.785,0]

        loop_
         _atom_site_displace_ortho.id
         _atom_site_displace_ortho.atom_site_label
         _atom_site_displace_ortho.axis
         _atom_site_displace_ortho.func_id
         _atom_site_displace_ortho.coeff
         Co_o1_x    Co   x  o1   0.0012(3)
         Co_o2_x    Co   x  o2  -0.00013(3)
         Co_o1_y    Co   y  o1  -0.002(2)
         Co_o2_y    Co   y  o2   0.0003(2)
         Co_o1_z    Co   z  o1   0.0004(2)
         Co_o2_z    Co   z  o2   0.00003(3)
         Zn1_o3_x   Zn1  x  o3   0.0050(1)
         Zn1_o6_x   Zn1  x  o6  -0.0015(1)
         Zn1_o4_y   Zn1  y  o4   0.012(3)
         Zn1_o5_y   Zn1  y  o5   0.003(1)
         Zn1_o3_z   Zn1  z  o3   0.00101(7)
         Zn1_o6_z   Zn1  z  o6  -0.00069(5)
        # - - - - data truncated for brevity - - - -

        #======================================================================

        Example based on the article:
        Hanna Lind, Magnus Bostrom, Vaclav Petricek and Sven Lidin (2003)
        Acta Cryst. B59, 720-729. doi:10.1107/S0108768103019694
        Structure of \d~1~-CoZn~7.8~, an example of a phason pinning-unpinning
        transformation?
;

save_

save_atom_site_displace_ortho.atom_site_label

    _definition.id                '_atom_site_displace_ortho.atom_site_label'
    _alias.definition_id
        '_jana_atom_site_displace_crenel_ortho_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom or rigid group in a loop in which
      the ortho components of its displacive modulation are listed.
      This code must match the _atom_site.label of the associated
      coordinate list andconform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_displace_ortho
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_ortho.axis

    _definition.id                '_atom_site_displace_ortho.axis'
    _alias.definition_id          '_jana_atom_site_displace_crenel_ortho_axis'
    _definition.update            2024-07-27
    _description.text
;
      A label identifying the displacement component of a given atom
      or rigid group that is being parameterized by orthogonalized
      functions. a, b and c are the basic lattice vectors of the reference
      structure. For composites they refer to the reference structure of
      each subsystem. a~1~, a~2~ and a~3~ are defined by the
      items belonging to the ATOM_SITES_AXES category, through
      _atom_site_displace_ortho.matrix_seq_id.
;
    _name.category_id             atom_site_displace_ortho
    _name.object_id               axis
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         x
;
         displacement along the a axis
;
         y
;
         displacement along the b axis
;
         z
;
         displacement along the c axis
;
         a1
;
         displacement along the first axis after applying
         _atom_sites_axes.matrix
;
         a2
;
         displacement along the second axis after applying
         _atom_sites_axes.matrix
;
         a3
;
         displacement along the third axis after applying
         _atom_sites_axes.matrix
;

save_

save_atom_site_displace_ortho.coeff

    _definition.id                '_atom_site_displace_ortho.coeff'
    _alias.definition_id
        '_jana_atom_site_displace_crenel_ortho_param_coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient corresponding to the orthogonalized function
      Defined by _atom_site_displace_ortho.atom_site_label,
      _atom_site_displace_ortho.axis and _atom_site_displace_ortho.func_id.
;
    _name.category_id             atom_site_displace_ortho
    _name.object_id               coeff

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_displace_ortho.coeff_su

    _definition.id                '_atom_site_displace_ortho.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_ortho.coeff
;
    _name.category_id             atom_site_displace_ortho
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_displace_ortho.coeff'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_ortho.func_id

    _definition.id                '_atom_site_displace_ortho.func_id'
    _alias.definition_id          '_jana_atom_site_displace_crenel_ortho_id'
    _definition.update            2024-07-31
    _description.text
;
      A code identifying the orthogonalized function used in the
      structural model to describe the displacive modulation of an atom
      or rigid group. This code must match _atom_sites_ortho_func_id.
;
    _name.category_id             atom_site_displace_ortho
    _name.object_id               func_id
    _name.linked_item_id          '_atom_sites_ortho.func_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_ortho.id

    _definition.id                '_atom_site_displace_ortho.id'
    _definition.update            2024-07-31
    _description.text
;
      A code identifying each component of the displacive modulation of
      a given atom or rigid group when the modulation is expressed in
      terms of ortho series.
;
    _name.category_id             atom_site_displace_ortho
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_ortho.matrix_seq_id

    _definition.id                '_atom_site_displace_ortho.matrix_seq_id'
    _definition.update            2024-08-01
    _name.category_id             atom_site_displace_ortho
    _name.object_id               matrix_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':transf_matrix_id}]

save_

save_ATOM_SITE_DISPLACE_SPECIAL_FUNC

    _definition.id                ATOM_SITE_DISPLACE_SPECIAL_FUNC
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_DISPLACE_SPECIAL_FUNC category record
      details about the displacive modulation of an atom site in a
      modulated structure when it is not described by Fourier series.
      Special functions are effective in some cases where the
      modulations are highly anharmonic, since the number of parameters
      is drastically reduced. However, they are in general
      discontinuous or with discontinuous derivatives and therefore
      these functions describe an ideal situation that never occurs
      in a real modulated crystal. Up to now, only a few types of
      special functions have been used and all of them come from the
      JANA suite of programs (Petricek, et al. 2014, Petricek, et al. 2016,
      Petricek, et al. 2023). Although this approach is far from
      being general, it has the advantage that the functions are
      tightly defined and therefore the atomic displacements and
      occupations can be calculated easily. In this dictionary,
      only the special functions available in JANA have been included.
      These are:
        (1) Sawtooth functions for the displacive modulation of atoms and
            rigid groups.
        (2) Zig-Zag functions for the displacive modulation of atoms and
            rigid groups.
        (3) Crenel functions for the occupational modulation of atoms
            and rigid groups. Both of these only apply to
            one-dimensional modulated structures.

      The use of this function is restricted to one-dimensional modulated
      structures.

      In the case of rigid groups, items in this category would only
      include the translational part of the modulation. The rotational
      part would appear in a separate list of items belonging to the
      ATOM_SITE_ROT_SPECIAL_FUNC category.

      Atomic or rigid-group displacements must be expressed as fractions,
      either of the unit cell axes or of the axes defined by the items
      belonging to the ATOM_SITES_AXES category, through
      _atom_site_displace_special_func.matrix_seq_id.

      References: Petricek, V., Dusek, M. & Palatinus, L. (2014).
                  Z. Kristallogr. 229(5), 345-352.  DOI 10.1515/zkri-2014-1737
                  Crystallographic Computing System JANA2006: General features

                  Petricek, V., Eigner, V., Dusek, M. & Cejchan, A. (2016). Z.
                  Kristallogr. 231(5), 301-312. DOI 10.1515/zkri-2015-1913
                  Discontinuous modulation functions and their application for
                  analysis of modulated structures with the computing system
                  JANA2006

                  Petricek, V., Palatinus, L., Plasil, J. & Dusek, M.  (2023).
                  Z. Kristallogr. 238(7-8), 271-282.  DOI 10.1515/zkri-2023-0005
                  Jana2020 - a new version of the crystallographic computing
                  system Jana
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_DISPLACE_SPECIAL_FUNC
    _category_key.name
        '_atom_site_displace_special_func.atom_site_label'

    loop_
      _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension        1

        loop_
          _atom_site.label
          _atom_site.type_symbol
          _atom_site.fract_x
          _atom_site.fract_y
          _atom_site.fract_z
          _atom_site.U_iso_or_equiv
          _atom_site.site_symmetry_multiplicity
          _atom_site.occupancy
       Bi1  Bi  -0.00100(5)  0.27368(5)  0.065418(11)    0.01539(8)  8         1
       Sr1  Sr  0.49973(10)  0.24779(9)    0.17907(3)   0.01935(19)  8  0.865(3)
       Bi2  Bi     0.499728    0.247792      0.179067   0.01935(19)  8  0.135(3)
       Cu   Cu            0        0.25          0.25     0.0078(2)  4         1
       O1   O     0.2505(8)   0.5014(8)     0.2488(2)    0.0138(11)  8         1
       O2   O    0.0005(15)  0.2231(11)     0.1465(2)    0.0176(14)  8         1
       O3   O      0.510(2)  0.3424(11)     0.0694(3)    0.0261(18)  8         1
       O4   O      0.236(4)    0.519(7)    0.0873(13)     0.060(13)  8 0.123(12)

        # - - - - data truncated for brevity - - - -

        loop_
          _atom_site_displace_special_func.atom_site_label
          _atom_site_displace_special_func.sawtooth_ax
          _atom_site_displace_special_func.sawtooth_ay
          _atom_site_displace_special_func.sawtooth_az
          _atom_site_displace_special_func.sawtooth_c
          _atom_site_displace_special_func.sawtooth_w
          O2  -0.165(8)  0  0  0.640(4)  0.969(8)
          O3  -0.245(6)  0  0  0.588(4)         1
        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Andrei Mironov, V\'aclav Pet\<r\'i\<cek, Nellie Khasanova and Evgenie
        Antipov (2016) Acta Cryst. B72, 395-403. doi:10.1107/S2052520616005643
        New insight on bismuth cuprates with incommensurate modulated
        structures.
;
;
        # Same example using vectors

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension        1

        # - - - - data truncated for brevity - - - -

        loop_
          _atom_site_displace_special_func.atom_site_label
          _atom_site_displace_special_func.sawtooth_axyz
          _atom_site_displace_special_func.sawtooth_c
          _atom_site_displace_special_func.sawtooth_w
          O2  [-0.165(8),0,0]  0.640(4)  0.969(8)
          O3  [-0.245(6),0,0]  0.588(4)         1
        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Andrei Mironov, V\'aclav Pet\<r\'i\<cek, Nellie Khasanova and Evgenie
        Antipov (2016) Acta Cryst. B72, 395-403. doi:10.1107/S2052520616005643
        New insight on bismuth cuprates with incommensurate modulated
        structures.
;

save_

save_atom_site_displace_special_func.atom_site_label

    _definition.id
        '_atom_site_displace_special_func.atom_site_label'
    _alias.definition_id
        '_atom_site_displace_special_func_atom_site_label'
    _definition.update            2014-06-27
    _description.text
;
      The code that identifies an atom or rigid group in a loop in which
      the special function that describes its displacive modulation is being
      defined. This code must match the _atom_site.label of the
      associated coordinate list and conform to the rules described in
      _atom_site.label.
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_special_func.matrix_seq_id

    _definition.id
        '_atom_site_displace_special_func.matrix_seq_id'
    _definition.update            2024-08-01
    _name.category_id             atom_site_displace_special_func
    _name.object_id               matrix_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':transf_matrix_id}]

save_

save_atom_site_displace_special_func.sawtooth

    _definition.id                '_atom_site_displace_special_func.sawtooth'
    _definition.update            2024-08-08
    _description.text
;
       _atom_site_displace_special_func.sawtooth_ items are the
       adjustable parameters of a sawtooth function.
       A displacive sawtooth function along the internal space is
       defined as follows:

             [ux, uy, uz] = 2* [ax, ay, az] * ((x4-c)/w)

       for x4 belonging to the interval [c-(w/2), c+(w/2)], where ax,
       ay and az are the amplitudes (maximum displacements)
       along each axis (see below), w is its width, x4 is the
       internal coordinate and c is the centre of the function in
       internal space.

       Atomic or rigid-group displacements must be expressed as fractions,
       either of the unit cell axes or of the axes defined by the items
       belonging to the ATOM_SITES_AXES category, through
       _atom_site_displace_special_func.matrix_seq_id.
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth
    _type.purpose                 Describe
    _type.source                  Recorded
    _type.container               Single
    _type.contents                Text

save_

save_atom_site_displace_special_func.sawtooth_ax

    _definition.id                '_atom_site_displace_special_func.sawtooth_ax'
    _alias.definition_id          '_atom_site_displace_special_func_sawtooth_ax'
    _definition.update            2024-08-01
    _description.text
;
    The amplitude (maximum displacement) along the a (or a1) axis of the
    sawtooth function described in _atom_site_displace_special_func.sawtooth
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_ax
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  s  as  atom_site_displace_special_func

            _atom_site_displace_special_func.sawtooth_ax = s.sawtooth_axyz[0]
;

save_

save_atom_site_displace_special_func.sawtooth_ax_su

    _definition.id
        '_atom_site_displace_special_func.sawtooth_ax_su'
    _definition.update            2024-04-08
    _description.text
;
     Standard uncertainty of _atom_site_displace_special_func.sawtooth_ax
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_ax_su
    _name.linked_item_id          '_atom_site_displace_special_func.sawtooth_ax'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_special_func.sawtooth_axyz

    _definition.id
        '_atom_site_displace_special_func.sawtooth_axyz'
    _definition.update            2024-08-06
    _description.text
;
    The vector of amplitudes (maximum displacements) along the a (or a1),
    b (or a2) and c (or a3) axis of the sawtooth function described in
    _atom_site_displace_special_func.sawtooth
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_axyz
    _type.purpose                 Measurand
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _enumeration.default          [0.0,0.0,0.0]
    _units.code                   none
    _method.purpose               Evaluation
    _method.expression
;
       With  s  as  atom_site_displace_special_func

            _atom_site_displace_special_func.sawtooth_axyz =                   \
                              [ s.sawtooth_ax, s.sawtooth_ay, s.sawtooth_az ]
;

save_

save_atom_site_displace_special_func.sawtooth_axyz_su

    _definition.id
        '_atom_site_displace_special_func.sawtooth_axyz_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _atom_site_displace_special_func.sawtooth_axyz
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_axyz_su
    _name.linked_item_id
        '_atom_site_displace_special_func.sawtooth_axyz'
    _type.purpose                 SU
    _type.source                  Related
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   none

save_

save_atom_site_displace_special_func.sawtooth_ay

    _definition.id                '_atom_site_displace_special_func.sawtooth_ay'
    _alias.definition_id          '_atom_site_displace_special_func_sawtooth_ay'
    _definition.update            2024-08-01
    _description.text
;
    The amplitude (maximum displacement) along the b (or a2) axis of the
    sawtooth function described in _atom_site_displace_special_func.sawtooth
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_ay
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  s  as  atom_site_displace_special_func

            _atom_site_displace_special_func.sawtooth_ay = s.sawtooth_axyz[1]
;

save_

save_atom_site_displace_special_func.sawtooth_ay_su

    _definition.id
        '_atom_site_displace_special_func.sawtooth_ay_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_special_func.sawtooth_ay
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_ay_su
    _name.linked_item_id          '_atom_site_displace_special_func.sawtooth_ay'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_special_func.sawtooth_az

    _definition.id                '_atom_site_displace_special_func.sawtooth_az'
    _alias.definition_id          '_atom_site_displace_special_func_sawtooth_az'
    _definition.update            2024-08-01
    _description.text
;
     The amplitude (maximum displacement) along the c (or a3) axis of the
     sawtooth function described in _atom_site_displace_special_func.sawtooth
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_az
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  s  as  atom_site_displace_special_func

            _atom_site_displace_special_func.sawtooth_az = s.sawtooth_axyz[2]
;

save_

save_atom_site_displace_special_func.sawtooth_az_su

    _definition.id
        '_atom_site_displace_special_func.sawtooth_az_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_special_func.sawtooth_az
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_az_su
    _name.linked_item_id          '_atom_site_displace_special_func.sawtooth_az'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_special_func.sawtooth_c

    _definition.id                '_atom_site_displace_special_func.sawtooth_c'
    _alias.definition_id          '_atom_site_displace_special_func_sawtooth_c'
    _definition.update            2024-08-01
    _description.text
;
    The centre of the sawtooth function described in
    _atom_site_displace_special_func.sawtooth
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_c
    _enumeration.range            0.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_displace_special_func.sawtooth_c_su

    _definition.id
        '_atom_site_displace_special_func.sawtooth_c_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_special_func.sawtooth_c
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_c_su
    _name.linked_item_id          '_atom_site_displace_special_func.sawtooth_c'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_special_func.sawtooth_w

    _definition.id                '_atom_site_displace_special_func.sawtooth_w'
    _alias.definition_id          '_atom_site_displace_special_func_sawtooth_w'
    _definition.update            2024-08-01
    _description.text
;
    The width of the sawtooth function described in
    _atom_site_displace_special_func.sawtooth
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_w
    _enumeration.range            0.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_displace_special_func.sawtooth_w_su

    _definition.id
        '_atom_site_displace_special_func.sawtooth_w_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_special_func.sawtooth_w
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               sawtooth_w_su
    _name.linked_item_id          '_atom_site_displace_special_func.sawtooth_w'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_special_func.zigzag

    _definition.id                '_atom_site_displace_special_func.zigzag'
    _definition.update            2024-08-08
    _description.text
;
      _atom_site_displace_special_func.zigzag_ items are the
      adjustable parameters of a zigzag function.
      A displacive zigzag function along the internal space is
      defined as follows:

                   2*[ax,ay,az]*(x4-c)/w for x4 in [c-(w/2),c+(w/2)]
      [ux,uy,uz] =
                  -2*[ax,ay,az]*(x4-c)/w for x4 in [c+1/2-(w/2),c+1/2+(w/2)]

      where ax,ay and az are the amplitudes (maximum displacements)
      along each axis (see below), w is its width, x4 is the internal
      coordinate and c is the centre of the function in internal space.

      Atomic or rigid-group displacements must be expressed as fractions,
      either of the unit cell axes or of the axes defined by the items
      belonging to the ATOM_SITES_AXES category, through
      _atom_site_displace_special_func.matrix_seq_id.
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               zigzag
    _type.purpose                 Describe
    _type.source                  Recorded
    _type.container               Single
    _type.contents                Text

save_

save_atom_site_displace_special_func.zigzag_axyz

    _definition.id                '_atom_site_displace_special_func.zigzag_axyz'
    _definition.update            2024-08-06
    _description.text
;
    The vector of amplitudes (maximum displacements) along the a (or a1),
    b (or a2) and c (or a3) axis of the zigzag function described in
    _atom_site_displace_special_func.zigzag
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               zigzag_axyz
    _type.purpose                 Measurand
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _enumeration.default          [0.0,0.0,0.0]
    _units.code                   none

save_

save_atom_site_displace_special_func.zigzag_axyz_su

    _definition.id
        '_atom_site_displace_special_func.zigzag_axyz_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _atom_site_displace_special_func.zigzag_axyz
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               zigzag_axyz_su
    _name.linked_item_id          '_atom_site_displace_special_func.zigzag_axyz'
    _type.purpose                 SU
    _type.source                  Related
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   none

save_

save_atom_site_displace_special_func.zigzag_c

    _definition.id                '_atom_site_displace_special_func.zigzag_c'
    _definition.update            2024-08-01
    _description.text
;
    The centre of the zigzag function described in
    _atom_site_displace_special_func.zigzag
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               zigzag_c
    _enumeration.range            0.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_displace_special_func.zigzag_c_su

    _definition.id                '_atom_site_displace_special_func.zigzag_c_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_special_func.zigzag_c
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               zigzag_c_su
    _name.linked_item_id          '_atom_site_displace_special_func.zigzag_c'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_special_func.zigzag_w

    _definition.id                '_atom_site_displace_special_func.zigzag_w'
    _definition.update            2024-08-01
    _description.text
;
    The width of the zigzag function described in
    _atom_site_displace_special_func.zigzag
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               zigzag_w
    _enumeration.range            0.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_displace_special_func.zigzag_w_su

    _definition.id                '_atom_site_displace_special_func.zigzag_w_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_special_func.zigzag_w
;
    _name.category_id             atom_site_displace_special_func
    _name.object_id               zigzag_w_su
    _name.linked_item_id          '_atom_site_displace_special_func.zigzag_w'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_ATOM_SITE_DISPLACE_XHARM

    _definition.id                ATOM_SITE_DISPLACE_XHARM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      The set of harmonic functions used in the Fourier series
      describing the Modulation functions is orthogonal and complete
      in the interval [0,1).  However within of the x4 interval
      defined by a Crenel function orthogonality is no longer
      preserved and therefore the Fourier coefficients are correlated
      and the refinement becomes fragile. There are several ways to
      avoid this technical problem (see Petricek et al., 2016). One of
      them is to use orthogonal or orthogonalized sets of functions
      defined within the Crenel interval. This procedure is more
      robust than the orthogonalization of harmonics described in
      *_ORTHO. categories. Moreover these sets of functions are
      complete. Two different sets of orthogonal or orthogonalized
      functions have been implemented in JANA (Petricek et al., 2023):
      Legendre polynomials and the so-called x-harmonics. x-harmonic
      functions are defined from the set (Petricek, et al., 2016):

      {1, x, sin(\p x), cos(\p x), ... , sin(n\p x), cos(n\p x)}

      and a subsequent orthogonalization (see the above reference and
      the supplementary material) owing to the presence of x which is
      not orthogonal to sin(n\p x) (for any n). Notice that
      x-harmonics are restricted to one- dimensional cases and include
      as a particular case the sawtooth modulation.

      Data items in the ATOM_SITE_DISPLACE_XHARM category record
      details about the x-harmonic functions used to describe the
      displacive modulations when the atomic domain of a given atom is
      restricted by a crenel function. In the case of rigid groups,
      items in this category would only include the translational part
      of the modulation. The rotational part would appear in a
      separate list of items belonging to the ATOM_SITE_ROT_XHARM
      category.

      Atomic or rigid-group displacements must be expressed as fractions,
      either of the unit cell axes or of the axes defined by the items
      belonging to the ATOM_SITES_AXES category, through
      _atom_site_displace_xharm.matrix_seq_id.

      References: Petricek, V., Van Der Lee & Evain, M. (1995).
                  Acta Cryst. A51, 529-535. DOI 10.1107/S0108767395000365
                  On the Use of Crenel Functions for Occupationally Modulated
                  Structures

                  Petricek, V., Eigner, V., Dusek, M. & Cejchan, A. (2016). Z.
                  Kristallogr. 231(5), 301-312. DOI 10.1515/zkri-2015-1913
                  Discontinuous modulation functions and their application for
                  analysis of modulated structures with the computing system
                  JANA2006

                  Petricek, V., Palatinus, L., Plasil, J. & Dusek, M.  (2023).
                  Z. Kristallogr. 238(7-8), 271-282.  DOI 10.1515/zkri-2023-0005
                  Jana2020 - a new version of the crystallographic computing
                  system Jana
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_DISPLACE_XHARM
    _category_key.name            '_atom_site_displace_xharm.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension        1

        loop_
          _atom_site.label
          _atom_site.type_symbol
          _atom_site.fract_x
          _atom_site.fract_y
          _atom_site.fract_z
          _atom_site.U_iso_or_equiv
          _atom_site.site_symmetry_multiplicity
          Fe1     Fe          0.5  0.356897(15)          0.25    0.01310(9)  4
          S1      S    0.33286(3)  0.351013(19)   -0.19593(5)   0.01402(11)  8
          O2s     O    0.22908(8)    0.34282(6)  -0.11998(17)     0.0264(4)  8
          O4s     O   0.33393(13)    0.42245(6)    -0.3114(2)     0.0277(4)  8
          O3s     O   0.35027(13)    0.28467(7)    -0.3189(2)     0.0258(7)  8
          O6w     O     0.6044(2)   0.27668(14)     0.1791(4)     0.0317(9)  8

        # - - - - data truncated for brevity - - - -

        loop_
          _atom_site_occ_special_func.atom_site_label
          _atom_site_occ_special_func.crenel_c
          _atom_site_occ_special_func.crenel_w
          O3s        0.2381    1
          O6w        0.5946    1

        loop_
          _atom_site_displace_xharm.id
          _atom_site_displace_xharm.atom_site_label
          _atom_site_displace_xharm.axis
          _atom_site_displace_xharm.order
          _atom_site_displace_xharm.coeff
          O3sXhx1 O3s    x  1     0.0067(8)
          O3sXhy1 O3s    y  1     0.0003(6)
          O3sXhz1 O3s    z  1    0.0159(12)
          O3sXhx2 O3s    x  2  -0.01056(14)
          O3sXhy2 O3s    y  2   -0.00082(7)
          O3sXhz2 O3s    z  2    -0.0215(3)
          O3sXhx3 O3s    x  3    0.0011(11)
          O3sXhy3 O3s    y  3     0.0035(8)
          O3sXhz3 O3s    z  3   -0.0059(16)
          O3sXhx4 O3s    x  4   -0.0047(15)
          O3sXhy4 O3s    y  4   -0.0001(12)
          O3sXhz4 O3s    z  4     -0.003(3)
          O6wXhx1 O6w    x  1    -0.0090(7)
          O6wXhy1 O6w    y  1    -0.0037(6)
          O6wXhz1 O6w    z  1   -0.0145(15)
          O6wXhx2 O6w    x  2     0.0086(2)
          O6wXhy2 O6w    y  2   0.00234(13)
          O6wXhz2 O6w    z  2     0.0173(3)
          O6wXhx3 O6w    x  3    0.0021(10)
          O6wXhy3 O6w    y  3    -0.0016(7)
          O6wXhz3 O6w    z  3      0.000(2)
          O6wXhx4 O6w    x  4    0.0038(18)
          O6wXhy4 O6w    y  4    0.0036(13)
          O6wXhz4 O6w    z  4      0.008(3)

        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Tamara J. Bernarchuk, Wolfgang Hornfeck, Vasyl Kinzhybalo, Zhengyang
        Zhou, Michal Dusek and Adam Pietraszko (2019)
        Acta Cryst. B75, 1144-1151. doi:10.1107/S2052520619013155
        The structures and phase transitions in 4-aminopyridinium
        tetraaquabis(sulfato)iron(III),
        (C~5~H~7~N~2~)[Fe^III^(H~2~O)~4~(SO~4~)~2~]
;

save_

save_atom_site_displace_xharm.atom_site_label

    _definition.id                '_atom_site_displace_xharm.atom_site_label'
    _alias.definition_id          '_jana_atom_site_displace_XHarm_site_label'
    _definition.update            2024-07-31
    _description.text
;
       The code that identifies an atom or rigid group in a loop in which the
       x-harmonics components of its displacive modulation are listed. In
       the case of a rigid group, this list would only include the
       translational part of its displacive modulation. The rotational part
       (if any) would appear in a separate list (see
       _atom_site_rot_xharm.atom_site_label). This code must match the
       _atom_site.label of the associated coordinate list and conform to the
       rules described in _atom_site.label.
;
    _name.category_id             atom_site_displace_xharm
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_xharm.axis

    _definition.id                '_atom_site_displace_xharm.axis'
    _alias.definition_id          '_jana_atom_site_displace_XHarm_axis'
    _definition.update            2024-07-27
    _description.text
;
      A label identifying the displacement component of a given atom
      or rigid group that is being parameterized by x-harmonic functions.
      a, b and c are the basic lattice vectors of the reference
      structure. For composites they refer to the reference structure of
      each subsystem. a~1~, a~2~ and a~3~ are defined by the
      items belonging to the ATOM_SITES_AXES category, through
      _atom_site_displace_xharm.matrix_seq_id.
;
    _name.category_id             atom_site_displace_xharm
    _name.object_id               axis
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         x
;
         displacement along the a axis
;
         y
;
         displacement along the b axis
;
         z
;
         displacement along the c axis
;
         a1
;
         displacement along the first axis after applying
         _atom_sites_axes.matrix
;
         a2
;
         displacement along the second axis after applying
         _atom_sites_axes.matrix
;
         a3
;
         displacement along the third axis after applying
         _atom_sites_axes.matrix
;

save_

save_atom_site_displace_xharm.coeff

    _definition.id                '_atom_site_displace_xharm.coeff'
    _alias.definition_id          '_jana_atom_site_displace_XHarm_param_coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient corresponding to the x-harmonic function
      defined by _atom_site_displace_xharm.atom_site_label,
      _atom_site_displace_xharm.axis and _atom_site_displace_xharm.order.
      Atomic or rigid-group displacements must be expressed as fractions
      of the unit cell or in angstroms if the modulations are referred to some
      special axes defined by the items belonging to the
      ATOM_SITES_AXES category, through _atom_site_rot_xharm.matrix_seq_id.
;
    _name.category_id             atom_site_displace_xharm
    _name.object_id               coeff
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_displace_xharm.coeff_su

    _definition.id                '_atom_site_displace_xharm.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_displace_xharm.coeff
;
    _name.category_id             atom_site_displace_xharm
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_displace_xharm.coeff'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_displace_xharm.id

    _definition.id                '_atom_site_displace_xharm.id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying each component of the displacive modulation of
      a given atom or rigid group when the modulation is expressed in
      terms of x-harmonics. In the case of a rigid group, it applies
      only to the translational part of the distortion.
;
    _name.category_id             atom_site_displace_xharm
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_displace_xharm.matrix_seq_id

    _definition.id                '_atom_site_displace_xharm.matrix_seq_id'
    _definition.update            2024-08-01
    _name.category_id             atom_site_displace_xharm
    _name.object_id               matrix_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':transf_matrix_id}]

save_

save_atom_site_displace_xharm.order

    _definition.id                '_atom_site_displace_xharm.order'
    _alias.definition_id          '_jana_atom_site_displace_XHarm_param_order'
    _definition.update            2024-08-06
    _description.text
;
      The order of each x-harmonic function, where 1, points to the
      function proportional to x, etc.
;
    _name.category_id             atom_site_displace_xharm
    _name.object_id               order
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            1:

save_

save_ATOM_SITE_FOURIER_WAVE_VECTOR

    _definition.id                ATOM_SITE_FOURIER_WAVE_VECTOR
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_FOURIER_WAVE_VECTOR category record
      details about the wave vectors of the Fourier terms used in the
      structural model to describe the atomic modulation functions. They
      are linear combinations with integer coefficients of the independent
      wave vectors given in the _cell_wave_vector. list. Therefore, wave
      vectors are expressed with respect to the three-dimensional reciprocal
      basis that spans the lattice of main reflections. However, in the
      case of composites these wave vectors are expressed with respect to
      the three-dimensional reciprocal basis of each subsystem (see
      _cell_subsystem.matrix_W_).

      A generic Fourier wave vector can be given explicitly by its
      components (see item _atom_site_Fourier_wave_vector.x,
      _atom_site_Fourier_wave_vector.y and _atom_site_Fourier_wave_vector.z)
      or expressed as k=n(1)q(1)+...+n(p)q(p), where p is given by
      _cell_modulation_dimension (with a maximum value of 8).

      In that case, _atom_site_Fourier_wave_vector.coeff contains the
      coefficients that express a given k as a linear combination of the
      independent wave vectors given in the CELL_WAVE_VECTOR category. The
      enumeration of the independent wave vectors (1,2, ...,9) is given by
      the value of _atom_site_Fourier_wave_vector_.q_coeff_seq_id matching
      the corresponding value of _cell_wave_vector.seq_id.

;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_FOURIER_WAVE_VECTOR
    _category_key.name            '_atom_site_Fourier_wave_vector.seq_id'

save_

save_atom_site_fourier_wave_vector.description

    _definition.id                '_atom_site_Fourier_wave_vector.description'
    _alias.definition_id          '_atom_site_Fourier_wave_vector_description'
    _definition.update            2014-06-27
    _description.text
;
      A description of the linear combination involved in a given
      Fourier wave vector used to describe the atomic modulation
      functions.
;
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               description
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text
    _description_example.case     q(4)=q(1)+q(2)

save_

save_atom_site_fourier_wave_vector.q1_coeff

    _definition.id                '_atom_site_Fourier_wave_vector.q1_coeff'

    loop_
      _alias.definition_id
         '_atom_site_Fourier_wave_vector_q1_coeff'
         '_jana_atom_site_Fourier_wave_vector_q1_coeff'

    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q1_coeff

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_element}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q1_coeff = m.q_coeff[0]
;

save_

save_atom_site_fourier_wave_vector.q1_coeff_seq_id

    _definition.id
        '_atom_site_Fourier_wave_vector.q1_coeff_seq_id'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q1_coeff_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_seq_id}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q1_coeff_seq_id = m.q_coeff_seq_id[0]
;

save_

save_atom_site_fourier_wave_vector.q2_coeff

    _definition.id                '_atom_site_Fourier_wave_vector.q2_coeff'

    loop_
      _alias.definition_id
         '_atom_site_Fourier_wave_vector_q2_coeff'
         '_jana_atom_site_Fourier_wave_vector_q2_coeff'

    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q2_coeff

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_element}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q2_coeff = m.q_coeff[1]
;

save_

save_atom_site_fourier_wave_vector.q2_coeff_seq_id

    _definition.id
        '_atom_site_Fourier_wave_vector.q2_coeff_seq_id'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q2_coeff_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_seq_id}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q2_coeff_seq_id = m.q_coeff_seq_id[1]
;

save_

save_atom_site_fourier_wave_vector.q3_coeff

    _definition.id                '_atom_site_Fourier_wave_vector.q3_coeff'

    loop_
      _alias.definition_id
         '_atom_site_Fourier_wave_vector_q3_coeff'
         '_jana_atom_site_Fourier_wave_vector_q3_coeff'

    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q3_coeff

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_element}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q3_coeff = m.q_coeff[2]
;

save_

save_atom_site_fourier_wave_vector.q3_coeff_seq_id

    _definition.id
        '_atom_site_Fourier_wave_vector.q3_coeff_seq_id'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q3_coeff_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_seq_id}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q3_coeff_seq_id = m.q_coeff_seq_id[2]
;

save_

save_atom_site_fourier_wave_vector.q4_coeff

    _definition.id                '_atom_site_Fourier_wave_vector.q4_coeff'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q4_coeff

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_element}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q4_coeff = m.q_coeff[3]
;

save_

save_atom_site_fourier_wave_vector.q4_coeff_seq_id

    _definition.id
        '_atom_site_Fourier_wave_vector.q4_coeff_seq_id'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q4_coeff_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_seq_id}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q4_coeff_seq_id = m.q_coeff_seq_id[3]
;

save_

save_atom_site_fourier_wave_vector.q5_coeff

    _definition.id                '_atom_site_Fourier_wave_vector.q5_coeff'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q5_coeff

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_element}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q5_coeff = m.q_coeff[4]
;

save_

save_atom_site_fourier_wave_vector.q5_coeff_seq_id

    _definition.id
        '_atom_site_Fourier_wave_vector.q5_coeff_seq_id'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q5_coeff_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_seq_id}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q5_coeff_seq_id = m.q_coeff_seq_id[4]
;

save_

save_atom_site_fourier_wave_vector.q6_coeff

    _definition.id                '_atom_site_Fourier_wave_vector.q6_coeff'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q6_coeff

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_element}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q6_coeff = m.q_coeff[5]
;

save_

save_atom_site_fourier_wave_vector.q6_coeff_seq_id

    _definition.id
        '_atom_site_Fourier_wave_vector.q6_coeff_seq_id'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q6_coeff_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_seq_id}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q6_coeff_seq_id = m.q_coeff_seq_id[5]
;

save_

save_atom_site_fourier_wave_vector.q7_coeff

    _definition.id                '_atom_site_Fourier_wave_vector.q7_coeff'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q7_coeff

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_element}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q7_coeff = m.q_coeff[6]
;

save_

save_atom_site_fourier_wave_vector.q7_coeff_seq_id

    _definition.id
        '_atom_site_Fourier_wave_vector.q7_coeff_seq_id'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q7_coeff_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_seq_id}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q7_coeff_seq_id = m.q_coeff_seq_id[6]
;

save_

save_atom_site_fourier_wave_vector.q8_coeff

    _definition.id                '_atom_site_Fourier_wave_vector.q8_coeff'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q8_coeff

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_element}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q8_coeff = m.q_coeff[7]
;

save_

save_atom_site_fourier_wave_vector.q8_coeff_seq_id

    _definition.id
        '_atom_site_Fourier_wave_vector.q8_coeff_seq_id'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q8_coeff_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_seq_id}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q8_coeff_seq_id = m.q_coeff_seq_id[7]
;

save_

save_atom_site_fourier_wave_vector.q9_coeff

    _definition.id                '_atom_site_Fourier_wave_vector.q9_coeff'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q9_coeff

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_element}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q9_coeff = m.q_coeff[8]
;

save_

save_atom_site_fourier_wave_vector.q9_coeff_seq_id

    _definition.id
        '_atom_site_Fourier_wave_vector.q9_coeff_seq_id'
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q9_coeff_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':q_coeff_seq_id}]

    _method.purpose               Evaluation
    _method.expression
;
    With m as atom_site_Fourier_wave_vector

    _atom_site_Fourier_wave_vector.q9_coeff_seq_id = m.q_coeff_seq_id[8]
;

save_

save_atom_site_fourier_wave_vector.q_coeff

    _definition.id                '_atom_site_Fourier_wave_vector.q_coeff'
    _definition.update            2024-08-06
    _description.text
;
      The list of coefficients that express a given k as a linear combination
      of the _cell_modulation_dimension independent wave vectors given in
      CELL_WAVE_VECTOR category. The enumeration of the independent wave
      vectors (1,2, ...,9) is given by thes value of
      _atom_site_Fourier_wave_vector_.q_coeff_seq_id matching the
      corresponding value of _cell_wave_vector.seq_id
;
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q_coeff
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Integer
    _enumeration.default          [0]

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

          _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With m as atom_site_Fourier_wave_vector

         temp_Fourier_wave_vector.q_coeff =
                              [m.q1_coeff, m.q2_coeff, m.q3_coeff, m.q4_coeff,
                               m.q5_coeff, m.q6_coeff, m.q7_coeff, m.q8_coeff,
                               m.q9_coeff]

         #Matrix dimension is adjusted here here

         _atom_site_Fourier_wave_vector.q_coeff =
            temp_Fourier_wave_vector.q_coeff[0:_cell.modulation_dimension - 1]

;

save_

save_atom_site_fourier_wave_vector.q_coeff_seq_id

    _definition.id
        '_atom_site_Fourier_wave_vector.q_coeff_seq_id'
    _definition.update            2024-08-06
    _description.text
;
      The list of numeric codes that identifies each independent wave vector
      appearing in the linear combination that expresses a generic
      Fourier wave vector as k=n(1)q(1)+...+n(p)q(p), where p is given
      by _cell_modulation_dimension. In the case of composites these wave
      vectors are expressed with respect to the three-dimensional reciprocal
      basis of each subsystem (see _cell_subsystem.matrix_W_).The codes
      must match those given in _cell_wave_vector.seq_id.
;
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               q_coeff_seq_id
    _name.linked_item_id          '_cell_wave_vector.seq_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Matrix
    _type.contents                Integer
    _enumeration.default          [1]

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With m as atom_site_Fourier_wave_vector

         temp_Fourier_wave_vector.q_coeff_seq_id =
                [ m.q1_coeff_seq_id, m.q2_coeff_seq_id, m.q3_coeff_seq_id,
                  m.q4_coeff_seq_id, m.q5_coeff_seq_id, m.q6_coeff_seq_id,
                  m.q7_coeff_seq_id, m.q8_coeff_seq_id, m.q9_coeff_seq_id ]

         #Matrix dimension is adjusted here here

         _atom_site_Fourier_wave_vector.q_coeff_seq_id =
         temp_Fourier_wave_vector.q_coeff_seq_id[0:_cell.modulation_dimension
           - 1]
;

save_

save_atom_site_fourier_wave_vector.seq_id

    _definition.id                '_atom_site_Fourier_wave_vector.seq_id'
    _alias.definition_id          '_atom_site_Fourier_wave_vector_seq_id'
    _definition.update            2024-04-28
    _description.text
;
      A numeric code identifying the wave vectors defined in
      _atom_site_Fourier_wave_vector.*
;
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               seq_id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_atom_site_fourier_wave_vector.x

    _definition.id                '_atom_site_Fourier_wave_vector.x'
    _alias.definition_id          '_atom_site_Fourier_wave_vector_x'
    _definition.update            2024-07-31
    _description.text
;
      x component of a wave vector used in a Fourier series with
      respect to the three-dimensional reciprocal basis that spans the
      lattice of main reflections or, in the case of composites, with
      respect to the three-dimensional reciprocal basis of a given
      subsystem (see _cell_subsystem.matrix_W_).
;
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               x
    _type.purpose                 Number
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.default          0.0
    _method.purpose               Evaluation
    _method.expression
;
         With  m  as  atom_site_Fourier_wave_vector

            _atom_site_Fourier_wave_vector.x   =   m.xyz[0]
;

save_

save_atom_site_fourier_wave_vector.xyz

    _definition.id                '_atom_site_Fourier_wave_vector.xyz'
    _definition.update            2024-07-31
    _description.text
;
      Components of a wave vector used in a Fourier series with
      respect to the three-dimensional reciprocal basis that spans the
      lattice of main reflections or, in the case of composites, with
      respect to the three-dimensional reciprocal basis of a given
      subsystem (see _cell_subsystem.matrix_W_).
;
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               xyz
    _type.purpose                 Number
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _method.purpose               Evaluation
    _method.expression
;
       With  m  as  atom_site_Fourier_wave_vector

            _atom_site_Fourier_wave_vector.xyz   =   [ m.x, m.y, m.z ]

    # The null vector is allowed for a possible homogeneus term of
    # Fourier Series. But it is also used as a test for the case where
    # m.x, m.y and m.z are not given and therefore an alternative way
    # to have the wave vectors is necessary

       If (_atom_site_Fourier_wave_vector.xyz == [0.0,0.0,0.0]) {

         Loop w as cell_wave_vector {

           i=0

           For s in m.q_coeff_seq_id {

              If (w.seq_id == s) {

                _atom_site_Fourier_wave_vector.xyz += m.q_coeff[i]*w.xyz

               }

              Else i += 1

           } # End For
         }   # End Loop
       }     # End If
;

save_

save_atom_site_fourier_wave_vector.y

    _definition.id                '_atom_site_Fourier_wave_vector.y'
    _alias.definition_id          '_atom_site_Fourier_wave_vector_y'
    _definition.update            2024-07-31
    _description.text
;
      y component of a wave vector used in a Fourier series with
      respect to the three-dimensional reciprocal basis that spans the
      lattice of main reflections or, in the case of composites, with
      respect to the three-dimensional reciprocal basis of a given
      subsystem (see _cell_subsystem.matrix_W_).
;
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               y
    _type.purpose                 Number
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.default          0.0
    _method.purpose               Evaluation
    _method.expression
;
       With  m  as  atom_site_Fourier_wave_vector

            _atom_site_Fourier_wave_vector.y   =   m.xyz[1]
;

save_

save_atom_site_fourier_wave_vector.z

    _definition.id                '_atom_site_Fourier_wave_vector.z'
    _alias.definition_id          '_atom_site_Fourier_wave_vector_z'
    _definition.update            2024-07-31
    _description.text
;
      z component of a wave vector used in a Fourier series with
      respect to the three-dimensional reciprocal basis that spans the
      lattice of main reflections or, in the case of composites, with
      respect to the three-dimensional reciprocal basis of a given
      subsystem (see _cell_subsystem.matrix_W_).
;
    _name.category_id             atom_site_Fourier_wave_vector
    _name.object_id               z
    _type.purpose                 Number
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.default          0.0
    _method.purpose               Evaluation
    _method.expression
;
       With  m  as  atom_site_Fourier_wave_vector

            _atom_site_Fourier_wave_vector.z   =   m.xyz[2]
;

save_

save_ATOM_SITE_OCC_FOURIER

    _definition.id                ATOM_SITE_OCC_FOURIER
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_OCC_FOURIER category record details
      about the Fourier components of the occupational modulation of
      the atom sites in a modulated structure. The (in general complex)
      coefficients of each Fourier component belong to the child category
      ATOM_SITE_OCC_FOURIER_PARAM and may be listed separately.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_OCC_FOURIER
    _category_key.name            '_atom_site_occ_Fourier.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension               2

        loop_
         _cell_wave_vector.seq_id
         _cell_wave_vector.xyz
             1  [0.00338(6),0.15278(14),-0.0138(3)]
             2  [0.63105(7),1.07460(17),-0.4438(3)]

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site.type_symbol
         _atom_site.label
         _atom_site.subsystem_code
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.U_iso_or_equiv
         _atom_site.calc_flag
         _atom_site.refinement_flags_posn
         _atom_site.occupancy
        Sn Sn  H  0          0            0           0.01480(12)  d . 0.851(2)
        Cu Cu  H  0.0029(9)  0.0057(5)    0.1147(3)   0.0229(11)   d . 0.149(2)
        S  S1  H  0.5033(2)  0.84278(12)  0.12342(7)  0.0177(3)    d . 1
        Pb Pb  Q  0.05541(5) 0.24113(4)   0.36783(2)  0.03573(12)  d . 0.701(10
        Sb Sb  Q  0.055408   0.241132     0.367832    0.03573(12)  d . 0.299(10
        S  S2  Q -0.0402(3)  0.2583(2)    0.59639(13) 0.0310(4)    d . 1

        loop_
         _atom_site_Fourier_wave_vector.seq_id
         _atom_site_Fourier_wave_vector.xyz
         _atom_site_Fourier_wave_vector.q_coeff_seq_id
         _atom_site_Fourier_wave_vector.q_coeff
            1  [0.00338,0.15278,-0.0138]  [1]   [1]
            2  [0.63105,1.07460,-0.4438]  [2]   [1]
            3  [0.00676,0.30556,-0.0276]  [1]   [2]
            4  [0.01014,0.45834,-0.0414]  [1]   [2]
            5  [0.01352,0.61112,-0.0552]  [1]   [2]
            6  [0.63443,1.22738,-0.4576]  [1,2] [1,1]

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_occ_Fourier.id
         _atom_site_occ_Fourier.atom_site_label
         _atom_site_occ_Fourier.wave_vector_seq_id
         _atom_site_occ_Fourier_param.cos
         _atom_site_occ_Fourier_param.sin
         Pb_o_1  Pb  1  -0.002(6)   0.170(4)
         Pb_o_2  Pb  2   0          0
         Pb_o_3  Pb  3   0.026(5)   0.002(4)
         Pb_o_4  Pb  4   0.017(6)  -0.042(5)
         Sb_o_1  Sb  1   0.002(6)  -0.170(4)
         Sb_o_2  Sb  2   0          0
         Sb_o_3  Sb  3  -0.026(5)  -0.002(4)
         Sb_o_4  Sb  4  -0.017(6)   0.042(5)

        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Michel Evain, Vaclav Petricek, Yves Moelo and Colette Maurel (2006)
        Acta Cryst. B62, 775-789. doi:10.1107/S010876810602547X
        First (3 + 2)-dimensional superspace approach to the structure of
        levyclaudite-(Sb), a member of the cylindrite-type minerals
;

save_

save_atom_site_occ_fourier.atom_site_label

    _definition.id                '_atom_site_occ_Fourier.atom_site_label'
    _alias.definition_id          '_atom_site_occ_Fourier_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom in a loop in which the Fourier
      components of its occupational modulation are listed. This code must
      match the _atom_site.label of the associated coordinate list and
      conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_occ_Fourier
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_occ_fourier.id

    _definition.id                '_atom_site_occ_Fourier.id'
    _alias.definition_id          '_atom_site_occ_Fourier_id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying each component of the occupational modulation
      of a given atom or rigid group when the modulation is
      expressed in terms of Fourier series.
;
    _name.category_id             atom_site_occ_Fourier
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_occ_fourier.wave_vector_seq_id

    _definition.id                '_atom_site_occ_Fourier.wave_vector_seq_id'
    _alias.definition_id          '_atom_site_occ_Fourier_wave_vector_seq_id'
    _definition.update            2024-04-28
    _description.text
;
      A numeric code identifying the wave vectors of the Fourier terms
      used in the structural model to describe the modulation functions
      corresponding to the occupational part of the distortion. This
      code must match _atom_site_Fourier_wave_vector.seq_id.
;
    _name.category_id             atom_site_occ_Fourier
    _name.object_id               wave_vector_seq_id
    _name.linked_item_id          '_atom_site_Fourier_wave_vector.seq_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Integer

save_

save_ATOM_SITE_OCC_FOURIER_PARAM

    _definition.id                ATOM_SITE_OCC_FOURIER_PARAM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-07-31
    _description.text
;
      Data items in the ATOM_SITE_OCC_FOURIER_PARAM category record
      details about the coefficients of the Fourier series used to
      describe the occupational modulation of the atom sites in a
      modulated structure. The Fourier components are defined in the
      parent category ATOM_SITE_OCC_FOURIER. Notice that items in this
      category may be listed together with those of the
      ATOM_SITE_OCC_FOURIER category. To simplify the description,
      below is explained the one-dimensional case.

      The occupational distortion of a given atom or rigid group is usually
      parameterized by Fourier series. The n-th term of the series commonly
      adopts two different representations: the sine-cosine form,
               Pcn cos(2\\p n x4)+Psn sin(2\\p n x4),
      and the modulus-argument form,
               |Pn| cos(2\\p n x4+\\dn),
      where x4=q*(r+T)+t. q is the modulation wave vector and r and T
      stand for a phase reference position and a lattice translation of
      the reference structure, respectively. The phase reference position
      can be chosen as the average position of the modulated atom, if
      not in a rigid group or, in case of rigid groups a common point
      for all atoms in the group. t is an arbitrary phase, irrelevant for
      incommensurate modulated structures, but essential in the commensurate
      case (see _atom_sites_modulation_global_phase_t_).
;
    _name.category_id             ATOM_SITE_OCC_FOURIER
    _name.object_id               ATOM_SITE_OCC_FOURIER_PARAM
    _category_key.name            '_atom_site_occ_Fourier_param.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension               2

        loop_
         _cell_wave_vector.seq_id
         _cell_wave_vector.xyz
             1  [0.00338(6),0.15278(14),-0.0138(3)]
             2  [0.63105(7),1.07460(17),-0.4438(3)]

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site.type_symbol
         _atom_site.label
         _atom_site.subsystem_code
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.U_iso_or_equiv
         _atom_site.calc_flag
         _atom_site.refinement_flags_posn
         _atom_site.occupancy
        Sn Sn  H  0          0            0           0.01480(12)  d . 0.851(2)
        Cu Cu  H  0.0029(9)  0.0057(5)    0.1147(3)   0.0229(11)   d . 0.149(2)
        S  S1  H  0.5033(2)  0.84278(12)  0.12342(7)  0.0177(3)    d . 1
        Pb Pb  Q  0.05541(5) 0.24113(4)   0.36783(2)  0.03573(12)  d . 0.701(10
        Sb Sb  Q  0.055408   0.241132     0.367832    0.03573(12)  d . 0.299(10
        S  S2  Q -0.0402(3)  0.2583(2)    0.59639(13) 0.0310(4)    d . 1

        loop_
         _atom_site_Fourier_wave_vector.seq_id
         _atom_site_Fourier_wave_vector.xyz
         _atom_site_Fourier_wave_vector.q_coeff_seq_id
         _atom_site_Fourier_wave_vector.q_coeff
            1  [0.00338,0.15278,-0.0138]  [1]   [1]
            2  [0.63105,1.07460,-0.4438]  [2]   [1]
            3  [0.00676,0.30556,-0.0276]  [1]   [2]
            4  [0.01014,0.45834,-0.0414]  [1]   [2]
            5  [0.01352,0.61112,-0.0552]  [1]   [2]
            6  [0.63443,1.22738,-0.4576]  [1,2] [1,1]

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_occ_Fourier.id
         _atom_site_occ_Fourier.atom_site_label
         _atom_site_occ_Fourier.wave_vector_seq_id
         Pb_o_1  Pb  1
         Pb_o_2  Pb  2
         Pb_o_3  Pb  3
         Pb_o_4  Pb  4
         Sb_o_1  Sb  1
         Sb_o_2  Sb  2
         Sb_o_3  Sb  3
         Sb_o_4  Sb  4

        loop_
         _atom_site_occ_Fourier_param.id
         _atom_site_occ_Fourier_param.cos
         _atom_site_occ_Fourier_param.sin
         Pb_o_1 -0.002(6)   0.170(4)
         Pb_o_2  0          0
         Pb_o_3  0.026(5)   0.002(4)
         Pb_o_4  0.017(6)  -0.042(5)
         Sb_o_1  0.002(6)  -0.170(4)
         Sb_o_2  0          0
         Sb_o_3 -0.026(5)  -0.002(4)
         Sb_o_4 -0.017(6)   0.042(5)

         # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Michel Evain, Vaclav Petricek, Yves Moelo and Colette Maurel (2006)
        Acta Cryst. B62, 775-789. doi:10.1107/S010876810602547X
        First (3 + 2)-dimensional superspace approach to the structure of
        levyclaudite-(Sb), a member of the cylindrite-type minerals
;

save_

save_atom_site_occ_fourier_param.cos

    _definition.id                '_atom_site_occ_Fourier_param.cos'
    _alias.definition_id          '_atom_site_occ_Fourier_param_cos'
    _definition.update            2024-08-01
    _description.text
;
       The cosine coefficient (Pcn) corresponding to the Fourier term defined
       by _atom_site_occ_Fourier.atom_site_label and
       _atom_site_occ_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_occ_Fourier_param
    _name.object_id               cos
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_occ_Fourier_param

       _atom_site_occ_Fourier_param.cos =  p.modulus*Cos(TwoPi*p.phase)
;

save_

save_atom_site_occ_fourier_param.cos_su

    _definition.id                '_atom_site_occ_Fourier_param.cos_su'
    _definition.update            2024-08-01
    _description.text
;
      Standard uncertainty of _atom_site_occ_Fourier_param.cos
;
    _name.category_id             atom_site_occ_Fourier_param
    _name.object_id               cos_su
    _name.linked_item_id          '_atom_site_occ_Fourier_param.cos'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_occ_fourier_param.id

    _definition.id                '_atom_site_occ_Fourier_param.id'
    _alias.definition_id          '_atom_site_occ_Fourier_param_id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying the (in general complex) coefficient of each
      term present in the Fourier series describing the occupational
      modulation of a given atom or rigid group. This code must match
      _atom_site_occ_Fourier.id.
;
    _name.category_id             atom_site_occ_Fourier_param
    _name.object_id               id
    _name.linked_item_id          '_atom_site_occ_Fourier.id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_occ_fourier_param.modulus

    _definition.id                '_atom_site_occ_Fourier_param.modulus'
    _alias.definition_id          '_atom_site_occ_Fourier_param_modulus'
    _definition.update            2024-08-01
    _description.text
;
      The modulus (|Pn|) of the complex amplitude corresponding to the
      Fourier term defined by _atom_site_occ_Fourier.atom_site_label
      and _atom_site_occ_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_occ_Fourier_param
    _name.object_id               modulus
    _enumeration.range            0.0:
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_occ_Fourier_param

       _atom_site_occ_Fourier_param.modulus =  Sqrt(p.cos**2+p.sin**2)
;

save_

save_atom_site_occ_fourier_param.modulus_su

    _definition.id                '_atom_site_occ_Fourier_param.modulus_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_occ_Fourier_param.modulus
;
    _name.category_id             atom_site_occ_Fourier_param
    _name.object_id               modulus_su
    _name.linked_item_id          '_atom_site_occ_Fourier_param.modulus'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_occ_fourier_param.phase

    _definition.id                '_atom_site_occ_Fourier_param.phase'
    _alias.definition_id          '_atom_site_occ_Fourier_param_phase'
    _definition.update            2024-08-01
    _description.text
;
      The phase (\dn/2\\p), in cycles, corresponding to the Fourier term
      defined by _atom_site_occ_Fourier.atom_site_label and
      _atom_site_occ_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_occ_Fourier_param
    _name.object_id               phase
    _enumeration.range            -1.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_occ_Fourier_param

       _atom_site_occ_Fourier_param.phase =  Phase(Complex(p.cos,-p.sin))/TwoPi
;

save_

save_atom_site_occ_fourier_param.phase_su

    _definition.id                '_atom_site_occ_Fourier_param.phase_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_occ_Fourier_param.phase
;
    _name.category_id             atom_site_occ_Fourier_param
    _name.object_id               phase_su
    _name.linked_item_id          '_atom_site_occ_Fourier_param.phase'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_occ_fourier_param.sin

    _definition.id                '_atom_site_occ_Fourier_param.sin'
    _alias.definition_id          '_atom_site_occ_Fourier_param_sin'
    _definition.update            2024-08-01
    _description.text
;
      The sine coefficient (Psn) corresponding to the Fourier term defined
      by _atom_site_occ_Fourier.atom_site_label and
      _atom_site_occ_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_occ_Fourier_param
    _name.object_id               sin
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_occ_Fourier_param

       _atom_site_occ_Fourier_param.sin =  -p.modulus*Sin(TwoPi*p.phase)
;

save_

save_atom_site_occ_fourier_param.sine_su

    _definition.id                '_atom_site_occ_Fourier_param.sine_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_occ_Fourier_param.sin
;
    _name.category_id             atom_site_occ_Fourier_param
    _name.object_id               sin_su
    _name.linked_item_id          '_atom_site_occ_Fourier_param.sin'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_ATOM_SITE_OCC_LEGENDRE

    _definition.id                ATOM_SITE_OCC_LEGENDRE
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_OCC_LEGENDRE category record
      details about the Legendre polynomials used to describe the occupational
      modulations when the atomic domain of a given atom or rigid group
      is restricted  by a crenel function. See ATOM_SITE_DISPLACE_LEGENDRE
      for more detailed information.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_OCC_LEGENDRE
    _category_key.name            '_atom_site_occ_Legendre.id'

save_

save_atom_site_occ_legendre.atom_site_label

    _definition.id                '_atom_site_occ_Legendre.atom_site_label'
    _alias.definition_id          '_jana_atom_site_occ_Legendre_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom or rigid group in a loop in which
      the Legendre components of its occupational modulation are listed.
      This code must match the _atom_site.label of the associated coordinate
      list and conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_occ_Legendre
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_occ_legendre.coeff

    _definition.id                '_atom_site_occ_Legendre.coeff'
    _alias.definition_id          '_jana_atom_site_occ_Legendre_param_coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient corresponding to the Legendre polynomial describing
      the occupational modulation of a given atom or rigid group.
;
    _name.category_id             atom_site_occ_Legendre
    _name.object_id               coeff
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_occ_legendre.coeff_su

    _definition.id                '_atom_site_occ_Legendre.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_occ_Legendre.coeff
;
    _name.category_id             atom_site_occ_Legendre
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_occ_Legendre.coeff'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_occ_legendre.id

    _definition.id                '_atom_site_occ_Legendre.id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying each component of the occupational modulation of
      a given atom or rigid group when the modulation is expressed in
      terms of Legendre polynomials.
;
    _name.category_id             atom_site_occ_Legendre
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_occ_legendre.order

    _definition.id                '_atom_site_occ_Legendre.order'
    _alias.definition_id          '_jana_atom_site_occ_Legendre_param_order'
    _definition.update            2024-08-06
    _description.text
;
      The order of the Legendre polynomial.
;
    _name.category_id             atom_site_occ_Legendre
    _name.object_id               order
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_ATOM_SITE_OCC_ORTHO

    _definition.id                ATOM_SITE_OCC_ORTHO
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;

      Data items in the ATOM_SITE_OCC_ORTHO category record
      details about the orthogonalized functions (see
      ATOM_SITE_DISPLACE_ORTHO)defined to solve correlation problems
      during the refinement of the occupational modulation when the atomic
      domain of a given atom is restricted by a crenel function. The
      functions are constructed selecting Fourier harmonics until the
      desired degree of orthogonality and completeness is reached (see
      _atom_site_occ_special_func.crenel_ortho_eps).

      Notice that the global results could also be expressed (losing
      information about the orthogonalized functions) using the data items
      defined in the categories ATOM_SITE_OCC_FOURIER and
      ATOM_SITE_OCC_FOURIER_PARAM.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_OCC_ORTHO
    _category_key.name            '_atom_site_occ_ortho.id'

save_

save_atom_site_occ_ortho.atom_site_label

    _definition.id                '_atom_site_occ_ortho.atom_site_label'
    _alias.definition_id
        '_jana_atom_site_occ_crenel_ortho_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom or rigid group in a loop in which
      the ortho components of its occupational modulation are listed.
      This code must match the _atom_site.label of the associated coordinate
      list and conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_occ_ortho
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_occ_ortho.coeff

    _definition.id                '_atom_site_occ_ortho.coeff'
    _alias.definition_id          '_jana_atom_site_occ_crenel_ortho_param_coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient corresponding to the orthogonalized function
      defined by _atom_site_occ_ortho.atom_site_label and
      _atom_site_occ_ortho.func_id.
;
    _name.category_id             atom_site_occ_ortho
    _name.object_id               coeff
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_occ_ortho.coeff_su

    _definition.id                '_atom_site_occ_ortho.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_occ_ortho.coeff
;
    _name.category_id             atom_site_occ_ortho
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_occ_ortho.coeff'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_occ_ortho.func_id

    _definition.id                '_atom_site_occ_ortho.func_id'
    _alias.definition_id          '_jana_atom_site_occ_crenel_ortho_id'
    _definition.update            2024-04-09
    _description.text
;
      A code identifying the orthogonalized function used in the
      structural model to describe the occupational modulation of an atom
      or rigid group. This code must match _atom_sites_ortho_func_id.
;
    _name.category_id             atom_site_occ_ortho
    _name.object_id               func_id
    _name.linked_item_id          '_atom_sites_ortho.func_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_occ_ortho.id

    _definition.id                '_atom_site_occ_ortho.id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying each component of the occupational modulation of
      a given atom or rigid group when the modulation is expressed in
      terms of ortho series.
;
    _name.category_id             atom_site_occ_ortho
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_ATOM_SITE_OCC_SPECIAL_FUNC

    _definition.id                ATOM_SITE_OCC_SPECIAL_FUNC
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_OCC_SPECIAL_FUNC category
      record details about the occupational modulation of a given atom
      or rigid group in a modulated structure when it is not described
      by Fourier series. See ATOM_SITE_DISPLACE_SPECIAL_FUNC for more
      detailed information.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_OCC_SPECIAL_FUNC
    _category_key.name            '_atom_site_occ_special_func.atom_site_label'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension               1

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site.label
         _atom_site.type_symbol
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.adp_type
         _atom_site.U_iso_or_equiv
         _atom_site.symmetry_multiplicity
         _atom_site.occupancy
         _atom_site.calc_flag
         _atom_site.refinement_flags_posn
         _atom_site.disorder_assembly
         _atom_site.disorder_group
          Sr Sr 0        0        0        Uani 0.0097(3) 4 0.225  d . . .
          Bi Bi 0        0        0        Uani 0.0097(3) 8 0.075  d . . .
          Fe Fe 0        0        0        Uani 0.0097(3) 4 0.125  d . . .
          O1 O  0        0.451(3) 0        Uiso 0.024(3)  4 0.375  d . . .
          O2 O  0.238(4) 0.243(3) 0.266(4) Uiso 0.018(3)  8 0.1375 d . . .

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_occ_special_func.atom_site_label
         _atom_site_occ_special_func.crenel_c
         _atom_site_occ_special_func.crenel_w
         Sr  0.75        0.225
         Bi  0.9         0.075
         Fe  0           0.125
         O1  0.25        0.375
         O2 -0.0080(15)  0.1375

        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Luis Elcoro, Olivier P\'erez, J. M. Perez-Mato and V\'aclav
        Pet\<r\'i\<cek (2012) Acta Cryst. B68, 341-355.
        doi:10.1107/S0108768112018095
        Unified (3+1)-dimensional superspace description of the 2212-type
        stair-like [Bi~2~Sr~3~Fe~2~O~9~]~m~[Bi~4~Sr~6~Fe~2~O~16~] family of
        compounds
;

save_

save_atom_site_occ_special_func.atom_site_label

    _definition.id                '_atom_site_occ_special_func.atom_site_label'
    _alias.definition_id          '_atom_site_occ_special_func_atom_site_label'
    _definition.update            2014-06-27
    _description.text
;
      The code that identifies an atom or rigid group in a loop in
      which the parameters of the special function that describes its
      occupational modulation are listed. This code must match
      the _atom_site.label of the associated coordinate list and
      conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_occ_special_func
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_occ_special_func.crenel

    _definition.id                '_atom_site_occ_special_func.crenel'
    _definition.update            2024-08-08
    _description.text
;
       _atom_site_occ_special_func.crenel_ items are the adjustable
       parameters of a crenel function.

       An occupational crenel function along the internal space is
       defined as follows:
                p(x4)=1   if x4 belongs to the interval [c-w/2,c+w/2]
                p(x4)=0   if x4 is outside the interval [c-w/2,c+w/2],
       where x4 is the internal coordinate, c is the centre of the
       function in internal space and w is its width.
;
    _name.category_id             atom_site_occ_special_func
    _name.object_id               crenel
    _type.purpose                 Describe
    _type.source                  Recorded
    _type.container               Single
    _type.contents                Text

save_

save_atom_site_occ_special_func.crenel_c

    _definition.id                '_atom_site_occ_special_func.crenel_c'

    loop_
      _alias.definition_id
         '_atom_site_occ_special_func_crenel_c'
         '_jana_atom_site_crenel_ortho_func_c'

    _definition.update            2024-08-01
    _description.text
;
    The centre of the crenel function described in
    _atom_site_displace_special_func.crenel
;
    _name.category_id             atom_site_occ_special_func
    _name.object_id               crenel_c
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_occ_special_func.crenel_c_su

    _definition.id                '_atom_site_occ_special_func.crenel_c_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_occ_special_func.crenel_c
;
    _name.category_id             atom_site_occ_special_func
    _name.object_id               crenel_c_su
    _name.linked_item_id          '_atom_site_occ_special_func.crenel_c'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_occ_special_func.crenel_ortho_eps

    _definition.id                '_atom_site_occ_special_func.crenel_ortho_eps'
    _alias.definition_id          '_jana_atom_site_crenel_ortho_func_eps'
    _definition.update            2024-07-31
    _description.text
;
      The set of harmonic functions used in the Fourier series
      describing the Modulation functions is orthogonal and complete
      in the interval [0,1).  However within of the x4 interval
      defined by a Crenel function orthogonality is no longer
      preserved and therefore the Fourier coefficients are correlated
      and the refinement becomes fragile. There are several ways to
      avoid this technical problem (see Petricek et al., 2016). One of
      them is to define functions based on Fourier harmonics that are
      orthogonal within the Crenel interval. The procedure implemented
      in JANA requires, for each Crenel function, a parameter for the
      selection of the harmonic functions that define the not
      necessarily complete set of (almost) orthogonalized functions.
      _atom_site_occ_special_func.crenel_ortho_eps contains such
      values. Empirical tests indicate that a default value of 0.95
      warrants reasonable results.  The orthogonalized functions and
      the corresponding refined amplitudes are defined in the
      categories: ATOM_SITES_ORTHO., ATOM_SITE_DISPLACE_ORTHO.,
      ATOM_SITE_OCC_ORTHO., ATOM_SITE_ROT_ORTHO. and
      ATOM_SITE_U_ORTHO.
;
    _name.category_id             atom_site_occ_special_func
    _name.object_id               crenel_ortho_eps
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.default          0.95

save_

save_atom_site_occ_special_func.crenel_w

    _definition.id                '_atom_site_occ_special_func.crenel_w'

    loop_
      _alias.definition_id
         '_atom_site_occ_special_func_crenel_w'
         '_jana_atom_site_crenel_ortho_func_w'

    _definition.update            2024-08-01
    _description.text
;
    The width of the crenel function described in
    _atom_site_displace_special_func.crenel
;
    _name.category_id             atom_site_occ_special_func
    _name.object_id               crenel_w
    _enumeration.range            0.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_occ_special_func.crenel_w_su

    _definition.id                '_atom_site_occ_special_func.crenel_w_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_occ_special_func.crenel_w
;
    _name.category_id             atom_site_occ_special_func
    _name.object_id               crenel_w_su
    _name.linked_item_id          '_atom_site_occ_special_func.crenel_w'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_ATOM_SITE_OCC_XHARM

    _definition.id                ATOM_SITE_OCC_XHARM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_OCC_XHARM category record details about
      the x-harmonics used to describe the occupational modulations when
      the atomic domain of a given atom or rigid group is restricted by
      a crenel function.  See ATOM_SITE_DISPLACE_XHARM for more detailed
      information.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_OCC_XHARM
    _category_key.name            '_atom_site_occ_xharm.id'

save_

save_atom_site_occ_xharm.atom_site_label

    _definition.id                '_atom_site_occ_xharm.atom_site_label'
    _alias.definition_id          '_jana_atom_site_occ_XHarm_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom or rigid group in a loop in which
      the x-harmonic components of its occupational modulation are listed.
      This code must match the _atom_site.label of the associated coordinate
      list and conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_occ_xharm
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_occ_xharm.coeff

    _definition.id                '_atom_site_occ_xharm.coeff'
    _alias.definition_id          '_jana_atom_site_occ_XHarm_param_coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient corresponding to the x-harmonic function describing the
      Occupational modulation of a given atom or rigid group.
;
    _name.category_id             atom_site_occ_xharm
    _name.object_id               coeff
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_occ_xharm.coeff_su

    _definition.id                '_atom_site_occ_xharm.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_occ_xharm.coeff
;
    _name.category_id             atom_site_occ_xharm
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_occ_xharm.coeff'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_occ_xharm.id

    _definition.id                '_atom_site_occ_xharm.id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying each component of the occupational modulation of
      a given atom or rigid group when the modulation is expressed in
      terms of x-harmonics.
;
    _name.category_id             atom_site_occ_xharm
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_occ_xharm.order

    _definition.id                '_atom_site_occ_xharm.order'
    _alias.definition_id          '_jana_atom_site_occ_XHarm_param_order'
    _definition.update            2024-08-06
    _description.text
;
      The order of each x-harmonics function.
;
    _name.category_id             atom_site_occ_xharm
    _name.object_id               order
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_ATOM_SITE_PHASON

    _definition.id                ATOM_SITE_PHASON
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_PHASON category record details
      about the atomic phason correction. Although this kind of
      correction is intended to be overall, some refinement programs
      (for example, JANA) allow for this (theoretically dubious)
      atom-dependent phason treatment.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_PHASON
    _category_key.name            '_atom_site_phason.atom_site_label'

save_

save_atom_site_phason.atom_site_label

    _definition.id                '_atom_site_phason.atom_site_label'
    _alias.definition_id          '_atom_site_phason_atom_site_label'
    _definition.update            2014-06-27
    _description.text
;
      The code that identifies an atom or rigid group in a loop in
      which the phason coefficients are listed. Although this kind of
      correction is intended to be overall, some refinement programs
      (for example, JANA) allow an independent phason correction
      for each atom or rigid group. In this case,
      _atom_site_phason.formula and _atom_site_phason.coeff should be
      used (see also _refine.ls_mod_overall_phason_). This code must
      match the _atom_site.label of the associated coordinate list and
      conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_phason
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_phason.coeff

    _definition.id                '_atom_site_phason.coeff'
    _alias.definition_id          '_atom_site_phason_coeff'
    _definition.update            2024-08-01
    _description.text
;
      The phason coefficient used to calculate (with the appropriate
      expression given in _atom_site_phason.formula) the atomic phason
      correction. Although this kind of correction is intended to be
      overall, some refinement programs (for example, JANA) allow
      an independent phason correction for each atom or rigid group. In
      this case, _atom_site_phason.formula and _atom_site_phason.coeff
      should be used (see also _refine.ls_mod_overall_phason_).
;
    _name.category_id             atom_site_phason
    _name.object_id               coeff
    _enumeration.range            0.0:
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_phason.formula

    _definition.id                '_atom_site_phason.formula'
    _alias.definition_id          '_atom_site_phason_formula'
    _definition.update            2024-08-01
    _description.text
;
      The formula used for the phason correction. Although both kinds
      of corrections are intended to be overall, some refinement
      programs (for example, JANA) allow an independent phason
      correction for each atom or rigid group. In this case,
      _atom_site_phason.formula and _atom_site_phason.coeff should
      be used (see also _refine.ls_mod_overall_phason_).
;
    _name.category_id             atom_site_phason
    _name.object_id               formula
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         Axe            'Axe, J. D. (1980). Phys. Rev. B, 21, 4181-4190.'
         Ovr            'Overhauser, A. W. (1971). Phys. Rev. B, 3, 3173-3182.'

save_

save_ATOM_SITE_ROT_FOURIER

    _definition.id                ATOM_SITE_ROT_FOURIER
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_ROT_FOURIER category record details
      about the Fourier components present in the rotational part of
      the displacive modulation of a given rigid group. The
      translational part would appear in a separate list of items
      belonging to the ATOM_SITE_DISPLACE_FOURIER category. The (in
      general complex) coefficients of each Fourier component belong
      to the child category ATOM_SITE_ROT_FOURIER_PARAM and may be listed
      separately.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_ROT_FOURIER
    _category_key.name            '_atom_site_rot_Fourier.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _space_group.crystal_system             monoclinic
        _space_group.ssg_name_WJJ               'P:I2/a:s -1'

        loop_
         _space_group_symop.ssg_id
         _space_group_symop.ssg_operation_algebraic
         1   x1,x2,x3,x4
         2   -x1+1/2,x2,-x3,x4+1/2
         3   -x1,-x2,-x3,-x4
         4   x1+1/2,-x2,x3,-x4+1/2
         5   x1+1/2,x2+1/2,x3+1/2,x4
         6   -x1,x2+1/2,-x3+1/2,x4+1/2
         7   -x1+1/2,-x2+1/2,-x3+1/2,-x4
         8   x1,-x2+1/2,x3+1/2,-x4+1/2

        _cell.length_a                           20.20(2)
        _cell.length_b                           4.910(2)
        _cell.length_c                           12.054(9)
        _cell.angle_alpha                        90
        _cell.angle_beta                         90.02(4)
        _cell.angle_gamma                        90
        _cell.volume                             1195(2)

        _cell.modulation_dimension               1

        loop_
         _cell_wave_vector.seq_id
         _cell_wave_vector.xyz
          1  [0,0.780(3),0]

        # - - - - data truncated for brevity - - - -

        loop_
         _restr_rigid_body.id
         _restr_rigid_body.atom_site_label
         _restr_rigid_body.site_symmetry
         _restr_rigid_body.class_id
         _restr_rigid_body.details
          1 S    1_555  DCBPS  ?
          2 Cl   1_555  DCBPS  ?
          3 O    1_555  DCBPS  ?
          4 C(1) 1_555  DCBPS  ?
          5 C(2) 1_555  DCBPS  ?
          6 C(3) 1_555  DCBPS  ?
          7 C(4) 1_555  DCBPS  ?
          8 C(5) 1_555  DCBPS  ?
          9 C(6) 1_555  DCBPS  ?
         10 S    1_555  DCBPS  ?
         11 Cl   2_555  DCBPS  ?
         12 O    2_555  DCBPS  ?
         13 C(1) 2_555  DCBPS  ?
         14 C(2) 2_555  DCBPS  ?
         15 C(3) 2_555  DCBPS  ?
         16 C(4) 2_555  DCBPS  ?
         17 C(5) 2_555  DCBPS  ?
         18 C(6) 2_555  DCBPS  ?

        loop_
          _restr_rigid_body_class.class_id
          _restr_rigid_body_class.details
          DCBPS   "4.4'-Dichlorobiphenyl Sulfone, without H atoms"

        loop_
         _atom_site.label
         _atom_site.type_symbol
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.U_iso_or_equiv
          S     S   0.2500      0.1380(1)  0.0000     0.015(1)
          Cl    Cl  0.03032(2)  0.9377(1)  0.15944(3) 0.028(1)
          O     C   0.22528(4) -0.0080(2) -0.0951(1)  0.020(1)
          C(1)  C   0.18652(4)  0.3583(2)  0.0448(1)  0.015(1)
          C(2)  C   0.1345(1)   0.4210(2) -0.0269(1)  0.019(1)
          C(3)  C   0.0861(1)   0.6010(3)  0.0079(1)  0.021(1)
          C(4)  C   0.0902(1)   0.7107(2)  0.1143(1)  0.020(1)
          C(5)  C   0.1414(1)   0.6460(2)  0.1861(1)  0.020(1)
          C(6)  C   0.1901(1)   0.4686(2)  0.1509(1)  0.018(1)
          H(2)  H   0.1330(8)   0.338(4)  -0.099(1)   0.011(1)
          H(3)  H   0.0484(8)   0.651(3)  -0.036(1)   0.011(1)
          H(5)  H   0.1419(8)   0.711(4)   0.257(1)   0.011(1)
          H(6)  H   0.2273(8)   0.421(3)   0.201(1)   0.011(1)
          DCBPS .   0.25        0.529      0.0000     .

        loop_
         _atom_site_Fourier_wave_vector.seq_id
         _atom_site_Fourier_wave_vector.q_coeff_seq_id
         _atom_site_Fourier_wave_vector.q_coeff
            1  [1]  [1]
            2  [1]  [2]

        loop_
        _atom_sites_axes.matrix_seq_id
        _atom_sites_axes.matrix
        _atom_sites_axes.transf_description
        1 [[-0.2197,0.1148,0.2739],[0.7997,0.0,0.0],[0.1594,0.4592,-0.1924]]
        ;
        a1 is along the line S--C(1)--C(4)--Cl.
        a2 is perpendicular to the C(1)--S--C(1)[-x+1/2, y, -z] plane.
        a3 is perpendicular to a2 and the b axis.

        Length and angles are: 6.23, 6.00, 6.00, 90.03, 140.92, 89.46
        (A and deg.)  Rotations and translations correspond to the
        first harmonic (frozen mode with symmetry \L~2~)
        ;
        2 [[1,0,0],[0,1,0],[0,0,1]]
        ;
        a1, a2 and a3 coincide with a, b and c.  Rotations and
        translations along and around a2=y, correspond to the second
        harmonic (frozen mode with symmetry \L~1~)
        ;

        loop_
         _atom_site_displace_Fourier.id
         _atom_site_displace_Fourier.atom_site_label
         _atom_site_displace_Fourier.axis
         _atom_site_displace_Fourier.matrix_seq_id
         _atom_site_displace_Fourier.wave_vector_seq_id
         _atom_site_displace_Fourier_param.modulus
         _atom_site_displace_Fourier_param.phase
          S_x_1     S      x  .  1 -0.00453(2)  0.388(1)
          S_y_1     S      y  .  1  0.0000      0.000
          S_z_1     S      z  .  1  0.02053(4)  0.3190(3)
          S_x_2     S      x  .  2  0.0000      0.0000
          S_y_2     S      y  .  2  0.0015(3)   0.23(3)
          S_z_2     S      z  .  2  0.0000      0.0000

        # - - - - data truncated for brevity - - - -

          T_x_1     DCBPS  x  .  1  0.0045      0.30
          T_y_1     DCBPS  y  .  1  0.0041      0.44
          T_y_2     DCBPS  y  .  2  0.0020      0.62
          T_z_1     DCBPS  z  .  1  0.0232      0.05
          T_a2_1    DCBPS  a2 1  1  0.0433      0.07
          T_a3_1    DCBPS  a3 1  1  0.0233      0.95
          T_y_2_nm  DCBPS  a2 2  2  0.0020      0.62

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_rot_Fourier.id
         _atom_site_rot_Fourier.atom_site_label
         _atom_site_rot_Fourier.axis
         _atom_site_rot_Fourier.matrix_seq_id
         _atom_site_rot_Fourier.wave_vector_seq_id
         _atom_site_rot_Fourier_param.modulus
         _atom_site_rot_Fourier_param.phase
          R_x_1      DCBPS  x   .  1  1.60  0.19
          R_y_1      DCBPS  y   .  1  2.20  0.48
          R_z_1      DCBPS  z   .  1  4.30  0.68
          R_x_2      DCBPS  x   .  2  0.40  0.40
          R_y_2      DCBPS  y   .  2  0.60  0.99
          R_z_2      DCBPS  z   .  2  0.80  0.65
          R_a1_1     DCBPS  a1  1  1  3.50  0.48
          R_a2_1     DCBPS  a2  1  1  3.30  0.68
          R_a3_1     DCBPS  a3  1  1  3.50  0.32
          R_a1_2     DCBPS  a1  1  2  0.60  0.78
          R_a2_2     DCBPS  a2  1  2  0.70  0.62
          R_y_2_nm   DCBPS  a2  2  2  0.70  0.10

        #Rigid rotations and translations of the molecule (DCBPS) are
        #expressed in two different ways: as movements around and
        #along the crystallographic axes (R_x_1...R_z_2 and
        #T_x_1...T_z_1) or through nine normal modes
        #(R_a1_1...R_y_2_nm) and T_a2_1...T_y_2_nm). The rotation
        #R_y_2_nm and the translation T_y_2_nm are around and along
        #the b-axis but are independent, in the sense that they do not
        #belong to the same Fourier series, of T_y_1, T_y_2 and
        #R_y_1. Therefore they need a different (but trivial)
        #transformation matrix.

        #=======================================================================

        Example based on the article:
        F.J. Z\'u\~niga, J.M. P\'erez-Mato and T. Breczewski(1993)
        Acta Cryst. B49, 1060-1068. doi:10.1107/S0108768193008195
        Structure of the Incommensurate Phase of 4,4'-Dichlorobiphenyl Sulfone
        at 90 K
;

save_

save_atom_site_rot_fourier.atom_site_label

    _definition.id                '_atom_site_rot_Fourier.atom_site_label'
    _alias.definition_id          '_atom_site_rot_Fourier_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies a rigid group in a loop in which the Fourier
      components of the rotational part of its displacive modulation
      are listed. The translational part (if any) would appear in a
      separate list (see _atom_site_displace_Fourier.atom_site_label).
      This code must match the _atom_site.label of the associated
      coordinate list and conform to the rules described in
      _atom_site.label.
;
    _name.category_id             atom_site_rot_Fourier
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_fourier.axis

    _definition.id                '_atom_site_rot_Fourier.axis'
    _alias.definition_id          '_atom_site_rot_Fourier_axis'
    _definition.update            2024-07-27
    _description.text
;
      A label identifying the rotation component around a fixed point
      of a given rigid group whose modulation is being parameterized by
      Fourier series. a, b and c are the basic lattice vectors of the
      reference structure. For composites they refer to the reference
      structure of each subsystem. a~1~, a~2~ and a~3~ are defined by
      the items belonging to the ATOM_SITES_AXES category, through
      _atom_site_rot_Fourier.matrix_seq_id. Use of
      _atom_sites_rot_Fourier.axes_description is DEPRECATED and
      retained only for backward compatibility.
;
    _name.category_id             atom_site_rot_Fourier
    _name.object_id               axis
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         x
;
         rotation around the a axis
;
         y
;
         rotation around the b axis
;
         z
;
         rotation around the c axis
;
         a1
;
         rotation around the first axis after applying _atom_sites_axes.matrix
;
         a2
;
         rotation around the second axis after applying _atom_sites_axes.matrix
;
         a3
;
         rotation around the third axis after applying _atom_sites_axes.matrix
;

save_

save_atom_site_rot_fourier.id

    _definition.id                '_atom_site_rot_Fourier.id'
    _alias.definition_id          '_atom_site_rot_Fourier_id'
    _definition.update            2023-08-07
    _description.text
;
      A code identifying each component of the rotational modulation of
      a given rigid group when the modulation is expressed in
      terms of Fourier series.
;
    _name.category_id             atom_site_rot_Fourier
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_fourier.matrix_seq_id

    _definition.id                '_atom_site_rot_Fourier.matrix_seq_id'
    _definition.update            2024-08-01
    _name.category_id             atom_site_rot_Fourier
    _name.object_id               matrix_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':transf_matrix_id}]

save_

save_atom_site_rot_fourier.wave_vector_seq_id

    _definition.id                '_atom_site_rot_Fourier.wave_vector_seq_id'
    _alias.definition_id          '_atom_site_rot_Fourier_wave_vector_seq_id'
    _definition.update            2024-04-28
    _description.text
;
      A numeric code identifying the wave vectors of the Fourier terms
      used in the structural model to describe the modulation functions
      corresponding to the rotational distortion of a rigid group. This
      code must match _atom_site_Fourier_wave_vector.seq_id.
;
    _name.category_id             atom_site_rot_Fourier
    _name.object_id               wave_vector_seq_id
    _name.linked_item_id          '_atom_site_Fourier_wave_vector.seq_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Integer

save_

save_ATOM_SITE_ROT_FOURIER_PARAM

    _definition.id                ATOM_SITE_ROT_FOURIER_PARAM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-08
    _description.text
;
      Data items in the ATOM_SITE_ROT_FOURIER_PARAM category record
      details about the coefficients of the Fourier series used to
      describe the rotational component of the displacive modulation of
      a given rigid group. The translational part would appear in a
      separate list of items belonging to the
      ATOM_SITE_DISPLACE_FOURIER_PARAM category. The Fourier components
      are defined in the parent category ATOM_SITE_ROT_FOURIER. Notice
      that items in this category may be listed together with those of the
      ATOM_SITE_DISPLACE_FOURIER category. To simplify the description,
      below is explained the one-dimensional case.

      The displacive distortion of a given rigid group is not completely
      described by _atom_site_displace_Fourier.*. The rigid rotation of
      the group around a given axis passing through a fixed point (for
      example, the centre of mass of the group) is usually parameterized
      by Fourier series. Each term of the series commonly adopts two
      different representations: the sine-cosine form,
               Rcn cos(2\\p n x4)+Rsn sin(2\\p n x4),
      and the modulus-argument form,
               |Rn| cos(2\\p n x4+\\yn),
      where x4=q*(r+T)+t. q is the modulation wave vector and r and T
      stand for a phase reference position and a lattice translation of
      the reference structure, respectively. The phase reference position
      in the case of rigid groups, is a common point (as the mentioned
      centre of mass) for all atoms in the group. t is an arbitrary phase,
      irrelevant for incommensurate modulated structures, but essential
      in the commensurate case (see _atom_sites_modulation_global_phase_t_).

      Rigid-group rotations should be expressed in degrees around either
      the unit cell axes or of the axes defined  by the items belonging
      to the ATOM_SITES_AXES category, through
      _atom_site_rot_Fourier.matrix_seq_id.

      Use of _atom_sites_rot_Fourier.axes_description is DEPRECATED and
      retained only by for backward compatibility.
;
    _name.category_id             ATOM_SITE_ROT_FOURIER
    _name.object_id               ATOM_SITE_ROT_FOURIER_PARAM
    _category_key.name            '_atom_site_rot_Fourier_param.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _space_group.crystal_system             monoclinic
        _space_group.ssg_name_WJJ               'P:I2/a:s -1'

        loop_
         _space_group_symop.ssg_id
         _space_group_symop.ssg_operation_algebraic
         1   x1,x2,x3,x4
         2   -x1+1/2,x2,-x3,x4+1/2
         3   -x1,-x2,-x3,-x4
         4   x1+1/2,-x2,x3,-x4+1/2
         5   x1+1/2,x2+1/2,x3+1/2,x4
         6   -x1,x2+1/2,-x3+1/2,x4+1/2
         7   -x1+1/2,-x2+1/2,-x3+1/2,-x4
         8   x1,-x2+1/2,x3+1/2,-x4+1/2

        _cell.length_a                           20.20(2)
        _cell.length_b                           4.910(2)
        _cell.length_c                           12.054(9)
        _cell.angle_alpha                        90
        _cell.angle_beta                         90.02(4)
        _cell.angle_gamma                        90
        _cell.volume                             1195(2)

        _cell.modulation_dimension               1

        loop_
         _cell_wave_vector.seq_id
         _cell_wave_vector.xyz
          1  [0,0.780(3),0]

        # - - - - data truncated for brevity - - - -

        loop_
         _restr_rigid_body.id
         _restr_rigid_body.atom_site_label
         _restr_rigid_body.site_symmetry
         _restr_rigid_body.class_id
         _restr_rigid_body.details
          1 S    1_555  DCBPS  ?
          2 Cl   1_555  DCBPS  ?
          3 O    1_555  DCBPS  ?
          4 C(1) 1_555  DCBPS  ?
          5 C(2) 1_555  DCBPS  ?
          6 C(3) 1_555  DCBPS  ?
          7 C(4) 1_555  DCBPS  ?
          8 C(5) 1_555  DCBPS  ?
          9 C(6) 1_555  DCBPS  ?
         10 S    1_555  DCBPS  ?
         11 Cl   2_555  DCBPS  ?
         12 O    2_555  DCBPS  ?
         13 C(1) 2_555  DCBPS  ?
         14 C(2) 2_555  DCBPS  ?
         15 C(3) 2_555  DCBPS  ?
         16 C(4) 2_555  DCBPS  ?
         17 C(5) 2_555  DCBPS  ?
         18 C(6) 2_555  DCBPS  ?

        loop_
          _restr_rigid_body_class.class_id
          _restr_rigid_body_class.details
          DCBPS   "4.4'-Dichlorobiphenyl Sulfone, without H atoms"

        loop_
         _atom_site.label
         _atom_site.type_symbol
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.U_iso_or_equiv
          S     S   0.2500      0.1380(1)  0.0000     0.015(1)
          Cl    Cl  0.03032(2)  0.9377(1)  0.15944(3) 0.028(1)
          O     C   0.22528(4) -0.0080(2) -0.0951(1)  0.020(1)
          C(1)  C   0.18652(4)  0.3583(2)  0.0448(1)  0.015(1)
          C(2)  C   0.1345(1)   0.4210(2) -0.0269(1)  0.019(1)
          C(3)  C   0.0861(1)   0.6010(3)  0.0079(1)  0.021(1)
          C(4)  C   0.0902(1)   0.7107(2)  0.1143(1)  0.020(1)
          C(5)  C   0.1414(1)   0.6460(2)  0.1861(1)  0.020(1)
          C(6)  C   0.1901(1)   0.4686(2)  0.1509(1)  0.018(1)
          H(2)  H   0.1330(8)   0.338(4)  -0.099(1)   0.011(1)
          H(3)  H   0.0484(8)   0.651(3)  -0.036(1)   0.011(1)
          H(5)  H   0.1419(8)   0.711(4)   0.257(1)   0.011(1)
          H(6)  H   0.2273(8)   0.421(3)   0.201(1)   0.011(1)
          DCBPS .   0.25        0.529      0.0000     .

        loop_
         _atom_site_Fourier_wave_vector.seq_id
         _atom_site_Fourier_wave_vector.q_coeff_seq_id
         _atom_site_Fourier_wave_vector.q_coeff
            1  [1]  [1]
            2  [1]  [2]

        loop_
        _atom_sites_axes.matrix_seq_id
        _atom_sites_axes.matrix
        _atom_sites_axes.transf_description
        1 [[-0.2197,0.1148,0.2739],[0.7997,0.0,0.0],[0.1594,0.4592,-0.1924]]
        ;
        a1 is along the line S--C(1)--C(4)--Cl.
        a2 is perpendicular to the C(1)--S--C(1)[-x+1/2, y, -z] plane.
        a3 is perpendicular to a2 and the b axis.

        Length and angles are: 6.23, 6.00, 6.00, 90.03, 140.92, 89.46 (A and
        deg.)
        Rotations and translations correspond to the first harmonic (frozen mode
        with symmetry \L~2~)
        ;
        2 [[1,0,0],[0,1,0],[0,0,1]]
        ;
        a1, a2 and a3 coincide with a, b and c.
        Rotations and translations along and around a2=y, correspond to the
        second harmonic (frozen mode with symmetry \L~1~)
        ;

        loop_
         _atom_site_displace_Fourier.id
         _atom_site_displace_Fourier.atom_site_label
         _atom_site_displace_Fourier.axis
         _atom_site_displace_Fourier.matrix_seq_id
         _atom_site_displace_Fourier.wave_vector_seq_id
          S_x_1     S      x  .  1
          S_y_1     S      y  .  1
          S_z_1     S      z  .  1
          S_x_2     S      x  .  2
          S_y_2     S      y  .  2
          S_z_2     S      z  .  2

        # - - - - data truncated for brevity - - - -

          T_x_1     DCBPS  x  .  1
          T_y_1     DCBPS  y  .  1
          T_y_2     DCBPS  y  .  2
          T_z_1     DCBPS  z  .  1
          T_a2_1    DCBPS  a2 1  1
          T_a3_1    DCBPS  a3 1  1
          T_y_2_nm  DCBPS  a2 2  2

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_displace_Fourier_param.id
         _atom_site_displace_Fourier_param.modulus
         _atom_site_displace_Fourier_param.phase
          S_x_1    -0.00453(2)  0.388(1)
          S_y_1     0.0000      0.000
          S_z_1     0.02053(4)  0.3190(3)
          S_x_2     0.0000      0.0000
          S_y_2     0.0015(3)   0.23(3)
          S_z_2     0.0000      0.0000

        # - - - - data truncated for brevity - - - -

          T_x_1     0.0045      0.30
          T_y_1     0.0041      0.44
          T_y_2     0.0020      0.62
          T_z_1     0.0232      0.05
          T_a2_1    0.0433      0.07
          T_a3_1    0.0233      0.95
          T_y_2_nm  0.0020      0.62

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_rot_Fourier.id
         _atom_site_rot_Fourier.atom_site_label
         _atom_site_rot_Fourier.axis
         _atom_site_rot_Fourier.matrix_seq_id
         _atom_site_rot_Fourier.wave_vector_seq_id
          R_x_1     DCBPS  x   .  1
          R_y_1     DCBPS  y   .  1
          R_z_1     DCBPS  z   .  1
          R_x_2     DCBPS  x   .  2
          R_y_2     DCBPS  y   .  2
          R_z_2     DCBPS  z   .  2
          R_a1_1    DCBPS  a1  1  1
          R_a2_1    DCBPS  a2  1  1
          R_a3_1    DCBPS  a3  1  1
          R_a1_2    DCBPS  a1  1  2
          R_a2_2    DCBPS  a2  1  2
          R_y_2_nm  DCBPS  a2  2  2

        loop_
         _atom_site_rot_Fourier_param.id
         _atom_site_rot_Fourier_param.modulus
         _atom_site_rot_Fourier_param.phase
          R_x_1     1.60  0.19
          R_y_1     2.20  0.48
          R_z_1     4.30  0.68
          R_x_2     0.40  0.40
          R_y_2     0.60  0.99
          R_z_2     0.80  0.65
          R_a1_1    3.50  0.48
          R_a2_1    3.30  0.68
          R_a3_1    3.50  0.32
          R_a1_2    0.60  0.78
          R_a2_2    0.70  0.62
          R_y_2_nm  0.70  0.10

        #Rigid rotations and translations of the molecule (DCBPS) are
        #expressed in two different ways: as movements around and
        #along the crystallographic axes (R_x_1...R_z_2 and
        #T_x_1...T_z_1) or through nine normal modes
        #(R_a1_1...R_y_2_nm) and T_a2_1...T_y_2_nm). The rotation
        #R_y_2_nm and the translation T_y_2_nm are around and along
        #the b-axis but are independent, in the sense that they do not
        #belong to the same Fourier series, of T_y_1, T_y_2 and
        #R_y_1. Therefore they need a different (but trivial)
        #transformation matrix.

        #=======================================================================

        Example based on the article:
        F.J. Z\'u\~niga, J.M. P\'erez-Mato and T. Breczewski(1993)
        Acta Cryst. B49, 1060-1068. doi:10.1107/S0108768193008195
        Structure of the Incommensurate Phase of 4,4'-Dichlorobiphenyl Sulfone
        at 90 K
;

save_

save_atom_site_rot_fourier_param.cos

    _definition.id                '_atom_site_rot_Fourier_param.cos'
    _alias.definition_id          '_atom_site_rot_Fourier_param_cos'
    _definition.update            2024-08-01
    _description.text
;
      The cosine coefficient (Rcn) corresponding to the Fourier term
      defined by _atom_site_rot_Fourier.atom_site_label,
      _atom_site_rot_Fourier.axis and
      _atom_site_rot_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_rot_Fourier_param
    _name.object_id               cos
    _units.code                   degrees

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_rot_Fourier_param

       _atom_site_rot_Fourier_param.cos =  p.modulus*Cos(TwoPi*p.phase)
;

save_

save_atom_site_rot_fourier_param.cos_su

    _definition.id                '_atom_site_rot_Fourier_param.cos_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_Fourier_param.cos
;
    _name.category_id             atom_site_rot_Fourier_param
    _name.object_id               cos_su
    _name.linked_item_id          '_atom_site_rot_Fourier_param.cos'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_fourier_param.id

    _definition.id                '_atom_site_rot_Fourier_param.id'
    _alias.definition_id          '_atom_site_rot_Fourier_param_id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying the (in general complex) coefficient of each
      term present in the Fourier series describing the rotational part
      of the displacive modulation of a given rigid group. This code
      must match _atom_site_rot_Fourier.id.
;
    _name.category_id             atom_site_rot_Fourier_param
    _name.object_id               id
    _name.linked_item_id          '_atom_site_rot_Fourier.id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_fourier_param.modulus

    _definition.id                '_atom_site_rot_Fourier_param.modulus'
    _alias.definition_id          '_atom_site_rot_Fourier_param_modulus'
    _definition.update            2024-08-01
    _description.text
;
      The modulus (|Rn|) of the complex amplitude corresponding to the
      Fourier term defined by _atom_site_rot_Fourier.atom_site_label,
      _atom_site_rot_Fourier.axis and
      _atom_site_rot_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_rot_Fourier_param
    _name.object_id               modulus
    _enumeration.range            0.0:
    _units.code                   degrees

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_rot_Fourier_param

       _atom_site_rot_Fourier_param.modulus =  Sqrt(p.cos**2+p.sin**2)
;

save_

save_atom_site_rot_fourier_param.modulus_su

    _definition.id                '_atom_site_rot_Fourier_param.modulus_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_Fourier_param.modulus
;
    _name.category_id             atom_site_rot_Fourier_param
    _name.object_id               modulus_su
    _name.linked_item_id          '_atom_site_rot_Fourier_param.modulus'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_fourier_param.phase

    _definition.id                '_atom_site_rot_Fourier_param.phase'
    _alias.definition_id          '_atom_site_rot_Fourier_param_phase'
    _definition.update            2024-08-01
    _description.text
;
      The phase (\yn/2\\p), in cycles, of the complex amplitude corresponding
      to the Fourier term defined by _atom_site_rot_Fourier.atom_site_label,
      _atom_site_rot_Fourier.axis and
      _atom_site_rot_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_rot_Fourier_param
    _name.object_id               phase
    _enumeration.range            -1.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_rot_Fourier_param

       _atom_site_rot_Fourier_param.phase =  Phase(Complex(p.cos,-p.sin))/TwoPi
;

save_

save_atom_site_rot_fourier_param.phase_su

    _definition.id                '_atom_site_rot_Fourier_param.phase_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_Fourier_param.phase
;
    _name.category_id             atom_site_rot_Fourier_param
    _name.object_id               phase_su
    _name.linked_item_id          '_atom_site_rot_Fourier_param.phase'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_fourier_param.sin

    _definition.id                '_atom_site_rot_Fourier_param.sin'
    _alias.definition_id          '_atom_site_rot_Fourier_param_sin'
    _definition.update            2024-08-01
    _description.text
;
      The sine coefficient (Rsn) corresponding to the Fourier term defined
      by _atom_site_rot_Fourier.atom_site_label,
      _atom_site_rot_Fourier.axis and
      _atom_site_rot_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_rot_Fourier_param
    _name.object_id               sin
    _units.code                   degrees

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_rot_Fourier_param

       _atom_site_rot_Fourier_param.sin =  -p.modulus*Sin(TwoPi*p.phase)
;

save_

save_atom_site_rot_fourier_param.sine_su

    _definition.id                '_atom_site_rot_Fourier_param.sine_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_Fourier_param.sin
;
    _name.category_id             atom_site_rot_Fourier_param
    _name.object_id               sin_su
    _name.linked_item_id          '_atom_site_rot_Fourier_param.sin'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_ATOM_SITE_ROT_LEGENDRE

    _definition.id                ATOM_SITE_ROT_LEGENDRE
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_ROT_LEGENDRE category record
      details about the Legendre polynomials used to describe the displacive
      modulations when the atomic domain of a given atom is restricted
      by a crenel function. In the case of rigid groups, items in this
      category would only include the rotational part of the modulation.
      The translational part would appear in a separate list of items
      belonging to the ATOM_SITE_DISPLACE_LEGENDRE category.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_ROT_LEGENDRE
    _category_key.name            '_atom_site_rot_Legendre.id'

save_

save_atom_site_rot_legendre.atom_site_label

    _definition.id                '_atom_site_rot_Legendre.atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom or rigid group in a loop in which
      the Legendre components of its displacive modulation are listed.
      In the case of a rigid group, this list would only include the
      rotational part of its displacive modulation. The translational
      part (if any) would appear in a separate list (see
      _atom_site_displace_Legendre.atom_site_label). This code must match
      the _atom_site.label of the associated coordinate list and
      conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_rot_Legendre
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_legendre.axis

    _definition.id                '_atom_site_rot_Legendre.axis'
    _definition.update            2024-07-27
    _description.text
;
      A label identifying the rotational part of the displacive modulation of
      a given rigid group that is being parameterized by Legendre
      polynomials. a, b and c are the basic lattice vectors of the reference
      structure. For composites they refer to the reference structure of
      each subsystem. a~1~, a~2~ and a~3~ are defined by the
      items belonging to the ATOM_SITES_AXES category, through
      _atom_site_rot_Legendre.matrix_seq_id.
;
    _name.category_id             atom_site_rot_Legendre
    _name.object_id               axis
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         x
;
         rotation around the a axis
;
         y
;
         rotation around the b axis
;
         z
;
         rotation around the c axis
;
         a1
;
         rotation around the first axis after applying _atom_sites_axes.matrix
;
         a2
;
         rotation around the second axis after applying _atom_sites_axes.matrix
;
         a3
;
         rotation around the third axis after applying _atom_sites_axes.matrix
;

save_

save_atom_site_rot_legendre.coeff

    _definition.id                '_atom_site_rot_Legendre.coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient corresponding to the Legendre polynomial
      defined by _atom_site_rot_Legendre.atom_site_label,
      _atom_site_rot_Legendre.axis and _atom_site_rot_Legendre.order.
      Atomic or rigid-group rotations must be expressed in degrees. Special
      axes are defined by the items belonging to the ATOM_SITES_AXES category,
      through _atom_site_rot_Legendre.matrix_seq_id.
;
    _name.category_id             atom_site_rot_Legendre
    _name.object_id               coeff
    _units.code                   degrees

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_rot_legendre.coeff_su

    _definition.id                '_atom_site_rot_Legendre.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_Legendre.coeff
;
    _name.category_id             atom_site_rot_Legendre
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_rot_Legendre.coeff'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_legendre.id

    _definition.id                '_atom_site_rot_Legendre.id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying each component of the displacive modulation of
      a given atom or rigid group when the modulation is expressed in
      terms of Legendre polynomials. In the case of a rigid group, it
      applies only to the rotational part of the distortion.
;
    _name.category_id             atom_site_rot_Legendre
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_legendre.matrix_seq_id

    _definition.id                '_atom_site_rot_Legendre.matrix_seq_id'
    _definition.update            2024-08-01
    _name.category_id             atom_site_rot_Legendre
    _name.object_id               matrix_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':transf_matrix_id}]

save_

save_atom_site_rot_legendre.order

    _definition.id                '_atom_site_rot_Legendre.order'
    _definition.update            2024-08-06
    _description.text
;
      The order of the Legendre polynomial.
;
    _name.category_id             atom_site_rot_Legendre
    _name.object_id               order
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_ATOM_SITE_ROT_ORTHO

    _definition.id                ATOM_SITE_ROT_ORTHO
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_ROT_ORTHO category record
      details about the orthogonalized functions defined to solve
      correlation problems during the refinement of displacive
      modulations when the the atomic domain of a given atom is
      restricted by a crenel function. The functions are constructed
      selecting Fourier harmonics until the desired degree of
      orthogonality and completeness is reached (see
      _atom_site_occ_special_func.crenel_ortho_eps).
      In the case of rigid groups, items in this category would only
      include the rotational part of the modulation.

      Notice that the global results could also be expressed (losing
      information about the orthogonalized functions) using the data
      items defined in the categories ATOM_SITE_ROT_FOURIER and
      ATOM_SITE_ROT_FOURIER_PARAM.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_ROT_ORTHO
    _category_key.name            '_atom_site_rot_ortho.id'

save_

save_atom_site_rot_ortho.atom_site_label

    _definition.id                '_atom_site_rot_ortho.atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom or rigid group in a loop in which
      the ortho components of its displacive modulation are listed.
      In the case of a rigid group, this list would only include the
      rotational part of its displacive modulation. The translational
      part (if any) would appear in a separate list (see
      _atom_site_displace_ortho.atom_site_label). This code must match
      the _atom_site.label of the associated coordinate list and
      conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_rot_ortho
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_ortho.axis

    _definition.id                '_atom_site_rot_ortho.axis'
    _definition.update            2024-07-27
    _description.text
;
      A label identifying the rotational part of the displacive modulation of
      a given rigid group that is being parameterized by orthogonalized
      functions. a, b and c are the basic lattice vectors of the reference
      structure. For composites they refer to the reference structure of
      each subsystem. a~1~, a~2~ and a~3~ are defined by the
      items belonging to the ATOM_SITES_AXES category, through
      _atom_site_rot_ortho.matrix_seq_id.
;
    _name.category_id             atom_site_rot_ortho
    _name.object_id               axis
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         x
;
         rotation around the a axis
;
         y
;
         rotation around the b axis
;
         z
;
         rotation around the c axis
;
         a1
;
         rotation around the first axis after applying _atom_sites_axes.matrix
;
         a2
;
         rotation around the second axis after applying _atom_sites_axes.matrix
;
         a3
;
         rotation around the third axis after applying _atom_sites_axes.matrix
;

save_

save_atom_site_rot_ortho.coeff

    _definition.id                '_atom_site_rot_ortho.coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient corresponding to the orthogonalized function
      defined by _atom_site_rot_ortho.atom_site_label,
      _atom_site_rot_ortho.axis and _atom_site_rot_ortho.func_id.
      Atomic or rigid-group rotations must be expressed in degrees. Special
      axes are defined by the items belonging to the ATOM_SITES_AXES category,
      through _atom_site_rot_ortho.matrix_seq_id.
;
    _name.category_id             atom_site_rot_ortho
    _name.object_id               coeff
    _units.code                   degrees

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_rot_ortho.coeff_su

    _definition.id                '_atom_site_rot_ortho.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_ortho.coeff
;
    _name.category_id             atom_site_rot_ortho
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_rot_ortho.coeff'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_ortho.func_id

    _definition.id                '_atom_site_rot_ortho.func_id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying the orthogonalized function used in the
      structural model to describe the displacive modulation of an atom
      or rigid group. In the case of a rigid group, it applies only
      to the rotational part of the distortion. This code must match
      _atom_sites_ortho_func_id.
;
    _name.category_id             atom_site_rot_ortho
    _name.object_id               func_id
    _name.linked_item_id          '_atom_sites_ortho.func_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_ortho.id

    _definition.id                '_atom_site_rot_ortho.id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying each component of the displacive modulation of
      a given atom or rigid group when the modulation is expressed in
      terms of ortho series. In the case of a rigid group, it
      applies only to the rotational part of the distortion.
;
    _name.category_id             atom_site_rot_ortho
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_ortho.matrix_seq_id

    _definition.id                '_atom_site_rot_ortho.matrix_seq_id'
    _definition.update            2024-08-01
    _name.category_id             atom_site_rot_ortho
    _name.object_id               matrix_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':transf_matrix_id}]

save_

save_ATOM_SITE_ROT_SPECIAL_FUNC

    _definition.id                ATOM_SITE_ROT_SPECIAL_FUNC
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_ROT_SPECIAL_FUNC category record
      details about the rotational part of the displacive modulation
      of a rigid group in a modulated structure when it is not described
      by Fourier series. See ATOM_SITE_DISPLACE_SPECIAL_FUNC for more
      detailed information.

      Atomic or rigid-group rotations should be expressed
      in degrees around either the unit cell axes or of the axes defined
      by the items belonging to the ATOM_SITES_AXES category, through
      _atom_site_rot_Fourier.matrix_seq_id.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_ROT_SPECIAL_FUNC
    _category_key.name            '_atom_site_rot_special_func.atom_site_label'

save_

save_atom_site_rot_special_func.atom_site_label

    _definition.id                '_atom_site_rot_special_func.atom_site_label'
    _alias.definition_id          '_atom_site_rot_special_func_atom_site_label'
    _definition.update            2014-06-27
    _description.text
;
      The code that identifies a rigid group in a loop in which
      the special function that describes the rotational part of
      its displacive modulation is being defined. This code must match
      the _atom_site.label of theassociated coordinate list and conform
      to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_special_func.matrix_seq_id

    _definition.id                '_atom_site_rot_special_func.matrix_seq_id'
    _definition.update            2024-08-01
    _name.category_id             atom_site_rot_special_func
    _name.object_id               matrix_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':transf_matrix_id}]

save_

save_atom_site_rot_special_func.sawtooth

    _definition.id                '_atom_site_rot_special_func.sawtooth'
    _definition.update            2024-08-08
    _description.text
;
      _atom_site_rot_special_func.sawtooth_ items are the
      adjustable parameters of a sawtooth function.

      A rotational sawtooth function along the internal space is
      defined as follows:

             [rx, ry, rz] = 2* [ax, ay, az] * ((x4-c)/w)

      for x4 belonging to the interval [c-(w/2), c+(w/2)], where ax,
      ay and az are the amplitudes (maximum displacements)
      along each axis (see below), w is its width, x4 is the
      internal coordinate and c is the centre of the function in
      internal space. rx, ry and rz must be expressed in degrees.

      Special axes are defined by the items belonging to the ATOM_SITES_AXES
      category, through _atom_site_rot_special_func.matrix_seq_id.
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth
    _type.purpose                 Describe
    _type.source                  Recorded
    _type.container               Single
    _type.contents                Text

save_

save_atom_site_rot_special_func.sawtooth_ax

    _definition.id                '_atom_site_rot_special_func.sawtooth_ax'
    _alias.definition_id          '_atom_site_rot_special_func_sawtooth_ax'
    _definition.update            2024-08-01
    _description.text
;
    The amplitude (maximum displacement) along the a (or a1) axis of the
    sawtooth function described in _atom_site_rot_special_func.sawtooth
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_ax
    _units.code                   degrees

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  atom_site_rot_special_func

            _atom_site_rot_special_func.sawtooth_ax = r.sawtooth_axyz[0]
;

save_

save_atom_site_rot_special_func.sawtooth_ax_su

    _definition.id                '_atom_site_rot_special_func.sawtooth_ax_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_special_func.sawtooth_ax
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_ax_su
    _name.linked_item_id          '_atom_site_rot_special_func.sawtooth_ax'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_special_func.sawtooth_axyz

    _definition.id                '_atom_site_rot_special_func.sawtooth_axyz'
    _definition.update            2024-08-06
    _description.text
;
    The vector of amplitudes (maximum displacements) along the a (or a1),
    b (or a2) and c (or a3) axis of the sawtooth function described in
    _atom_site_rot_special_func.sawtooth
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_axyz
    _type.purpose                 Measurand
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _enumeration.default          [0.0,0.0,0.0]
    _units.code                   degrees
    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  atom_site_rot_special_func

            _atom_site_rot_special_func.sawtooth_axyz =
                              [ r.sawtooth_ax, r.sawtooth_ay, r.sawtooth_az ]
;

save_

save_atom_site_rot_special_func.sawtooth_axyz_su

    _definition.id                '_atom_site_rot_special_func.sawtooth_axyz_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _atom_site_rot_special_func.sawtooth_axyz
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_axyz_su
    _name.linked_item_id          '_atom_site_rot_special_func.sawtooth_axyz'
    _type.purpose                 SU
    _type.source                  Related
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   degrees

save_

save_atom_site_rot_special_func.sawtooth_ay

    _definition.id                '_atom_site_rot_special_func.sawtooth_ay'
    _alias.definition_id          '_atom_site_rot_special_func_sawtooth_ay'
    _definition.update            2024-08-01
    _description.text
;
    The amplitude (maximum displacement) along the b (or a2) axis of the
    sawtooth function described in _atom_site_rot_special_func.sawtooth
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_ay
    _units.code                   degrees

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  atom_site_rot_special_func

            _atom_site_rot_special_func.sawtooth_ay = r.sawtooth_axyz[1]
;

save_

save_atom_site_rot_special_func.sawtooth_ay_su

    _definition.id                '_atom_site_rot_special_func.sawtooth_ay_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_special_func.sawtooth_ay
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_ay_su
    _name.linked_item_id          '_atom_site_rot_special_func.sawtooth_ay'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_special_func.sawtooth_az

    _definition.id                '_atom_site_rot_special_func.sawtooth_az'
    _alias.definition_id          '_atom_site_rot_special_func_sawtooth_az'
    _definition.update            2024-08-01
    _description.text
;
    The amplitude (maximum displacement) along the c (or a3) axis of the
    sawtooth function described in _atom_site_rot_special_func.sawtooth
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_az
    _units.code                   degrees

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  atom_site_rot_special_func

            _atom_site_rot_special_func.sawtooth_az = r.sawtooth_axyz[2]
;

save_

save_atom_site_rot_special_func.sawtooth_az_su

    _definition.id                '_atom_site_rot_special_func.sawtooth_az_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_special_func.sawtooth_az
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_az_su
    _name.linked_item_id          '_atom_site_rot_special_func.sawtooth_az'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_special_func.sawtooth_c

    _definition.id                '_atom_site_rot_special_func.sawtooth_c'
    _alias.definition_id          '_atom_site_rot_special_func_sawtooth_c'
    _definition.update            2024-08-01
    _description.text
;
    The centre of the sawtooth function described in
    _atom_site_rot_special_func.sawtooth
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_c
    _enumeration.range            0.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_rot_special_func.sawtooth_c_su

    _definition.id                '_atom_site_rot_special_func.sawtooth_c_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_special_func.sawtooth_c
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_c_su
    _name.linked_item_id          '_atom_site_rot_special_func.sawtooth_c'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_special_func.sawtooth_w

    _definition.id                '_atom_site_rot_special_func.sawtooth_w'
    _alias.definition_id          '_atom_site_rot_special_func_sawtooth_w'
    _definition.update            2024-08-01
    _description.text
;
    The width of the sawtooth function described in
    _atom_site_rot_special_func.sawtooth
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_w
    _enumeration.range            0.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_rot_special_func.sawtooth_w_su

    _definition.id                '_atom_site_rot_special_func.sawtooth_w_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_special_func.sawtooth_w
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               sawtooth_w_su
    _name.linked_item_id          '_atom_site_rot_special_func.sawtooth_w'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_special_func.zigzag

    _definition.id                '_atom_site_rot_special_func.zigzag'
    _definition.update            2024-08-08
    _description.text
;
      _atom_site_rot_special_func.zigzag_ items are the
      adjustable parameters of a zigzag function.

      A displacive zigzag function along the internal space is
      defined as follows:

                   2*[ax,ay,az]*(x4-c)/w for x4 in [c-(w/2),c+(w/2)]
      [rx,ry,rz] =
                  -2*[ax,ay,az]*(x4-c)/w for x4 in [c+1/2-(w/2),c+1/2+(w/2)]

      where ax,ay and az are the amplitudes (maximum displacements)
      along each axis (see below), w is its width, x4 is the internal
      coordinate and c is the centre of the function in internal space.
      rx, ry and rz must be expressed in degrees.

      Special axes are defined by the items belonging to the ATOM_SITES_AXES
      category, through _atom_site_rot_special_func.matrix_seq_id.
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               zigzag
    _type.purpose                 Describe
    _type.source                  Recorded
    _type.container               Single
    _type.contents                Text

save_

save_atom_site_rot_special_func.zigzag_axyz

    _definition.id                '_atom_site_rot_special_func.zigzag_axyz'
    _definition.update            2024-08-06
    _description.text
;
    The vector of amplitudes (maximum displacements) along the a (or a1),
    b (or a2) and c (or a3) axis of the zigzag function described in
    _atom_site_rot_special_func.zigzag
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               zigzag_axyz
    _type.purpose                 Measurand
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _enumeration.default          [0.0,0.0,0.0]
    _units.code                   degrees

save_

save_atom_site_rot_special_func.zigzag_axyz_su

    _definition.id                '_atom_site_rot_special_func.zigzag_axyz_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _atom_site_rot_special_func.zigzag_axyz
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               zigzag_axyz_su
    _name.linked_item_id          '_atom_site_rot_special_func.zigzag_axyz'
    _type.purpose                 SU
    _type.source                  Related
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   degrees

save_

save_atom_site_rot_special_func.zigzag_c

    _definition.id                '_atom_site_rot_special_func.zigzag_c'
    _definition.update            2024-08-01
    _description.text
;
    The centre of the zigzag function described in
    _atom_site_rot_special_func.zigzag
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               zigzag_c
    _enumeration.range            0.0:1.0
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_rot_special_func.zigzag_c_su

    _definition.id                '_atom_site_rot_special_func.zigzag_c_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_special_func.zigzag_c
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               zigzag_c_su
    _name.linked_item_id          '_atom_site_rot_special_func.zigzag_c'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_special_func.zigzag_w

    _definition.id                '_atom_site_rot_special_func.zigzag_w'
    _definition.update            2024-08-01
    _description.text
;
    The width of the zigzag function described in
    _atom_site_rot_special_func.zigzag
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               zigzag_w
    _enumeration.range            0.0:1.0
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_rot_special_func.zigzag_w_su

    _definition.id                '_atom_site_rot_special_func.zigzag_w_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_special_func.zigzag_w
;
    _name.category_id             atom_site_rot_special_func
    _name.object_id               zigzag_w_su
    _name.linked_item_id          '_atom_site_rot_special_func.zigzag_w'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_ATOM_SITE_ROT_XHARM

    _definition.id                ATOM_SITE_ROT_XHARM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_ROT_XHARM category record
      details about the x-harmonics used to describe the displacive
      modulations when the atomic domain of a given atom is restricted
      by a crenel function. In the case of rigid groups, items in this
      category would only include the rotational part of the modulation.
      The translational part would appear in a separate list of items
      belonging to the ATOM_SITE_DISPLACE_XHARM category.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_ROT_XHARM
    _category_key.name            '_atom_site_rot_xharm.id'

save_

save_atom_site_rot_xharm.atom_site_label

    _definition.id                '_atom_site_rot_xharm.atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom or rigid group in a loop in which
      the x-harmonics components of its displacive modulation are listed.
      In the case of a rigid group, this list would only include the
      rotational part of its displacive modulation. The translational
      part (if any) would appear in a separate list (see
      _atom_site_displace_xharm.atom_site_label). This code must match
      the _atom_site.label of the associated coordinate list and conform
      to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_rot_xharm
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_xharm.axis

    _definition.id                '_atom_site_rot_xharm.axis'
    _definition.update            2024-07-27
    _description.text
;
      A label identifying the rotational part of the displacive
      modulation of a given rigid group that is being parameterized by
      x-harmonics. a, b and c are the basic lattice vectors of the
      reference structure. For composites they refer to the reference
      structure of each subsystem. a~1~, a~2~ and a~3~ are defined by
      the items belonging to the ATOM_SITES_AXES category, through
      _atom_site_rot_xharm.matrix_seq_id.
;
    _name.category_id             atom_site_rot_xharm
    _name.object_id               axis
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         x
;
         rotation around the a axis
;
         y
;
         rotation around the b axis
;
         z
;
         rotation around the c axis
;
         a1
;
         rotation around the first axis after applying _atom_sites_axes.matrix
;
         a2
;
         rotation around the second axis after applying _atom_sites_axes.matrix
;
         a3
;
         rotation around the third axis after applying _atom_sites_axes.matrix
;

save_

save_atom_site_rot_xharm.coeff

    _definition.id                '_atom_site_rot_xharm.coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient corresponding to the x-harmonic function
      Defined by _atom_site_rot_xharm.atom_site_label,
      _atom_site_rot_xharm.axis and _atom_site_rot_xharm.order.
      Atomic or rigid-group rotations must be expressed in degrees. Special
      axes are defined by the items belonging to the ATOM_SITES_AXES category,
      through _atom_site_rot_xharm.matrix_seq_id.
;
    _name.category_id             atom_site_rot_xharm
    _name.object_id               coeff
    _units.code                   degrees

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_rot_xharm.coeff_su

    _definition.id                '_atom_site_rot_xharm.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_rot_xharm.coeff
;
    _name.category_id             atom_site_rot_xharm
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_rot_xharm.coeff'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_rot_xharm.id

    _definition.id                '_atom_site_rot_xharm.id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying each component of the displacive modulation of
      a given atom or rigid group when the modulation is expressed in
      terms of x-harmonics. In the case of a rigid group, it
      applies only to the rotational part of the distortion.
;
    _name.category_id             atom_site_rot_xharm
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_rot_xharm.matrix_seq_id

    _definition.id                '_atom_site_rot_xharm.matrix_seq_id'
    _definition.update            2024-08-01
    _name.category_id             atom_site_rot_xharm
    _name.object_id               matrix_seq_id

    _import.get
        [{'file':templ_attr.cif  'save':transf_matrix_id}]

save_

save_atom_site_rot_xharm.order

    _definition.id                '_atom_site_rot_xharm.order'
    _definition.update            2024-08-06
    _description.text
;
      The order of each x-harmonic function.
;
    _name.category_id             atom_site_rot_xharm
    _name.object_id               order
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_ATOM_SITE_U_FOURIER

    _definition.id                ATOM_SITE_U_FOURIER
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_U_FOURIER category record details
      about the Fourier components describing the modulation of the
      harmonic ADPs in a modulated structure. The (in general complex)
      coefficients of each Fourier component belong to the child
      ATOM_SITE_U_FOURIER_PARAM category and may be listed separately.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_U_FOURIER
    _category_key.name            '_atom_site_U_Fourier.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension               2

        loop_
         _cell_wave_vector.seq_id
         _cell_wave_vector.xyz
             1  [0.00338(6),0.15278(14),-0.0138(3)]
             2  [0.63105(7),1.07460(17),-0.4438(3)]

        _cell_subsystems.number                  2

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site.type_symbol
         _atom_site.label
         _atom_site.subsystem_code
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.U_iso_or_equiv
         _atom_site.calc_flag
         _atom_site.occupancy
          Sn Sn  H  0          0            0           0.01480(12) d 0.851(2)
          Cu Cu  H  0.0029(9)  0.0057(5)    0.1147(3)   0.0229(11)  d 0.149(2)
          S  S1  H  0.5033(2)  0.84278(12)  0.12342(7)  0.0177(3)   d 1
          Pb Pb  Q  0.05541(5) 0.24113(4)   0.36783(2)  0.03573(12) d 0.701(10)
          Sb Sb  Q  0.055408   0.241132     0.367832    0.03573(12) d 0.299(10)
          S  S2  Q -0.0402(3)  0.2583(2)    0.59639(13) 0.0310(4)   d 1

        loop_
         _atom_site_aniso.label
         _atom_site_aniso.U_11
         _atom_site_aniso.U_22
         _atom_site_aniso.U_33
         _atom_site_aniso.U_12
         _atom_site_aniso.U_13
         _atom_site_aniso.U_23
       Sn 0.0137(2)  0.00983(16) 0.0208(3) -0.00043(12) -0.00029(14) 0.00055(12)
       Cu 0.0180(16) 0.0138(13)  0.037(2)  -0.0009(10)  -0.0004(12)  0.0021(11)
       S1 0.0193(4)  0.0133(3)   0.0205(5) -0.0005(3)   -0.0005(3)   0.0008(3)
       Pb 0.0382(2)  0.03020(16) 0.0390(2) -0.00096(11) -0.00807(14) 0.00192(11)
       Sb 0.0382(2)  0.03020(16) 0.0390(2) -0.00096(11) -0.00807(14) 0.00192(11)
       S2 0.0395(8)  0.0295(6)   0.0237(7) -0.0002(5)   -0.0052(6)   0.0019(5)

        loop_
         _atom_site_Fourier_wave_vector.seq_id
         _atom_site_Fourier_wave_vector.xyz
         _atom_site_Fourier_wave_vector.q_coeff_seq_id
         _atom_site_Fourier_wave_vector.q_coeff
            1  [0.00338,0.15278,-0.0138]  [1]   [1]
            2  [0.63105,1.07460,-0.4438]  [2]   [1]
            3  [0.00676,0.30556,-0.0276]  [1]   [2]
            4  [0.01014,0.45834,-0.0414]  [1]   [3]
            5  [0.01352,0.61112,-0.0552]  [1]   [4]
            6  [0.63443,1.22738,-0.4576]  [1,2] [1,1]

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_U_Fourier.id
         _atom_site_U_Fourier.atom_site_label
         _atom_site_U_Fourier.tens_elem
         _atom_site_U_Fourier.wave_vector_seq_id
         _atom_site_U_Fourier_param.cos
         _atom_site_U_Fourier_param.sin
         Sn_U11_1  Sn  U11  1   0.0002(2)     0
         Sn_U22_1  Sn  U22  1  -0.00056(18)   0
         Sn_U33_1  Sn  U33  1   0.0007(3)     0
         Sn_U12_1  Sn  U12  1  -0.00012(17)   0
         Sn_U13_1  Sn  U13  1   0.0002(2)     0
         Sn_U23_1  Sn  U23  1  -0.00053(17)   0
         Pb_U11_1  Pb  U11  1   0.0002(3)    -0.0025(3)
         Pb_U22_1  Pb  U22  1   0.0007(2)     0.0036(2)
         Pb_U33_1  Pb  U33  1   0.0019(3)    -0.0110(3)
         Pb_U12_1  Pb  U12  1  -0.00164(15)   0.00023(15)
         Pb_U13_1  Pb  U13  1  -0.00019(18)   0.00244(19)
         Pb_U23_1  Pb  U23  1   0.00668(15)  -0.00125(16)
         Pb_U11_3  Pb  U11  3  -0.0007(3)     0.0006(3)
         Pb_U22_3  Pb  U22  3  -0.0002(2)     0.0008(2)
         Pb_U33_3  Pb  U33  3  -0.0007(3)     0.0009(3)
         Pb_U12_3  Pb  U12  3  -0.00006(16)   0.00069(16)
         Pb_U13_3  Pb  U13  3  -0.00023(18)  -0.0004(2)
         Pb_U23_3  Pb  U23  3   0.00004(15)  -0.00305(16)
        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Michel Evain, Vaclav Petricek, Yves Moelo and Colette Maurel (2006)
        Acta Cryst. B62, 775-789. doi:10.1107/S010876810602547X
        First (3 + 2)-dimensional superspace approach to the structure of
        levyclaudite-(Sb), a member of the cylindrite-type minerals
;

save_

save_atom_site_u_fourier.atom_site_label

    _definition.id                '_atom_site_U_Fourier.atom_site_label'
    _alias.definition_id          '_atom_site_U_Fourier_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom in a loop in which the Fourier
      components of its harmonic ADP modulation are listed.  This code
      must match the _atom_site.label of the associated coordinate list
      and conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_U_Fourier
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_u_fourier.id

    _definition.id                '_atom_site_U_Fourier.id'
    _alias.definition_id          '_atom_site_U_Fourier_id'
    _definition.update            2024-07-31
    _description.text
;
      A code identifying each Fourier component used to describe
      the modulation of harmonic ADPs.
;
    _name.category_id             atom_site_U_Fourier
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_u_fourier.tens_elem

    _definition.id                '_atom_site_U_Fourier.tens_elem'
    _alias.definition_id          '_atom_site_U_Fourier_tens_elem'
    _definition.update            2024-07-31
    _description.text
;
      A label identifying the harmonic ADP tensor element U(ij) of a
      given atom  whose modulation is being parameterized
      by Fourier series.
;
    _name.category_id             atom_site_U_Fourier
    _name.object_id               tens_elem
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         U11                      'modulation of U11'
         U12                      'modulation of U12'
         U13                      'modulation of U13'
         U22                      'modulation of U22'
         U23                      'modulation of U23'
         U33                      'modulation of U33'
         Uiso                     'modulation of U~isotropic~'

save_

save_atom_site_u_fourier.wave_vector_seq_id

    _definition.id                '_atom_site_U_Fourier.wave_vector_seq_id'
    _alias.definition_id          '_atom_site_U_Fourier_wave_vector_seq_id'
    _definition.update            2024-07-31
    _description.text
;
      A numeric code identifying the wave vectors of the Fourier terms
      used to describe the modulation functions corresponding to the
      harmonic ADP of an atom. This code must match
      _atom_site_Fourier_wave_vector.seq_id.
;
    _name.category_id             atom_site_U_Fourier
    _name.object_id               wave_vector_seq_id
    _name.linked_item_id          '_atom_site_Fourier_wave_vector.seq_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Integer

save_

save_ATOM_SITE_U_FOURIER_PARAM

    _definition.id                ATOM_SITE_U_FOURIER_PARAM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-07-31
    _description.text
;
      Data items in the ATOM_SITE_U_FOURIER_PARAM category record details
      about the coefficients of the Fourier series used to describe the
      modulation of the harmonic ADPs in a modulated structure. The
      Fourier components are defined in the parent category
      ATOM_SITE_U_FOURIER and are listed separately. Notice that items
      in this category may be listed together with those of the
      ATOM_SITE_U_FOURIER category. To simplify the description,
      below is explained the one-dimensional case.

      The modulation of the harmonic ADPs is usually parameterized by
      Fourier series. Each term of the series commonly adopts two different
      representations: the sine-cosine form,
               U(ij)cn cos(2\\p n x4)+(Uij)sn sin(2\\p n x4),
      and the modulus-argument form,
               |U(ij)n| cos(2\\p n x4+\\c(ij)n),
      where x4=q*(r+T)+t. q is the modulation wave vector and r and T
      stand for a phase reference position and a lattice translation of
      the reference structure, respectively. The phase reference position
      can be chosen as the average position of the modulated atom, if
      not in a rigid group or, in case of rigid groups a common point
      for all atoms in the group. t is an arbitrary phase, irrelevant for
      incommensurate modulated structures, but essential in the commensurate
      case (see _atom_sites_modulation_global_phase_t_).

      Fourier coefficients of the harmonic ADPs must be expressed in
      angstroms squared.
;
    _name.category_id             ATOM_SITE_U_FOURIER
    _name.object_id               ATOM_SITE_U_FOURIER_PARAM
    _category_key.name            '_atom_site_U_Fourier_param.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension               2

        loop_
         _cell_wave_vector.seq_id
         _cell_wave_vector.xyz
             1  [0.00338(6),0.15278(14),-0.0138(3)]
             2  [0.63105(7),1.07460(17),-0.4438(3)]

        _cell_subsystems.number                  2

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site.type_symbol
         _atom_site.label
         _atom_site.subsystem_code
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.U_iso_or_equiv
         _atom_site.calc_flag
         _atom_site.occupancy
          Sn Sn  H  0          0            0           0.01480(12) d 0.851(2)
          Cu Cu  H  0.0029(9)  0.0057(5)    0.1147(3)   0.0229(11)  d 0.149(2)
          S  S1  H  0.5033(2)  0.84278(12)  0.12342(7)  0.0177(3)   d 1
          Pb Pb  Q  0.05541(5) 0.24113(4)   0.36783(2)  0.03573(12) d 0.701(10)
          Sb Sb  Q  0.055408   0.241132     0.367832    0.03573(12) d 0.299(10)
          S  S2  Q -0.0402(3)  0.2583(2)    0.59639(13) 0.0310(4)   d 1

        loop_
         _atom_site_aniso.label
         _atom_site_aniso.U_11
         _atom_site_aniso.U_22
         _atom_site_aniso.U_33
         _atom_site_aniso.U_12
         _atom_site_aniso.U_13
         _atom_site_aniso.U_23
       Sn 0.0137(2)  0.00983(16) 0.0208(3) -0.00043(12) -0.00029(14) 0.00055(12)
       Cu 0.0180(16) 0.0138(13)  0.037(2)  -0.0009(10)  -0.0004(12)  0.0021(11)
       S1 0.0193(4)  0.0133(3)   0.0205(5) -0.0005(3)   -0.0005(3)   0.0008(3)
       Pb 0.0382(2)  0.03020(16) 0.0390(2) -0.00096(11) -0.00807(14) 0.00192(11)
       Sb 0.0382(2)  0.03020(16) 0.0390(2) -0.00096(11) -0.00807(14) 0.00192(11)
       S2 0.0395(8)  0.0295(6)   0.0237(7) -0.0002(5)   -0.0052(6)   0.0019(5)

        loop_
         _atom_site_Fourier_wave_vector.seq_id
         _atom_site_Fourier_wave_vector.xyz
         _atom_site_Fourier_wave_vector.q_coeff_seq_id
         _atom_site_Fourier_wave_vector.q_coeff
            1  [0.00338,0.15278,-0.0138]  [1]   [1]
            2  [0.63105,1.07460,-0.4438]  [2]   [1]
            3  [0.00676,0.30556,-0.0276]  [1]   [2]
            4  [0.01014,0.45834,-0.0414]  [1]   [3]
            5  [0.01352,0.61112,-0.0552]  [1]   [4]
            6  [0.63443,1.22738,-0.4576]  [1,2] [1,1]

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_U_Fourier.id
         _atom_site_U_Fourier.atom_site_label
         _atom_site_U_Fourier.tens_elem
         _atom_site_U_Fourier.wave_vector_seq_id
         Sn_U11_1  Sn  U11  1
         Sn_U22_1  Sn  U22  1
         Sn_U33_1  Sn  U33  1
         Sn_U12_1  Sn  U12  1
         Sn_U13_1  Sn  U13  1
         Sn_U23_1  Sn  U23  1
         Pb_U11_1  Pb  U11  1
         Pb_U22_1  Pb  U22  1
         Pb_U33_1  Pb  U33  1
         Pb_U12_1  Pb  U12  1
         Pb_U13_1  Pb  U13  1
         Pb_U23_1  Pb  U23  1
         Pb_U11_3  Pb  U11  3
         Pb_U22_3  Pb  U22  3
         Pb_U33_3  Pb  U33  3
         Pb_U12_3  Pb  U12  3
         Pb_U13_3  Pb  U13  3
         Pb_U23_3  Pb  U23  3
        # - - - - data truncated for brevity - - -

        loop_
         _atom_site_U_Fourier_param.id
         _atom_site_U_Fourier_param.cos
         _atom_site_U_Fourier_param.sin
         Sn_U11_1  0.0002(2)     0
         Sn_U22_1 -0.00056(18)   0
         Sn_U33_1  0.0007(3)     0
         Sn_U12_1 -0.00012(17)   0
         Sn_U13_1  0.0002(2)     0
         Sn_U23_1 -0.00053(17)   0
         Pb_U11_1  0.0002(3)    -0.0025(3)
         Pb_U22_1  0.0007(2)     0.0036(2)
         Pb_U33_1  0.0019(3)    -0.0110(3)
         Pb_U12_1 -0.00164(15)   0.00023(15)
         Pb_U13_1 -0.00019(18)   0.00244(19)
         Pb_U23_1  0.00668(15)  -0.00125(16)
         Pb_U11_3 -0.0007(3)     0.0006(3)
         Pb_U22_3 -0.0002(2)     0.0008(2)
         Pb_U33_3 -0.0007(3)     0.0009(3)
         Pb_U12_3 -0.00006(16)   0.00069(16)
         Pb_U13_3 -0.00023(18)  -0.0004(2)
         Pb_U23_3  0.00004(15)  -0.00305(16)
        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Michel Evain, Vaclav Petricek, Yves Moelo and Colette Maurel (2006)
        Acta Cryst. B62, 775-789. doi:10.1107/S010876810602547X
        First (3 + 2)-dimensional superspace approach to the structure of
        levyclaudite-(Sb), a member of the cylindrite-type minerals
;

save_

save_atom_site_u_fourier_param.cos

    _definition.id                '_atom_site_U_Fourier_param.cos'
    _alias.definition_id          '_atom_site_U_Fourier_param_cos'
    _definition.update            2024-08-01
    _description.text
;
      The cosine coefficient [U(ij)cn] corresponding to the Fourier term
      defined by _atom_site_U_Fourier.atom_site_label,
      _atom_site_U_Fourier.tens_elem and
      _atom_site_U_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_U_Fourier_param
    _name.object_id               cos
    _units.code                   angstrom_squared

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_U_Fourier_param

       _atom_site_U_Fourier_param.cos =  p.modulus*Cos(TwoPi*p.phase)
;

save_

save_atom_site_u_fourier_param.cos_su

    _definition.id                '_atom_site_U_Fourier_param.cos_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_U_Fourier_param.cos
;
    _name.category_id             atom_site_U_Fourier_param
    _name.object_id               cos_su
    _name.linked_item_id          '_atom_site_U_Fourier_param.cos'
    _units.code                   angstrom_squared

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_u_fourier_param.id

    _definition.id                '_atom_site_U_Fourier_param.id'
    _alias.definition_id          '_atom_site_U_Fourier_param_id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying the (in general complex) coefficient of each
      term present in the Fourier series describing the modulation of
      the ADP. This code must match
      _atom_site_U_Fourier.id.
;
    _name.category_id             atom_site_U_Fourier_param
    _name.object_id               id
    _name.linked_item_id          '_atom_site_U_Fourier.id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_u_fourier_param.modulus

    _definition.id                '_atom_site_U_Fourier_param.modulus'
    _alias.definition_id          '_atom_site_U_Fourier_param_modulus'
    _definition.update            2024-08-01
    _description.text
;
      The the modulus [|U(ij)n|] of the complex amplitudes corresponding
      to the Fourier term defined by _atom_site_U_Fourier.atom_site_label,
      _atom_site_U_Fourier.tens_elem and
      _atom_site_U_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_U_Fourier_param
    _name.object_id               modulus
    _enumeration.range            0.0:
    _units.code                   angstrom_squared

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_U_Fourier_param

       _atom_site_U_Fourier_param.modulus =  Sqrt(p.cos**2+p.sin**2)
;

save_

save_atom_site_u_fourier_param.modulus_su

    _definition.id                '_atom_site_U_Fourier_param.modulus_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_U_Fourier_param.modulus
;
    _name.category_id             atom_site_U_Fourier_param
    _name.object_id               modulus_su
    _name.linked_item_id          '_atom_site_U_Fourier_param.modulus'
    _units.code                   angstrom_squared

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_u_fourier_param.phase

    _definition.id                '_atom_site_U_Fourier_param.phase'
    _alias.definition_id          '_atom_site_U_Fourier_param_phase'
    _definition.update            2024-08-01
    _description.text
;
      The phase [\c(ij)n/2\\p], in cycles, of the complex amplitude
      corresponding to the Fourier term defined by
      _atom_site_U_Fourier.atom_site_label,
      _atom_site_U_Fourier.tens_elem and
      _atom_site_U_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_U_Fourier_param
    _name.object_id               phase
    _enumeration.range            -1.0:1.0
    _units.code                   cycles

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_U_Fourier_param

       _atom_site_U_Fourier_param.phase =  Phase(Complex(p.cos,-p.sin))/TwoPi
;

save_

save_atom_site_u_fourier_param.phase_su

    _definition.id                '_atom_site_U_Fourier_param.phase_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_U_Fourier_param.phase
;
    _name.category_id             atom_site_U_Fourier_param
    _name.object_id               phase_su
    _name.linked_item_id          '_atom_site_U_Fourier_param.phase'
    _units.code                   cycles

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_u_fourier_param.sin

    _definition.id                '_atom_site_U_Fourier_param.sin'
    _alias.definition_id          '_atom_site_U_Fourier_param_sin'
    _definition.update            2024-08-01
    _description.text
;
      The sine coefficient [U(ij)sn] corresponding to the Fourier term
      defined by _atom_site_U_Fourier.atom_site_label,
      _atom_site_U_Fourier.tens_elem and
      _atom_site_U_Fourier.wave_vector_seq_id.
;
    _name.category_id             atom_site_U_Fourier_param
    _name.object_id               sin
    _units.code                   angstrom_squared

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
      With  p  as  atom_site_U_Fourier_param

       _atom_site_U_Fourier_param.sin =  -p.modulus*Sin(TwoPi*p.phase)
;

save_

save_atom_site_u_fourier_param.sin_su

    _definition.id                '_atom_site_U_Fourier_param.sin_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_U_Fourier_param.sin
;
    _name.category_id             atom_site_U_Fourier_param
    _name.object_id               sin_su
    _name.linked_item_id          '_atom_site_U_Fourier_param.sin'
    _units.code                   angstrom_squared

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_ATOM_SITE_U_LEGENDRE

    _definition.id                ATOM_SITE_U_LEGENDRE
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_U_LEGENDRE category record
      details about the Legendre polynomials used to describe the
      harmonic ADP modulations when the atomic domain of a given atom is
      restricted by a crenel function. See ATOM_SITE_DISPLACE_LEGENDRE
      for more detailed information.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_U_LEGENDRE
    _category_key.name            '_atom_site_u_Legendre.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension               1

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site.label
         _atom_site.type_symbol
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.adp_type
         _atom_site.U_iso_or_equiv
         _atom_site.site_symmetry_multiplicity
         _atom_site.occupancy
         _atom_site.calc_flag
         _atom_site.refinement_flags_posn
         _atom_site.disorder_assembly
         _atom_site.disorder_group
          Y1 Y 0.61475(10) 0.80738(5) 0.25 Uani 0.0107(3) 6 1 d . . .
          Zn1 Zn 0.86508(10) 0.43254(5) 0.25 Uani 0.0117(3) 6 1 d . . .
          Zn2 Zn 0.666667 0.333333 0.51174(10) Uani 0.0122(3) 4 1 d . . .
          Zn3 Zn 1 0.5 0.5 Uani 0.0123(6) 6 1 d . . .
          Zn4 Zn 0.8383(2) 0.67858(8) 0.41030(6) Uani 0.0139(5) 12 1 d . . .
          Zn5 Zn 1 1 0 Uani 0.0196(12) 2 0.988(4) d . . .
          Zn6 Zn 1 1 0.25 Uani 0.0140(9) 2 0.664(4) d . . .

        loop_
         _atom_site_aniso.label
         _atom_site_aniso.type_symbol
         _atom_site_aniso.U_11
         _atom_site_aniso.U_22
         _atom_site_aniso.U_33
         _atom_site_aniso.U_12
         _atom_site_aniso.U_13
         _atom_site_aniso.U_23
          Y1 Y 0.0123(4) 0.0104(3) 0.0102(3) 0.00617(19) 0 0.0067(7)
          Zn1 Zn 0.0118(4) 0.0130(3) 0.0099(4) 0.0059(2) 0 0.0002(12)
          Zn2 Zn 0.0115(3) 0.0115(3) 0.0134(5) 0.00577(16) 0 0
          Zn3 Zn 0.0115(4) 0.0122(9) 0.0108(4) 0.0040(9) -0.0017(3) 0.0004(11)
          Zn4 Zn 0.0162(8) 0.0147(4) 0.0140(3) 0.0102(7) 0.0002(8) 0.0006(2)
          Zn5 Zn 0.0149(6) 0.0149(6) 0.029(3) 0.0074(3) 0 0
          Zn6 Zn 0.0144(7) 0.0144(7) 0.013(2) 0.0072(4) 0 0

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_occ_special_func.atom_site_label
         _atom_site_occ_special_func.crenel_c
         _atom_site_occ_special_func.crenel_w
          Zn5  0.5  0.988(4)
          Zn6  0.75  0.664(4)

        loop_
         _atom_site_U_Legendre.id
         _atom_site_U_Legendre.atom_site_label
         _atom_site_U_Legendre.tens_elem
         _atom_site_U_Legendre.order
         _atom_site_U_Legendre.coeff
          1 Zn5  U11  1     0
          2 Zn5  U22  1     0
          3 Zn5  U33  1     0
          4 Zn5  U12  1     0
          5 Zn5  U13  1     0
          6 Zn5  U23  1     0
          7 Zn5  U11  2    -0.008(3)
          8 Zn5  U22  2    -0.008(3)
          9 Zn5  U33  2    -0.016(6)
         10 Zn5  U12  2    -0.0038(13)
         11 Zn5  U13  2     0
         12 Zn5  U23  2     0

        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Rie T. Fredrickson and Daniel C. Fredrickson (2023)
        Acta Cryst. B79, 775-789. doi:10.1107/S2052520623005292
        As Predicted and More: Modulated Channel Occupation in YZn_{5+x}
;

save_

save_atom_site_u_legendre.atom_site_label

    _definition.id                '_atom_site_U_Legendre.atom_site_label'
    _alias.definition_id          '_jana_atom_site_U_Legendre_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom in a loop in which the Legendre
      components of its harmonic ADP modulation are listed. This code must
      match the _atom_site.label of the associated coordinate list and
      conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_U_Legendre
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_u_legendre.coeff

    _definition.id                '_atom_site_U_Legendre.coeff'
    _alias.definition_id          '_jana_atom_site_U_Legendre_param_coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient, in angstroms squared, corresponding to the
      Legendre polynomial defined by _atom_site_U_Legendre.atom_site_label,
      _atom_site_U_Legendre.tens_elem and _atom_site_U_Legendre.order.
;
    _name.category_id             atom_site_U_Legendre
    _name.object_id               coeff
    _units.code                   angstrom_squared

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_u_legendre.coeff_su

    _definition.id                '_atom_site_U_Legendre.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_U_Legendre.coeff
;
    _name.category_id             atom_site_U_Legendre
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_U_Legendre.coeff'
    _units.code                   angstrom_squared

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_u_legendre.id

    _definition.id                '_atom_site_U_Legendre.id'
    _definition.update            2014-06-27
    _description.text
;
      A code identifying each component of the ADP modulation of
      a given atom when the modulation is expressed in terms of Legendre
      polynomials.
;
    _name.category_id             atom_site_U_Legendre
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_u_legendre.order

    _definition.id                '_atom_site_U_Legendre.order'
    _alias.definition_id          '_jana_atom_site_U_Legendre_param_order'
    _definition.update            2024-08-06
    _description.text
;
      The order of the Legendre polynomial.
;
    _name.category_id             atom_site_U_Legendre
    _name.object_id               order
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_atom_site_u_legendre.tens_elem

    _definition.id                '_atom_site_U_Legendre.tens_elem'
    _alias.definition_id          '_jana_atom_site_U_Legendre_tens_elem'
    _definition.update            2024-04-01
    _description.text
;
      A label identifying the ADP tensor element U(ij) a given atom
      whose modulation is being parameterized by Legendre polynomials.

;
    _name.category_id             atom_site_U_Legendre
    _name.object_id               tens_elem
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         U11                      'modulation of U11'
         U12                      'modulation of U12'
         U13                      'modulation of U13'
         U22                      'modulation of U22'
         U23                      'modulation of U23'
         U33                      'modulation of U33'
         Uiso                     'modulation of U~isotropic~'

save_

save_ATOM_SITE_U_ORTHO

    _definition.id                ATOM_SITE_U_ORTHO
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_U_ORTHO category record
      details about the orthogonalized functions defined to solve
      correlation problems during the refinement of harmonic ADP
      modulations when the atomic domain of a given atom is
      restricted by a crenel function. The functions are constructed
      selecting Fourier harmonics until the desired degree of
      orthogonality and completeness is reached (see
      _atom_site_occ_special_func.crenel_ortho_eps).

      Notice that the global results could also be expressed (losing
      information about the orthogonalized functions) using the data items
      defined in the categories ATOM_SITE_U_FOURIER and
      ATOM_SITE_U_FOURIER_PARAM.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_U_ORTHO
    _category_key.name            '_atom_site_U_ortho.id'

save_

save_atom_site_u_ortho.atom_site_label

    _definition.id                '_atom_site_U_ortho.atom_site_label'
    _alias.definition_id
        '_jana_atom_site_U_crenel_ortho_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom in a loop in which the ortho
      components of its harmonic ADP modulation are listed. This code must
      match the _atom_site.label of the associated coordinate list and
      conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_U_ortho
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_u_ortho.coeff

    _definition.id                '_atom_site_U_ortho.coeff'
    _alias.definition_id          '_jana_atom_site_U_crenel_ortho_param_coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient, in angstroms squared, corresponding to the
      orthogonalized function defined by _atom_site_U_ortho.atom_site_label,
      _atom_site_U_ortho.tens_elem and _atom_site_U_ortho.func_id.
;
    _name.category_id             atom_site_U_ortho
    _name.object_id               coeff
    _units.code                   angstrom_squared

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_u_ortho.coeff_su

    _definition.id                '_atom_site_U_ortho.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_U_ortho.coeff
;
    _name.category_id             atom_site_U_ortho
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_U_ortho.coeff'
    _units.code                   angstrom_squared

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_u_ortho.func_id

    _definition.id                '_atom_site_U_ortho.func_id'
    _alias.definition_id          '_jana_atom_site_U_crenel_ortho_id'
    _definition.update            2024-07-31
    _description.text
;
      A code identifying the orthogonalized function used in the
      structural model to describe the harmonic ADP modulation of an atom.
      This code must match _atom_sites_ortho.func_id.
;
    _name.category_id             atom_site_U_ortho
    _name.object_id               func_id
    _name.linked_item_id          '_atom_sites_ortho.func_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_u_ortho.id

    _definition.id                '_atom_site_U_ortho.id'
    _definition.update            2024-07-31
    _description.text
;
      A code identifying each component of the harmonic ADP modulation of
      a given atom when the modulation is expressed in terms of ortho
      series.
;
    _name.category_id             atom_site_U_ortho
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_u_ortho.tens_elem

    _definition.id                '_atom_site_U_ortho.tens_elem'
    _alias.definition_id          '_jana_atom_site_U_crenel_ortho_tens_elem'
    _definition.update            2024-07-31
    _description.text
;
      A label identifying the harmonic ADP tensor element U(ij) a given
      atom whose modulation is being parameterized by orthogonalized
      functions.

;
    _name.category_id             atom_site_U_ortho
    _name.object_id               tens_elem
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         U11                      'modulation of U11'
         U12                      'modulation of U12'
         U13                      'modulation of U13'
         U22                      'modulation of U22'
         U23                      'modulation of U23'
         U33                      'modulation of U33'
         Uiso                     'modulation of U~isotropic~'

save_

save_ATOM_SITE_U_XHARM

    _definition.id                ATOM_SITE_U_XHARM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITE_U_XHARM category record details about
      the x-harmonics used to describe the harmonic ADP modulations when
      the atomic domain of a given atom is restricted by a crenel
      function. See ATOM_SITE_DISPLACE_XHARM for more detailed information.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITE_U_XHARM
    _category_key.name            '_atom_site_U_xharm.id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension        1

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site.label
         _atom_site.type_symbol
         _atom_site.fract_x
         _atom_site.fract_y
         _atom_site.fract_z
         _atom_site.U_iso_or_equiv
         _atom_site.site_symmetry_multiplicity
         _atom_site.occupancy
         _atom_site.calc_flag
          Fe1   Fe          0.5  0.356897(15)          0.25   0.01310(9)  4 1  d
          S1    S    0.33286(3)  0.351013(19)   -0.19593(5)  0.01402(11)  8 1  d
          O2s   O    0.22908(8)    0.34282(6)  -0.11998(17)    0.0264(4)  8 1  d
          O4s   O   0.33393(13)    0.42245(6)    -0.3114(2)    0.0277(4)  8 1  d
          O3s   O   0.35027(13)    0.28467(7)    -0.3189(2)    0.0258(7)  8 1  d
          O6w   O     0.6044(2)   0.27668(14)     0.1791(4)    0.0317(9)  8 1  d

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_aniso.label
         _atom_site_aniso.U_11
         _atom_site_aniso.U_22
         _atom_site_aniso.U_33
         _atom_site_aniso.U_12
         _atom_site_aniso.U_13
         _atom_site_aniso.U_23
       Fe1 0.01362(15) 0.01408(15) 0.0111(2)           0 0.00098(12)           0
       S1  0.01275(17) 0.01712(18) 0.0118(2) 0.00005(12) 0.00129(14) 0.00043(12)
       O2s   0.0172(5)   0.0314(6) 0.0327(7)  -0.0009(4)   0.0106(5)   0.0004(5)
       O4s   0.0431(7)   0.0153(5) 0.0270(7)  -0.0005(5)   0.0128(6)   0.0016(5)
       O3s  0.0422(12)   0.0150(9)  0.023(2)   0.0015(8)  0.0137(10) -0.0003(10)
       O6w  0.0359(15)  0.0348(15)  0.028(2)  0.0201(10)  0.0147(12)   0.0082(9)

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_occ_special_func.atom_site_label
         _atom_site_occ_special_func.crenel_c
         _atom_site_occ_special_func.crenel_w
         O3s        0.2381    1
         O6w        0.5946    1

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_site_U_xharm.id
         _atom_site_U_xharm.atom_site_label
         _atom_site_U_xharm.tens_elem
         _atom_site_U_xharm.order
         _atom_site_U_xharm.coeff
          1 O3s  U11  1  -0.0106(17)
          2 O3s  U22  1   0.0005(18)
          3 O3s  U33  1  -0.0068(15)
          4 O3s  U12  1  -0.0003(13)
          5 O3s  U13  1  -0.0070(12)
          6 O3s  U23  1   0.0002(12)
          7 O3s  U11  2    -0.007(3)
          8 O3s  U22  2   0.0020(11)
          9 O3s  U33  2    -0.001(4)
         10 O3s  U12  2  -0.0058(18)
         11 O3s  U13  2    -0.006(2)
         12 O3s  U23  2    -0.004(2)
         13 O6w  U11  1  -0.0099(14)
         14 O6w  U22  1    -0.013(2)
         15 O6w  U33  1  -0.0069(16)
         16 O6w  U12  1  -0.0091(12)
         17 O6w  U13  1  -0.0085(12)
         18 O6w  U23  1  -0.0068(13)
         19 O6w  U11  2     0.002(4)
         20 O6w  U22  2     0.001(2)
         21 O6w  U33  2    -0.005(4)
         22 O6w  U12  2     0.001(3)
         23 O6w  U13  2    -0.003(3)
         24 O6w  U23  2    -0.003(2)

        #=======================================================================

        Example based on the article:
        Tamara J. Bernarchuk, Wolfgang Hornfeck, Vasyl Kinzhybalo, Zhengyang
        Zhou, Michal Dusek and Adam Pietraszko (2019)
        Acta Cryst. B75, 1144-1151. doi:10.1107/S2052520619013155
        The structures and phase transitions in 4-aminopyridinium
        tetraaquabis(sulfato)iron(III),
        (C~5~H~7~N~2~)[Fe^III^(H~2~O)~4~(SO~4~)~2~]
;

save_

save_atom_site_u_xharm.atom_site_label

    _definition.id                '_atom_site_U_xharm.atom_site_label'
    _alias.definition_id          '_jana_atom_site_U_XHarm_atom_site_label'
    _definition.update            2024-07-31
    _description.text
;
      The code that identifies an atom in a loop in which the x-harmonic
      components of its harmonic ADP modulation are listed. This code must
      match the _atom_site.label of the associated coordinate list and
      conform to the rules described in _atom_site.label.
;
    _name.category_id             atom_site_U_xharm
    _name.object_id               atom_site_label
    _name.linked_item_id          '_atom_site.label'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_u_xharm.coeff

    _definition.id                '_atom_site_U_xharm.coeff'
    _alias.definition_id          '_jana_atom_site_U_XHarm_param_coeff'
    _definition.update            2024-08-01
    _description.text
;
      The coefficient, in angstroms squared, corresponding to the
      x-harmonics defined by _atom_site_U_xharm.atom_site_label,
      _atom_site_U_xharm.tens_elem and _atom_site_U_xharm.order.
;
    _name.category_id             atom_site_U_xharm
    _name.object_id               coeff
    _units.code                   angstrom_squared

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

save_

save_atom_site_u_xharm.coeff_su

    _definition.id                '_atom_site_U_xharm.coeff_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _atom_site_U_xharm.coeff
;
    _name.category_id             atom_site_U_xharm
    _name.object_id               coeff_su
    _name.linked_item_id          '_atom_site_U_xharm.coeff'
    _units.code                   angstrom_squared

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_atom_site_u_xharm.id

    _definition.id                '_atom_site_U_xharm.id'
    _definition.update            2024-07-31
    _description.text
;
      A code identifying each component of the harmonic ADP modulation of
      a given atom when the modulation is expressed in terms of x-harmonics.
;
    _name.category_id             atom_site_U_xharm
    _name.object_id               id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_site_u_xharm.order

    _definition.id                '_atom_site_U_xharm.order'
    _alias.definition_id          '_jana_atom_site_U_XHarm_param_order'
    _definition.update            2024-08-06
    _description.text
;
      The order of each x-harmonic function.
;
    _name.category_id             atom_site_U_xharm
    _name.object_id               order
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_atom_site_u_xharm.tens_elem

    _definition.id                '_atom_site_U_xharm.tens_elem'
    _alias.definition_id          '_jana_atom_site_U_XHarm_tens_elem'
    _definition.update            2024-07-31
    _description.text
;
      A label identifying the harmonic ADP tensor element U(ij) a given
      atom whose modulation is being parameterized by x-harmonics.
;
    _name.category_id             atom_site_U_xharm
    _name.object_id               tens_elem
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         U11                      'modulation of U11'
         U12                      'modulation of U12'
         U13                      'modulation of U13'
         U22                      'modulation of U22'
         U23                      'modulation of U23'
         U33                      'modulation of U33'
         Uiso                     'modulation of U~isotropic~'

save_

save_ATOM_SITES_AXES

    _definition.id                ATOM_SITES_AXES
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITES_AXES category record
      details about the transformation matrices that define the
      displacements and rotations of atoms and rigid groups. Details
      for individual atom sites are described by data items in
      the ATOM_SITE_DISPLACE_ and ATOM_SITE_ROT_ categories.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITES_AXES
    _category_key.name            '_atom_sites_axes.matrix_seq_id'
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        loop_
         _atom_sites_axes.matrix_seq_id
         _atom_sites_axes.matrix
         _atom_sites_axes.transf_description
         1 [[-0.2197,0.1148,0.2739],[0.7997,0.0,0.0],[0.1594,0.4592,-0.1924]]
         ;
          a1 is along the line S--C(1)--C(4)--Cl.
          a2 is perpendicular to the C(1)--S--C(1)[-x+1/2, y, -z] plane.
          a3 is perpendicular to a2 and the b axis.
         ;
         2 [[1,0,0],[0,1,0],[0,0,1]]
         ;
          a1, a2 and a3 coincide with a, b and c but the displacements do not
          belong to the same Fourier series.
         ;

        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        F.J. Z\'u\~niga, J.M. P\'erez-Mato and T. Breczewski(1993)
        Acta Cryst. B49, 1060-1068. doi:10.1107/S0108768193008195
        Structure of the Incommensurate Phase of 4,4'-Dichlorobiphenyl Sulfone
        at 90 K
;

save_

save_atom_sites_axes.matrix

    _definition.id                '_atom_sites_axes.matrix'
    _definition.update            2019-04-01
    _description.text
;
      A 3x3 matrix, A, that relates the axes used to describe the atomic
      or molecular displacements to the crystallographic axes of the
      reference structure as follows:

                    (a1,a2,a3) = (a~r~,b~r~,c~r~) A

;
    _name.category_id             atom_sites_axes
    _name.object_id               matrix
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3,3]'
    _type.contents                Real
    _enumeration.default          [
                                   [1.0,0.0,0.0]  ,  [0.0,1.0,0.0]  ,
                                   [0.0,0.0,1.0]
                                  ]

save_

save_atom_sites_axes.matrix_seq_id

    _definition.id                '_atom_sites_axes.matrix_seq_id'
    _definition.update            2019-09-25
    _description.text
;
      A numeric code to identify each transformation matrix given
      in _atom_sites_axes.matrix.
;
    _name.category_id             atom_sites_axes
    _name.object_id               matrix_seq_id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_atom_sites_axes.transf_description

    _definition.id                '_atom_sites_axes.transf_description'
    _definition.update            2014-06-27
    _description.text
;
      The definition of the axes described by the transformation
      given by _atom_sites_axes.matrix.
;
    _name.category_id             atom_sites_axes
    _name.object_id               transf_description
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text
    _description_example.case
;
    a1 and a2 are respectively the long molecular axis and the axis normal
    to the mean molecular plane.
;

save_

save_ATOM_SITES_DISPLACE_FOURIER

    _definition.id                ATOM_SITES_DISPLACE_FOURIER
    _definition.scope             Category
    _definition.class             Set
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITES_DISPLACE_FOURIER category record
      details common to the displacive modulation of atom sites in a
      modulated structure.
      Details for individual atom sites are described by data items in
      the ATOM_SITE_DISPLACE_FOURIER category.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITES_DISPLACE_FOURIER

save_

save_atom_sites_displace_fourier.axes_description

    _definition.id
        '_atom_sites_displace_Fourier.axes_description'

    loop_
      _definition_replaced.id
      _definition_replaced.by
         1                        '_atom_site_displace_Fourier.matrix_seq_id'
         2                        '_atom_site_displace_Fourier.matrix'
         3                        '_atom_sites_axes.transf_description'

    _alias.definition_id
        '_atom_sites_displace_Fourier_axes_description'
    _definition.update            2024-07-27
    _description.text
;
      DEPRECATED. This data name should not be used. It has been replaced
      by the ATOM_SITES_AXES data names.

      The definition of the axes used for describing the displacive
      modulation, parameterized by Fourier series, when they are other
      than the crystallographic axes.
;
    _name.category_id             atom_sites_displace_Fourier
    _name.object_id               axes_description
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text
    _description_example.case
;
    a1 and a2 are respectively the long molecular axis and the axis normal
    to the mean molecular plane.
;

save_

save_ATOM_SITES_MODULATION

    _definition.id                ATOM_SITES_MODULATION
    _definition.scope             Category
    _definition.class             Set
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITES_MODULATION category record details
      common to the modulation of atom sites in a modulated structure.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITES_MODULATION

save_

save_atom_sites_modulation.global_phase_list

    _definition.id                '_atom_sites_modulation.global_phase_list'
    _definition.update            2024-08-06
    _description.text
;
      The initial phases, in cycles, of the modulation waves. For
      incommensurate structures they are irrelevant. However, they are
      essential for the description of commensurate structures within
      the superspace formalism, since they determine the space group
      of the commensurate superstructure [see Perez-Mato,
      Madariaga, Zu\~niga & Garcia Arribas (1987), van Smaalen (1995)
      or van Smaalen (2007)]. Note that for composites described
      using a single data block, the initial phases for each subsystem
      are derived using the W matrices (see _cell_subsystem.matrix_W_)
      from a unique set of global phases whose values are assigned to
      _atom_sites_modulation_global_phase_t_. Detailed information can
      be found in van Smaalen (1995).

      References: Perez-Mato, J. M., Madariaga, G., Zu\~niga, F. J.
                  & Garcia Arribas, A. (1987). Acta Cryst. A43, 216-226.
                  DOI 10.1107/S0108767387099537
                  On the structure and symmetry of incommensurate phases.
                  A practical formulation

                  Smaalen, S. van (1995). Crystallogr. Rev. 4, 79-202.
                  DOI 10.1080/08893119508039920
                  Incommensurate crystal structures.

                  Smaalen, S. van (2007). Incommensurate Crystallography.
                  International series of monographs on physics No 21.
                  Oxford University Press.
                  ISBN 9780198570820
;
    _name.category_id             atom_sites_modulation
    _name.object_id               'global_phase_list'
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Real
    _enumeration.default          [0.0]
    _units.code                   cycles
    _description_example.case
;
        #\#CIF_2.0

        # - - - - data truncated for brevity - - - -

        _cell.modulation_dimension               1

        loop_
         _cell_wave_vector.seq_id
         _cell_wave_vector.x
         _cell_wave_vector.y
         _cell_wave_vector.z
         1  0.250000  0.000000 -0.250000

        _atom_sites_modulation.global_phase_t_1            0.125

        # - - - - data truncated for brevity - - - -

        #=======================================================================

        Example based on the article:
        Noelia De La Pinta, Paul Benjamin Klar, Tomasz Breczewski & Gotzon
        Madariaga (2020)
        Crystal Growth & Design 20, 422-433. doi:10.1021/acs.cgd.9b01348
        Host Polytypism and Structural Modulation in Two-Dimensional
        Fe(NCS)~2~-Based Metal-Organic Frameworks: Can Spin-Crossover
        Transitions Be Predicted?
;

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With m  as  atom_sites_modulation

         temp.global_phase_list =
                                   [m.global_phase_t_1, m.global_phase_t_2,
                                    m.global_phase_t_3, m.global_phase_t_4,
                                    m.global_phase_t_5, m.global_phase_t_6,
                                    m.global_phase_t_7, m.global_phase_t_8,
                                    m.global_phase_t_7, m.global_phase_t_9]

          #Not meaningful indices are removed here

         _atom_sites_modulation.global_phase_list =
                   temp.global_phase_list[0:_cell.modulation_dimension -1 ]
;

save_

save_atom_sites_modulation.global_phase_t_1

    _definition.id                '_atom_sites_modulation.global_phase_t_1'

    loop_
      _alias.definition_id
         '_atom_sites_modulation_global_phase_t_1'
         '_jana_cell_commen_t_section_1'

    _definition.update            2024-08-06
    _description.text
;
     Initial phase component in _atom_sites_modulation.global_phase_list.
;
    _name.category_id             atom_sites_modulation
    _name.object_id               'global_phase_t_1'
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            -1.0:1.0
    _units.code                   cycles
    _method.purpose               Evaluation
    _method.expression
;
     With m  as  atom_sites_modulation

     _atom_sites_modulation.global_phase_t_1 = m.global_phase_list[0]
;

save_

save_atom_sites_modulation.global_phase_t_2

    _definition.id                '_atom_sites_modulation.global_phase_t_2'

    loop_
      _alias.definition_id
         '_atom_sites_modulation_global_phase_t_2'
         '_jana_cell_commen_t_section_2'

    _definition.update            2024-08-06
    _description.text
;
     Initial phase component in _atom_sites_modulation.global_phase_list.
;
    _name.category_id             atom_sites_modulation
    _name.object_id               'global_phase_t_2'
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            -1.0:1.0
    _enumeration.default          0.0
    _units.code                   cycles
    _method.purpose               Evaluation
    _method.expression
;
     With m  as  atom_sites_modulation

     _atom_sites_modulation.global_phase_t_2 = m.global_phase_list[1]
;

save_

save_atom_sites_modulation.global_phase_t_3

    _definition.id                '_atom_sites_modulation.global_phase_t_3'

    loop_
      _alias.definition_id
         '_atom_sites_modulation_global_phase_t_3'
         '_jana_cell_commen_t_section_3'

    _definition.update            2024-08-06
    _description.text
;
     Initial phase component in _atom_sites_modulation.global_phase_list.
;
    _name.category_id             atom_sites_modulation
    _name.object_id               'global_phase_t_3'
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            -1.0:1.0
    _units.code                   cycles
    _method.purpose               Evaluation
    _method.expression
;
     With m  as  atom_sites_modulation

     _atom_sites_modulation.global_phase_t_3 = m.global_phase_list[2]
;

save_

save_atom_sites_modulation.global_phase_t_4

    _definition.id                '_atom_sites_modulation.global_phase_t_4'
    _alias.definition_id          '_atom_sites_modulation_global_phase_t_4'
    _definition.update            2024-08-06
    _description.text
;
     Initial phase component in _atom_sites_modulation.global_phase_list.
;
    _name.category_id             atom_sites_modulation
    _name.object_id               'global_phase_t_4'
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            -1.0:1.0
    _units.code                   cycles
    _method.purpose               Evaluation
    _method.expression
;
     With m  as  atom_sites_modulation

     _atom_sites_modulation.global_phase_t_4 = m.global_phase_list[3]
;

save_

save_atom_sites_modulation.global_phase_t_5

    _definition.id                '_atom_sites_modulation.global_phase_t_5'
    _alias.definition_id          '_atom_sites_modulation_global_phase_t_5'
    _definition.update            2024-08-06
    _description.text
;
     Initial phase component in _atom_sites_modulation.global_phase_list.
;
    _name.category_id             atom_sites_modulation
    _name.object_id               'global_phase_t_5'
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            -1.0:1.0
    _units.code                   cycles
    _method.purpose               Evaluation
    _method.expression
;
     With m  as  atom_sites_modulation

     _atom_sites_modulation.global_phase_t_5 = m.global_phase_list[4]
;

save_

save_atom_sites_modulation.global_phase_t_6

    _definition.id                '_atom_sites_modulation.global_phase_t_6'
    _alias.definition_id          '_atom_sites_modulation_global_phase_t_6'
    _definition.update            2024-08-06
    _description.text
;
     Initial phase component in _atom_sites_modulation.global_phase_list.
;
    _name.category_id             atom_sites_modulation
    _name.object_id               'global_phase_t_6'
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            -1.0:1.0
    _units.code                   cycles
    _method.purpose               Evaluation
    _method.expression
;
     With m  as  atom_sites_modulation

     _atom_sites_modulation.global_phase_t_6 = m.global_phase_list[5]
;

save_

save_atom_sites_modulation.global_phase_t_7

    _definition.id                '_atom_sites_modulation.global_phase_t_7'
    _alias.definition_id          '_atom_sites_modulation_global_phase_t_7'
    _definition.update            2024-08-06
    _description.text
;
     Initial phase component in _atom_sites_modulation.global_phase_list.
;
    _name.category_id             atom_sites_modulation
    _name.object_id               'global_phase_t_7'
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            -1.0:1.0
    _units.code                   cycles
    _method.purpose               Evaluation
    _method.expression
;
     With m  as  atom_sites_modulation

     _atom_sites_modulation.global_phase_t_7 = m.global_phase_list[6]
;

save_

save_atom_sites_modulation.global_phase_t_8

    _definition.id                '_atom_sites_modulation.global_phase_t_8'
    _alias.definition_id          '_atom_sites_modulation_global_phase_t_8'
    _definition.update            2024-08-06
    _description.text
;
     Initial phase component in _atom_sites_modulation.global_phase_list.
;
    _name.category_id             atom_sites_modulation
    _name.object_id               'global_phase_t_8'
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            -1.0:1.0
    _units.code                   cycles
    _method.purpose               Evaluation
    _method.expression
;
     With m  as  atom_sites_modulation

     _atom_sites_modulation.global_phase_t_8 = m.global_phase_list[7]
;

save_

save_atom_sites_modulation.global_phase_t_9

    _definition.id                '_atom_sites_modulation.global_phase_t_9'
    _definition.update            2024-08-06
    _description.text
;
     Initial phase component in _atom_sites_modulation.global_phase_list.
;
    _name.category_id             atom_sites_modulation
    _name.object_id               'global_phase_t_9'
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            -1.0:1.0
    _units.code                   cycles
    _method.purpose               Evaluation
    _method.expression
;
     With m  as  atom_sites_modulation

     _atom_sites_modulation.global_phase_t_9 = m.global_phase_list[8]
;

save_

save_ATOM_SITES_ORTHO

    _definition.id                ATOM_SITES_ORTHO
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;

      Data items in the ATOM_SITES_ORTHO category record
      details about the orthogonalized functions defined to solve
      correlation problems during the refinement of the modulation
      parameters when the atomic domain of a given atom is restricted
      by a Crenel function (see Petricek et al., 2016).
      The functions are constructed selecting Fourier harmonics
      until a desired degree of orthogonality and completeness is
      reached (see_atom_site_occ_special_func.crenel_ortho_eps).

      References: Petricek, V., Van Der Lee & Evain, M. (1995).
                  Acta Cryst. A51, 529-535. DOI 10.1107/S0108767395000365
                  On the Use of Crenel Functions for Occupationally Modulated
                  Structures

                  Petricek, V., Eigner, V., Dusek, M. & Cejchan, A. (2016). Z.
                  Kristallogr. 231(5), 301-312. DOI 10.1515/zkri-2015-1913
                  Discontinuous modulation functions and their application for
                  analysis of modulated structures with the computing system
                  JANA2006

                  Petricek, V., Palatinus, L., Plasil, J. & Dusek, M.  (2023).
                  Z. Kristallogr. 238(7-8), 271-282.  DOI 10.1515/zkri-2023-0005
                  Jana2020 - a new version of the crystallographic computing
                  system Jana
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITES_ORTHO
    _category_key.name            '_atom_sites_ortho.func_id'
    _description_example.case
;
    #\#CIF_2.0

    # - - - - data truncated for brevity - - - -

    _cell.modulation_dimension               1

    loop_
     _cell_wave_vector.seq_id
     _cell_wave_vector.xyz
      1  [0.000000,0.234000,0.000000]

    # - - - - data truncated for brevity - - - -

    loop_
     _atom_site_Fourier_wave_vector.seq_id
     _atom_site_Fourier_wave_vector.q_coeff_seq_id
     _atom_site_Fourier_wave_vector.q_coeff
        0  [1]  [0]
        1  [1]  [1]
        2  [1]  [2]
        3  [1]  [3]
        4  [1]  [4]

    # - - - - data truncated for brevity - - - -

    loop_
     _atom_site_occ_special_func.atom_site_label
     _atom_site_occ_special_func.crenel_c
     _atom_site_occ_special_func.crenel_w
     Zn2  0.75   0.5
     Zn3  0.75   0.5

    # - - - - data truncated for brevity - - - -

    loop_
     _atom_sites_ortho.func_id
     _atom_sites_ortho.wave_vector_seq_id_list
     _atom_sites_ortho.coeff_cos_list
     _atom_sites_ortho.coeff_sin_list
     o1  [0,1]      [-3.322,0]        [0,4.323]
     o2  [0,1]      [-20.803,11.454]  [0,31.365]
     o3  [0,1]      [0.497,0]         [0,1.774]
     o4  [0,1]      [0,1.287]         [0,0]
     o5  [0,1,2]    [0,0.199,0]       [0,0,1.417]
     o6  [0,1,2]    [-0.870,0,2.020]  [0,-1.611,0]
     o7  [0,1]      [2.069,0]         [0,3.249]
     o8  [0,1]      [0,1.414]         [0,0]
     o9  [0,1,2]    [0,2.271,0]       [0,0,2.267]
     o10 [0,1,2]    [2.187,0,1.973]   [0,2.785,0]

    # - - - - data truncated for brevity - - - -

    #=======================================================================

    Example based on the article:
    Hanna Lind, Magnus Bostrom, Vaclav Petricek and Sven Lidin (2003)
    Acta Cryst. B59, 720-729. doi:10.1107/S0108768103019694
    Structure of \d~1~-CoZn~7.8~, an example of a phason pinning-unpinning
    transformation?
;

save_

save_atom_sites_ortho.coeff_cos_list

    _definition.id                '_atom_sites_ortho.coeff_cos_list'
    _definition.update            2019-04-01
    _description.text
;
      The list of cosine components of an orthogonalized function
      labeled by atom_sites_ortho.func_id corresponding to the wave
      vector list given by _atom_sites_ortho.wave_vector_seq_id_list
;
    _name.category_id             atom_sites_ortho
    _name.object_id               coeff_cos_list
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               List
    _type.dimension               '[]'
    _type.contents                Real
    _enumeration.default          [0.0]

save_

save_atom_sites_ortho.coeff_sin_list

    _definition.id                '_atom_sites_ortho.coeff_sin_list'
    _definition.update            2019-04-01
    _description.text
;
      The list of sine components of an orthogonalized function
      labeled by atom_sites_ortho.func_id corresponding to the wave
      vector list given by _atom_sites_ortho.wave_vector_seq_id_list
;
    _name.category_id             atom_sites_ortho
    _name.object_id               coeff_sin
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               List
    _type.dimension               '[]'
    _type.contents                Real
    _enumeration.default          [0.0]

save_

save_atom_sites_ortho.func_id

    _definition.id                '_atom_sites_ortho.func_id'
    _definition.update            2017-03-11
    _description.text
;
      A code that identifies an orthogonalized function or any
      of its components.
;
    _name.category_id             atom_sites_ortho
    _name.object_id               func_id
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code

save_

save_atom_sites_ortho.wave_vector_seq_id

    _definition.id                '_atom_sites_ortho.wave_vector_seq_id'
    _definition.update            2019-09-25
    _description.text
;
      A numeric code that identifies each of the harmonics chosen for the
      definition of an orthogonalized function. It links the wave vectors
      defined in the category ATOM_SITE_FOURIER_WAVE_VECTOR.
;
    _name.category_id             atom_sites_ortho
    _name.object_id               wave_vector_seq_id
    _name.linked_item_id          '_atom_site_Fourier_wave_vector.seq_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               Single
    _type.contents                Integer

save_

save_atom_sites_ortho.wave_vector_seq_id_list

    _definition.id                '_atom_sites_ortho.wave_vector_seq_id_list'
    _definition.update            2019-09-25
    _description.text
;
      A list of numeric codes that identifies the harmonics chosen for the
      definition of an orthogonalized function. It links the wave vectors
      defined in _atom_site_Fourier_wave_vector.*
;
    _name.category_id             atom_sites_ortho
    _name.object_id               wave_vector_seq_id_list
    _name.linked_item_id          '_atom_site_Fourier_wave_vector.seq_id'
    _type.purpose                 Link
    _type.source                  Related
    _type.container               List
    _type.dimension               '[]'
    _type.contents                Integer
    _enumeration.range            0:
    _enumeration.default          [0]

save_

save_ATOM_SITES_ROT_FOURIER

    _definition.id                ATOM_SITES_ROT_FOURIER
    _definition.scope             Category
    _definition.class             Set
    _definition.update            2024-08-09
    _description.text
;
      Data items in the ATOM_SITES_ROT_FOURIER category record
      details about the rotational component of the displacive
      modulation of a given rigid group as a whole.

      Details for individual atom sites are described by data items in
      the ATOM_SITES_ROT_FOURIER category.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               ATOM_SITES_ROT_FOURIER

save_

save_atom_sites_rot_fourier.axes_description

    _definition.id                '_atom_sites_rot_Fourier.axes_description'
    _alias.definition_id          '_atom_sites_rot_Fourier_axes_description'
    _definition.update            2014-06-27
    _description.text
;
      DEPRECATED. This data name should not be used. It has been replaced
      by the ATOM_SITES_AXES data names.

      The definition of the axes used for describing the rotational
      part of the displacive modulation of a given rigid group,
      parameterized by Fourier series, when they are other than the
      crystallographic axes.
;
    _name.category_id             atom_sites_rot_Fourier
    _name.object_id               axes_description
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text
    _description_example.case
;
    a1 and a2 are respectively the long molecular axis
    and the axis normal to the mean molecular plane.
;

save_

save_cell.commen_supercell_matrix

    _definition.id                '_cell.commen_supercell_matrix'
    _definition.update            2024-07-26
    _description.text
;
      For commensurately modulated structures the transformation, T,
      from the crystallographic axes of the reference structure
      to the supercell generated by the wave vectors expressed as

                (a~s~,b~s~,c~s~) = (a~r~,b~r~,c~r~)T,

      where (a~s~,b~s~,c~s~) and (a~r~,b~r~,c~r~) are the crystallographic
      axes of the supercell and the reference cell, respectively.
;
    _name.category_id             cell
    _name.object_id               commen_supercell_matrix
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3,3]'
    _type.contents                Integer
    _enumeration.default          [
                                   [1,0,0]  ,  [0,1,0]  ,  [0,0,1]
                                  ]
    _description_example.case
;
    #\#CIF_2.0

    _cell.modulation_dimension               1

    loop_
     _cell_wave_vector.seq_id
     _cell_wave_vector.x
     _cell_wave_vector.y
     _cell_wave_vector.z
     1  0.250000  0.000000 -0.250000

    _cell.commen_supercell_matrix  [[1,0,-3],[0,1,0],[1,0,1]]

    # - - - - data truncated for brevity - - - -

    #=======================================================================

    Example based on the article:
    Noelia De La Pinta, Paul Benjamin Klar, Tomasz Breczewski & Gotzon
    Madariaga (2020)
    Crystal Growth & Design 20, 422-433. doi:10.1021/acs.cgd.9b01348
    Host Polytypism and Structural Modulation in Two-Dimensional
    Fe(NCS)~2~-Based Metal-Organic Frameworks: Can Spin-Crossover
    Transitions Be Predicted?
;
    _method.purpose               Evaluation
    _method.expression
;

    With c as cell

    _cell.commen_supercell_matrix =
      [ [c.commen_supercell_matrix_1_1, c.commen_supercell_matrix_1_2,
        c.commen_supercell_matrix_1_3],
        [c.commen_supercell_matrix_1_1, c.commen_supercell_matrix_1_2,
        c.commen_supercell_matrix_1_3],
        [c.commen_supercell_matrix_1_1, c.commen_supercell_matrix_1_2,
        c.commen_supercell_matrix_1_3] ]
;

save_

save_cell.commen_supercell_matrix_1_1

    _definition.id                '_cell.commen_supercell_matrix_1_1'
    _alias.definition_id          '_jana_cell_commen_supercell_matrix_1_1'
    _definition.update            2024-07-26
    _description.text
;
     Element of _cell.commen_supercell_matrix.
;
    _name.category_id             cell
    _name.object_id               commen_supercell_matrix_1_1
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.default          1
    _method.purpose               Evaluation
    _method.expression
;
    With c as cell

    _cell.commen_supercell_matrix_1_1 = c.commen_supercell_matrix[0,0]
;

save_

save_cell.commen_supercell_matrix_1_2

    _definition.id                '_cell.commen_supercell_matrix_1_2'
    _alias.definition_id          '_jana_cell_commen_supercell_matrix_1_2'
    _definition.update            2024-07-26
    _description.text
;
     Element of _cell.commen_supercell_matrix.
;
    _name.category_id             cell
    _name.object_id               commen_supercell_matrix_1_2
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.default          0
    _method.purpose               Evaluation
    _method.expression
;
    With c as cell

    _cell.commen_supercell_matrix_1_2 = c.commen_supercell_matrix[0,1]
;

save_

save_cell.commen_supercell_matrix_1_3

    _definition.id                '_cell.commen_supercell_matrix_1_3'
    _alias.definition_id          '_jana_cell_commen_supercell_matrix_1_3'
    _definition.update            2024-07-26
    _description.text
;
     Element of _cell.commen_supercell_matrix.
;
    _name.category_id             cell
    _name.object_id               commen_supercell_matrix_1_3
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.default          0
    _method.purpose               Evaluation
    _method.expression
;
    With c as cell

    _cell.commen_supercell_matrix_1_3 = c.commen_supercell_matrix[0,2]
;

save_

save_cell.commen_supercell_matrix_2_1

    _definition.id                '_cell.commen_supercell_matrix_2_1'
    _alias.definition_id          '_jana_cell_commen_supercell_matrix_2_1'
    _definition.update            2024-07-26
    _description.text
;
     Element of _cell.commen_supercell_matrix.
;
    _name.category_id             cell
    _name.object_id               commen_supercell_matrix_2_1
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.default          0
    _method.purpose               Evaluation
    _method.expression
;
    With c as cell

    _cell.commen_supercell_matrix_2_1 = c.commen_supercell_matrix[1,0]
;

save_

save_cell.commen_supercell_matrix_2_2

    _definition.id                '_cell.commen_supercell_matrix_2_2'
    _alias.definition_id          '_jana_cell_commen_supercell_matrix_2_2'
    _definition.update            2024-07-26
    _description.text
;
     Element of _cell.commen_supercell_matrix.
;
    _name.category_id             cell
    _name.object_id               commen_supercell_matrix_2_2
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.default          1
    _method.purpose               Evaluation
    _method.expression
;
    With c as cell

    _cell.commen_supercell_matrix_2_2 = c.commen_supercell_matrix[1,1]
;

save_

save_cell.commen_supercell_matrix_2_3

    _definition.id                '_cell.commen_supercell_matrix_2_3'
    _alias.definition_id          '_jana_cell_commen_supercell_matrix_2_3'
    _definition.update            2024-07-26
    _description.text
;
     Element of _cell.commen_supercell_matrix.
;
    _name.category_id             cell
    _name.object_id               commen_supercell_matrix_2_3
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.default          0
    _method.purpose               Evaluation
    _method.expression
;
    With c as cell

    _cell.commen_supercell_matrix_2_3 = c.commen_supercell_matrix[1,2]
;

save_

save_cell.commen_supercell_matrix_3_1

    _definition.id                '_cell.commen_supercell_matrix_3_1'
    _alias.definition_id          '_jana_cell_commen_supercell_matrix_3_1'
    _definition.update            2024-07-26
    _description.text
;
     Element of _cell.commen_supercell_matrix.
;
    _name.category_id             cell
    _name.object_id               commen_supercell_matrix_3_1
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.default          0
    _method.purpose               Evaluation
    _method.expression
;
    With c as cell

    _cell.commen_supercell_matrix_3_1 = c.commen_supercell_matrix[2,0]
;

save_

save_cell.commen_supercell_matrix_3_2

    _definition.id                '_cell.commen_supercell_matrix_3_2'
    _alias.definition_id          '_jana_cell_commen_supercell_matrix_3_2'
    _definition.update            2024-07-26
    _description.text
;
     Element of _cell.commen_supercell_matrix.
;
    _name.category_id             cell
    _name.object_id               commen_supercell_matrix_3_2
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.default          0
    _method.purpose               Evaluation
    _method.expression
;
    With c as cell

    _cell.commen_supercell_matrix_3_2 = c.commen_supercell_matrix[2,1]
;

save_

save_cell.commen_supercell_matrix_3_3

    _definition.id                '_cell.commen_supercell_matrix_3_3'
    _alias.definition_id          '_jana_cell_commen_supercell_matrix_3_3'
    _definition.update            2024-07-26
    _description.text
;
     Element of _cell.commen_supercell_matrix.
;
    _name.category_id             cell
    _name.object_id               commen_supercell_matrix_3_3
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.default          1
    _method.purpose               Evaluation
    _method.expression
;
    With c as cell

    _cell.commen_supercell_matrix_3_3 = c.commen_supercell_matrix[2,2]
;

save_

save_cell.modulation_dimension

    _definition.id                '_cell.modulation_dimension'
    _alias.definition_id          '_cell_modulation_dimension'
    _definition.update            2019-09-25
    _description.text
;
      Number of additional reciprocal vectors needed to index the
      whole diffraction pattern using integer Miller indices. It must be
      present since its values determine the dimension of superspace.
;
    _name.category_id             cell
    _name.object_id               modulation_dimension
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            1:8

save_

save_cell.reciprocal_basis_description

    _definition.id                '_cell.reciprocal_basis_description'
    _alias.definition_id          '_cell_reciprocal_basis_description'
    _definition.update            2014-06-27
    _description.text
;
      Definition of the higher-dimensional basis with respect to which
      the Miller indices are defined. The three-dimensional basis used
      to index the additional wave vectors should be clearly indicated.
;
    _name.category_id             cell
    _name.object_id               reciprocal_basis_description
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text

    loop_
      _description_example.case
      _description_example.detail
;
         a*,b*,c* (reciprocal basis spanning the lattice of main
         reflections) and q (incommensurate with respect to a*,b*,c*)
;
;
         Typical choice for a one-dimensional incommensurate structure.
;
;
         The diffraction pattern can be indexed with four integers based
         on the reciprocal vectors a*~1~=a*~11~, a*~2~=a*~12~, a*~3~=a*~13~,
         a*~4~=a*~21~. a*~1j~ (j=1,2,3) index the main reflections of the 1st
         subsystem. a*~21~ is incommensurate with a*~11~.
;
;
         Common choice for a misfit layer compound composed of two subsystems
         that have in common two reciprocal vectors. Extracted from van Smaalen
         [Crystallogr. Rev. (1995), 4, 79-202].
;

save_

save_CELL_SUBSYSTEM

    _definition.id                CELL_SUBSYSTEM
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the CELL_SUBSYSTEM category record details about
      the crystallographic cell parameters of each subsystem present in
      a composite.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               CELL_SUBSYSTEM
    _category_key.name            '_cell_subsystem.code'
    _description_example.case
;
    #\#CIF_2.0

    # - - - - data truncated for brevity - - - -

    _cell.modulation_dimension               1

    loop_
     _cell_wave_vector.seq_id
     _cell_wave_vector.xyz
         1  [0,0,0.63646(11)]

    _atom_sites_modulation.global_phase_list
     [0.75]

    _cell_subsystems.number                  2

    loop_
     _cell_subsystem.code
     _cell_subsystem.description
     _cell_subsystem.matrix_W
      1 '1-st subsystem: CoO3'
      [[1,0,0,0,0,0,0,0,0,0,0],\
       [0,1,0,0,0,0,0,0,0,0,0],\
       [0,0,1,0,0,0,0,0,0,0,0],\
       [0,0,0,1,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0]]
      2 '2-nd subsystem: Sr'
      [[1,0,0,0,0,0,0,0,0,0,0],\
       [0,1,0,0,0,0,0,0,0,0,0],\
       [0,0,0,1,0,0,0,0,0,0,0],\
       [0,0,1,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0],\
       [0,0,0,0,0,0,0,0,0,0,0]]

    # - - - - data truncated for brevity - - - -

    #=======================================================================

    Example based on the article:
    O. Gourdon, V. Petricek, M. Dusek, P. Bezdicka, S.  Durovic, D. Gyepesovad
    and M. Evain (1999)
    Acta Cryst. B55, 841-848. doi:10.1107/S0108768199006485
    Determination of the modulated structure of Sr~14/11~CoO~3~ through a
    (3 + 1)-dimensional space description and using non-harmonic ADPs
;

save_

save_cell_subsystem.code

    _definition.id                '_cell_subsystem.code'
    _alias.definition_id          '_cell_subsystem_code'
    _definition.update            2014-06-27
    _description.text
;
      The code identifying uniquely a certain composite subsystem.
      This code is used to identify the data blocks that contain
      the structural information associated with the subsystem.
;
    _name.category_id             cell_subsystem
    _name.object_id               code
    _type.purpose                 Key
    _type.source                  Related
    _type.container               Single
    _type.contents                Code
    _description_example.case     NbS2

save_

save_cell_subsystem.description

    _definition.id                '_cell_subsystem.description'
    _alias.definition_id          '_cell_subsystem_description'
    _definition.update            2014-06-27
    _description.text
;
      Description of each subsystem defining a composite structurally.
      The number of definitions must match the number given in
      _cell_subsystems_number.
;
    _name.category_id             cell_subsystem
    _name.object_id               description
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text
    _description_example.case
        'NbS2 part of the layer compound (LaS)~1.14~NbS~2~'

save_

save_cell_subsystem.matrix_w

    _definition.id                '_cell_subsystem.matrix_W'
    _definition.update            2024-08-06
    _description.text
;
      In the case of composites, for each subsystem the matrix W as
      defined in van Smaalen (1991);  [see also van Smaalen (1995) or
      van Smaalen (2012)].
      Its dimension must match
      (_cell_modulation_dimension+3)*(_cell_modulation_dimension+3).

      Intergrowth compounds are composed of several periodic
      substructures in which the reciprocal lattices of two different
      subsystems are incommensurate in at least one direction. The
      indexing of the whole diffraction diagram with integer indices
      requires more than three reciprocal basic vectors. However, the
      distinction between main reflections and satellites is not as
      obvious as in normal incommensurate structures. Indeed, true
      satellites are normally difficult to locate for composites and
      the modulation wave vectors are reciprocal vectors of the
      other subsystem(s) referred to the reciprocal basis of one
      of them. The choice of the enlarged reciprocal basis
      {a*, b*, c*, q~1~,..., q~d~} is completely arbitrary, but
      the reciprocal basis of each subsystem is always known through
      the W matrices. These matrices [(3+d)x(3+d)-dimensional], one for
      each subsystem, can be blocked as follows:

                        (W^\n^~33~    W^\n^~3d~)
                 W^\n^= (                    )
                        (W^\n^~d3~    W^\n^~dd~)

      the dimension of each block being (3x3), (3xd), (dx3) and (dxd)
      for W^\n^~33~, W^\n^~3d~,W^\n^~d3~ and W^\n^~dd~, respectively.
      For example, the blocks W^\n^~3~ and W^\n^~3d~ [with global
      dimension 3x(3+d)] expresses the reciprocal basis of each subsystem
      in terms of the basis {a*, b*, c*, q~1~ ,..., q~d~}. W^\n^ also
      gives the irrational components of the modulation wave vectors of
      each subsystem in its own three-dimensional reciprocal basis
      {a~\n~*, b~\n~*, c~\n~*} and the superspace group of a given
      subsystem from the unique superspace group of the composite.

      The structure of these materials is always described by a set of
      incommensurate structures, one for each subsystem. The atomic
      coordinates, modulation parameters and wave vectors used for
      describing the modulation(s) are always referred to the (direct
      or reciprocal) basis of each particular subsystem. Although
      expressing the structural results in the chosen common basis is
      possible (using the matrices W), it is less confusing to use
      this alternative description. Atomic coordinates are only
      referred to a common basis when interatomic distances are
      calculated. Usually, the reciprocal vectors {a*, b* and c*\}\
      span the lattice of main reflections of one of the subsystems and
      therefore its W matrix is the unit matrix.

      For composites described in a single data block using
      *_subsystem_code pointers, the cell parameters, the superspace
      group and the measured modulation wave vectors (see
      CELL_WAVE_VECTOR below) correspond to the reciprocal basis
      described in _cell_reciprocal_basis_description and coincide
      with the reciprocal basis of the specific subsystem (if any)
      whose W matrix is the unit matrix. The cell parameters and the
      symmetry of the remaining subsystems can be derived using the
      appropriate W matrices. In any case (single or multiblock CIF),
      the values assigned to the items describing the atomic parameters
      (including the wave vectors used to describe the modulations)
      are always the same and are referred to the basis of each
      particular subsystem. Such a basis will be explicitly given in a
      multiblock CIF or should be calculated (with the appropriate W
      matrix) in the case of a single block description of the
      composite.

      References: Smaalen, S. van (1991).
                  Phys. Rev. B, 43, 11330-11341.
                  DOI 10.1103/PhysRevB.43.11330
                  Symmetry of composite crystals

                  Smaalen, S. van (1995). Crystallogr. Rev. 4, 79-202.
                  DOI 10.1080/08893119508039920
                  Incommensurate crystal structures.

                  Smaalen, S. van (2007). Incommensurate crystallography
                  International series of monographs on physics No 21.
                  Oxford University Press.
                  ISBN 9780198570820
;
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Real

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension + 3,
                             c.modulation_dimension + 3]'
;
         Evaluation
;
         With  m  as  cell_subsystem

         temp_subsystem.matrix_W = [
         [ m.matrix_W_1_1 ,m.matrix_W_1_2  ,m.matrix_W_1_3  ,m.matrix_W_1_4   ,
           m.matrix_W_1_5 ,m.matrix_W_1_6  ,m.matrix_W_1_7  ,m.matrix_W_1_8   ,
           m.matrix_W_1_9 ,m.matrix_W_1_10 ,m.matrix_W_1_11 ,m.matrix_W_1_12] ,
         [ m.matrix_W_2_1 ,m.matrix_W_2_2  ,m.matrix_W_2_3  ,m.matrix_W_2_4   ,
           m.matrix_W_2_5 ,m.matrix_W_2_6  ,m.matrix_W_2_7  ,m.matrix_W_2_8   ,
           m.matrix_W_2_9 ,m.matrix_W_2_10 ,m.matrix_W_2_11 ,m.matrix_W_2_12] ,
         [ m.matrix_W_3_1 ,m.matrix_W_3_2  ,m.matrix_W_3_3  ,m.matrix_W_3_4   ,
           m.matrix_W_3_5 ,m.matrix_W_3_6  ,m.matrix_W_3_7  ,m.matrix_W_3_8   ,
           m.matrix_W_3_9 ,m.matrix_W_3_10 ,m.matrix_W_3_11 ,m.matrix_W_3_12] ,
         [ m.matrix_W_4_1 ,m.matrix_W_4_2  ,m.matrix_W_4_3  ,m.matrix_W_4_4   ,
           m.matrix_W_4_5 ,m.matrix_W_4_6  ,m.matrix_W_4_7  ,m.matrix_W_4_8   ,
           m.matrix_W_4_9 ,m.matrix_W_4_10 ,m.matrix_W_4_11 ,m.matrix_W_4_12] ,
         [ m.matrix_W_5_1 ,m.matrix_W_5_2  ,m.matrix_W_5_3  ,m.matrix_W_5_4   ,
           m.matrix_W_5_5 ,m.matrix_W_5_6  ,m.matrix_W_5_7  ,m.matrix_W_5_8   ,
           m.matrix_W_5_9 ,m.matrix_W_5_10 ,m.matrix_W_5_11 ,m.matrix_W_5_12] ,
         [ m.matrix_W_6_1 ,m.matrix_W_6_2  ,m.matrix_W_6_3  ,m.matrix_W_6_4   ,
           m.matrix_W_6_5 ,m.matrix_W_6_6  ,m.matrix_W_6_7  ,m.matrix_W_6_8   ,
           m.matrix_W_6_9 ,m.matrix_W_6_10 ,m.matrix_W_6_11 ,m.matrix_W_6_12] ,
         [ m.matrix_W_7_1 ,m.matrix_W_7_2  ,m.matrix_W_7_3  ,m.matrix_W_7_4   ,
           m.matrix_W_7_5 ,m.matrix_W_7_6  ,m.matrix_W_7_7  ,m.matrix_W_7_8   ,
           m.matrix_W_7_9 ,m.matrix_W_7_10 ,m.matrix_W_7_11 ,m.matrix_W_7_12] ,
         [ m.matrix_W_8_1 ,m.matrix_W_8_2  ,m.matrix_W_8_3  ,m.matrix_W_8_4   ,
           m.matrix_W_8_5 ,m.matrix_W_8_6  ,m.matrix_W_8_7  ,m.matrix_W_8_8   ,
           m.matrix_W_8_9 ,m.matrix_W_8_10 ,m.matrix_W_8_11 ,m.matrix_W_8_12] ,
         [ m.matrix_W_9_1 ,m.matrix_W_9_2  ,m.matrix_W_9_3  ,m.matrix_W_9_4   ,
           m.matrix_W_9_5 ,m.matrix_W_9_6  ,m.matrix_W_9_7  ,m.matrix_W_9_8   ,
           m.matrix_W_9_9 ,m.matrix_W_9_10 ,m.matrix_W_9_11 ,m.matrix_W_9_12] ,
         [ m.matrix_W_10_1,m.matrix_W_10_2 ,m.matrix_W_10_3 ,m.matrix_W_10_4  ,
           m.matrix_W_10_5,m.matrix_W_10_6 ,m.matrix_W_10_7 ,m.matrix_W_10_8  ,
           m.matrix_W_10_9,m.matrix_W_10_10,m.matrix_W_10_11,m.matrix_W_10_12],
         [ m.matrix_W_11_1,m.matrix_W_11_2 ,m.matrix_W_11_3 ,m.matrix_W_11_4  ,
           m.matrix_W_11_5,m.matrix_W_11_6 ,m.matrix_W_11_7 ,m.matrix_W_11_8  ,
           m.matrix_W_11_9,m.matrix_W_11_10,m.matrix_W_11_11,m.matrix_W_11_12],
         [ m.matrix_W_12_1,m.matrix_W_12_2 ,m.matrix_W_12_3 ,m.matrix_W_12_4  ,
           m.matrix_W_12_5,m.matrix_W_12_6 ,m.matrix_W_12_7 ,m.matrix_W_12_8  ,
           m.matrix_W_12_9,m.matrix_W_12_10,m.matrix_W_12_11,m.matrix_W_12_12] ]

         #Matrix dimension is adjusted here here

         _cell_subsystem.matrix_W =
         temp_subsystem.matrix_W[ 0:_cell.modulation_dimension + 2,
                                  0:_cell.modulation_dimension + 2 ]

;

save_

save_cell_subsystem.matrix_w_10_1

    _definition.id                '_cell_subsystem.matrix_W_10_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_1 = c.matrix_W[9,0]
;

save_

save_cell_subsystem.matrix_w_10_10

    _definition.id                '_cell_subsystem.matrix_W_10_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_10 = c.matrix_W[9,9]
;

save_

save_cell_subsystem.matrix_w_10_11

    _definition.id                '_cell_subsystem.matrix_W_10_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_11 = c.matrix_W[9,10]
;

save_

save_cell_subsystem.matrix_w_10_12

    _definition.id                '_cell_subsystem.matrix_W_10_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_12 = c.matrix_W[9,11]
;

save_

save_cell_subsystem.matrix_w_10_2

    _definition.id                '_cell_subsystem.matrix_W_10_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_2 = c.matrix_W[9,1]
;

save_

save_cell_subsystem.matrix_w_10_3

    _definition.id                '_cell_subsystem.matrix_W_10_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_3 = c.matrix_W[9,2]
;

save_

save_cell_subsystem.matrix_w_10_4

    _definition.id                '_cell_subsystem.matrix_W_10_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_4 = c.matrix_W[9,3]
;

save_

save_cell_subsystem.matrix_w_10_5

    _definition.id                '_cell_subsystem.matrix_W_10_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_5 = c.matrix_W[9,4]
;

save_

save_cell_subsystem.matrix_w_10_6

    _definition.id                '_cell_subsystem.matrix_W_10_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_6 = c.matrix_W[9,5]
;

save_

save_cell_subsystem.matrix_w_10_7

    _definition.id                '_cell_subsystem.matrix_W_10_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_7 = c.matrix_W[9,6]
;

save_

save_cell_subsystem.matrix_w_10_8

    _definition.id                '_cell_subsystem.matrix_W_10_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_8 = c.matrix_W[9,7]
;

save_

save_cell_subsystem.matrix_w_10_9

    _definition.id                '_cell_subsystem.matrix_W_10_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_10_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_10_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_10_9 = c.matrix_W[9,8]
;

save_

save_cell_subsystem.matrix_w_11_1

    _definition.id                '_cell_subsystem.matrix_W_11_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_1 = c.matrix_W[10,0]
;

save_

save_cell_subsystem.matrix_w_11_10

    _definition.id                '_cell_subsystem.matrix_W_11_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_10 = c.matrix_W[10,9]
;

save_

save_cell_subsystem.matrix_w_11_11

    _definition.id                '_cell_subsystem.matrix_W_11_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_11 = c.matrix_W[10,10]
;

save_

save_cell_subsystem.matrix_w_11_12

    _definition.id                '_cell_subsystem.matrix_W_11_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_12 = c.matrix_W[10,11]
;

save_

save_cell_subsystem.matrix_w_11_2

    _definition.id                '_cell_subsystem.matrix_W_11_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_2 = c.matrix_W[10,1]
;

save_

save_cell_subsystem.matrix_w_11_3

    _definition.id                '_cell_subsystem.matrix_W_11_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_3 = c.matrix_W[10,2]
;

save_

save_cell_subsystem.matrix_w_11_4

    _definition.id                '_cell_subsystem.matrix_W_11_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_4 = c.matrix_W[10,3]
;

save_

save_cell_subsystem.matrix_w_11_5

    _definition.id                '_cell_subsystem.matrix_W_11_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_5 = c.matrix_W[10,4]
;

save_

save_cell_subsystem.matrix_w_11_6

    _definition.id                '_cell_subsystem.matrix_W_11_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_6 = c.matrix_W[10,5]
;

save_

save_cell_subsystem.matrix_w_11_7

    _definition.id                '_cell_subsystem.matrix_W_11_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_7 = c.matrix_W[10,6]
;

save_

save_cell_subsystem.matrix_w_11_8

    _definition.id                '_cell_subsystem.matrix_W_11_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_8 = c.matrix_W[10,7]
;

save_

save_cell_subsystem.matrix_w_11_9

    _definition.id                '_cell_subsystem.matrix_W_11_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_11_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_11_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_11_9 = c.matrix_W[10,8]
;

save_

save_cell_subsystem.matrix_w_12_1

    _definition.id                '_cell_subsystem.matrix_W_12_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_1 = c.matrix_W[11,0]
;

save_

save_cell_subsystem.matrix_w_12_10

    _definition.id                '_cell_subsystem.matrix_W_12_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_10 = c.matrix_W[11,9]
;

save_

save_cell_subsystem.matrix_w_12_11

    _definition.id                '_cell_subsystem.matrix_W_12_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_11 = c.matrix_W[11,10]
;

save_

save_cell_subsystem.matrix_w_12_12

    _definition.id                '_cell_subsystem.matrix_W_12_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_12 = c.matrix_W[11,11]
;

save_

save_cell_subsystem.matrix_w_12_2

    _definition.id                '_cell_subsystem.matrix_W_12_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_2 = c.matrix_W[11,1]
;

save_

save_cell_subsystem.matrix_w_12_3

    _definition.id                '_cell_subsystem.matrix_W_12_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_3 = c.matrix_W[11,2]
;

save_

save_cell_subsystem.matrix_w_12_4

    _definition.id                '_cell_subsystem.matrix_W_12_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_4 = c.matrix_W[11,3]
;

save_

save_cell_subsystem.matrix_w_12_5

    _definition.id                '_cell_subsystem.matrix_W_12_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_5 = c.matrix_W[11,4]
;

save_

save_cell_subsystem.matrix_w_12_6

    _definition.id                '_cell_subsystem.matrix_W_12_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_6 = c.matrix_W[11,5]
;

save_

save_cell_subsystem.matrix_w_12_7

    _definition.id                '_cell_subsystem.matrix_W_12_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_7 = c.matrix_W[11,6]
;

save_

save_cell_subsystem.matrix_w_12_8

    _definition.id                '_cell_subsystem.matrix_W_12_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_8 = c.matrix_W[11,7]
;

save_

save_cell_subsystem.matrix_w_12_9

    _definition.id                '_cell_subsystem.matrix_W_12_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_12_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_12_9 = c.matrix_W[11,8]
;

save_

save_cell_subsystem.matrix_w_1_1

    _definition.id                '_cell_subsystem.matrix_W_1_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_1 = c.matrix_W[0,0]
;

save_

save_cell_subsystem.matrix_w_1_10

    _definition.id                '_cell_subsystem.matrix_W_1_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_10 = c.matrix_W[0,9]
;

save_

save_cell_subsystem.matrix_w_1_11

    _definition.id                '_cell_subsystem.matrix_W_1_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_11 = c.matrix_W[0,10]
;

save_

save_cell_subsystem.matrix_w_1_12

    _definition.id                '_cell_subsystem.matrix_W_1_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_12 = c.matrix_W[0,11]
;

save_

save_cell_subsystem.matrix_w_1_2

    _definition.id                '_cell_subsystem.matrix_W_1_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_2 = c.matrix_W[0,1]
;

save_

save_cell_subsystem.matrix_w_1_3

    _definition.id                '_cell_subsystem.matrix_W_1_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_3 = c.matrix_W[0,2]
;

save_

save_cell_subsystem.matrix_w_1_4

    _definition.id                '_cell_subsystem.matrix_W_1_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_4 = c.matrix_W[0,3]
;

save_

save_cell_subsystem.matrix_w_1_5

    _definition.id                '_cell_subsystem.matrix_W_1_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_5 = c.matrix_W[0,4]
;

save_

save_cell_subsystem.matrix_w_1_6

    _definition.id                '_cell_subsystem.matrix_W_1_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_6 = c.matrix_W[0,5]
;

save_

save_cell_subsystem.matrix_w_1_7

    _definition.id                '_cell_subsystem.matrix_W_1_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_7 = c.matrix_W[0,6]
;

save_

save_cell_subsystem.matrix_w_1_8

    _definition.id                '_cell_subsystem.matrix_W_1_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_8 = c.matrix_W[0,7]
;

save_

save_cell_subsystem.matrix_w_1_9

    _definition.id                '_cell_subsystem.matrix_W_1_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_1_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_1_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_1_9 = c.matrix_W[0,8]
;

save_

save_cell_subsystem.matrix_w_2_1

    _definition.id                '_cell_subsystem.matrix_W_2_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_1 = c.matrix_W[1,0]
;

save_

save_cell_subsystem.matrix_w_2_10

    _definition.id                '_cell_subsystem.matrix_W_2_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_10 = c.matrix_W[1,9]
;

save_

save_cell_subsystem.matrix_w_2_11

    _definition.id                '_cell_subsystem.matrix_W_2_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_11 = c.matrix_W[1,10]
;

save_

save_cell_subsystem.matrix_w_2_12

    _definition.id                '_cell_subsystem.matrix_W_2_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_12 = c.matrix_W[1,11]
;

save_

save_cell_subsystem.matrix_w_2_2

    _definition.id                '_cell_subsystem.matrix_W_2_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_2 = c.matrix_W[1,1]
;

save_

save_cell_subsystem.matrix_w_2_3

    _definition.id                '_cell_subsystem.matrix_W_2_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_3 = c.matrix_W[1,2]
;

save_

save_cell_subsystem.matrix_w_2_4

    _definition.id                '_cell_subsystem.matrix_W_2_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_4 = c.matrix_W[1,3]
;

save_

save_cell_subsystem.matrix_w_2_5

    _definition.id                '_cell_subsystem.matrix_W_2_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_5 = c.matrix_W[1,4]
;

save_

save_cell_subsystem.matrix_w_2_6

    _definition.id                '_cell_subsystem.matrix_W_2_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_6 = c.matrix_W[1,5]
;

save_

save_cell_subsystem.matrix_w_2_7

    _definition.id                '_cell_subsystem.matrix_W_2_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_7 = c.matrix_W[1,6]
;

save_

save_cell_subsystem.matrix_w_2_8

    _definition.id                '_cell_subsystem.matrix_W_2_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_8 = c.matrix_W[1,7]
;

save_

save_cell_subsystem.matrix_w_2_9

    _definition.id                '_cell_subsystem.matrix_W_2_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_2_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_2_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_2_9 = c.matrix_W[1,8]
;

save_

save_cell_subsystem.matrix_w_3_1

    _definition.id                '_cell_subsystem.matrix_W_3_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_1 = c.matrix_W[2,0]
;

save_

save_cell_subsystem.matrix_w_3_10

    _definition.id                '_cell_subsystem.matrix_W_3_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_10 = c.matrix_W[2,9]
;

save_

save_cell_subsystem.matrix_w_3_11

    _definition.id                '_cell_subsystem.matrix_W_3_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_11 = c.matrix_W[2,10]
;

save_

save_cell_subsystem.matrix_w_3_12

    _definition.id                '_cell_subsystem.matrix_W_3_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_12 = c.matrix_W[2,11]
;

save_

save_cell_subsystem.matrix_w_3_2

    _definition.id                '_cell_subsystem.matrix_W_3_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_2 = c.matrix_W[2,1]
;

save_

save_cell_subsystem.matrix_w_3_3

    _definition.id                '_cell_subsystem.matrix_W_3_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_3 = c.matrix_W[2,2]
;

save_

save_cell_subsystem.matrix_w_3_4

    _definition.id                '_cell_subsystem.matrix_W_3_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_4 = c.matrix_W[2,3]
;

save_

save_cell_subsystem.matrix_w_3_5

    _definition.id                '_cell_subsystem.matrix_W_3_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_5 = c.matrix_W[2,4]
;

save_

save_cell_subsystem.matrix_w_3_6

    _definition.id                '_cell_subsystem.matrix_W_3_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_6 = c.matrix_W[2,5]
;

save_

save_cell_subsystem.matrix_w_3_7

    _definition.id                '_cell_subsystem.matrix_W_3_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_7 = c.matrix_W[2,6]
;

save_

save_cell_subsystem.matrix_w_3_8

    _definition.id                '_cell_subsystem.matrix_W_3_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_8 = c.matrix_W[2,7]
;

save_

save_cell_subsystem.matrix_w_3_9

    _definition.id                '_cell_subsystem.matrix_W_3_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_3_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_3_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_3_9 = c.matrix_W[2,8]
;

save_

save_cell_subsystem.matrix_w_4_1

    _definition.id                '_cell_subsystem.matrix_W_4_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_1 = c.matrix_W[3,0]
;

save_

save_cell_subsystem.matrix_w_4_10

    _definition.id                '_cell_subsystem.matrix_W_4_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_10 = c.matrix_W[3,9]
;

save_

save_cell_subsystem.matrix_w_4_11

    _definition.id                '_cell_subsystem.matrix_W_4_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_11 = c.matrix_W[3,10]
;

save_

save_cell_subsystem.matrix_w_4_12

    _definition.id                '_cell_subsystem.matrix_W_4_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_12 = c.matrix_W[3,11]
;

save_

save_cell_subsystem.matrix_w_4_2

    _definition.id                '_cell_subsystem.matrix_W_4_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_2 = c.matrix_W[3,1]
;

save_

save_cell_subsystem.matrix_w_4_3

    _definition.id                '_cell_subsystem.matrix_W_4_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_3 = c.matrix_W[3,2]
;

save_

save_cell_subsystem.matrix_w_4_4

    _definition.id                '_cell_subsystem.matrix_W_4_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_4 = c.matrix_W[3,3]
;

save_

save_cell_subsystem.matrix_w_4_5

    _definition.id                '_cell_subsystem.matrix_W_4_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_5 = c.matrix_W[3,4]
;

save_

save_cell_subsystem.matrix_w_4_6

    _definition.id                '_cell_subsystem.matrix_W_4_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_6 = c.matrix_W[3,5]
;

save_

save_cell_subsystem.matrix_w_4_7

    _definition.id                '_cell_subsystem.matrix_W_4_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_7 = c.matrix_W[3,6]
;

save_

save_cell_subsystem.matrix_w_4_8

    _definition.id                '_cell_subsystem.matrix_W_4_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_8 = c.matrix_W[3,7]
;

save_

save_cell_subsystem.matrix_w_4_9

    _definition.id                '_cell_subsystem.matrix_W_4_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_4_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_4_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_4_9 = c.matrix_W[3,8]
;

save_

save_cell_subsystem.matrix_w_5_1

    _definition.id                '_cell_subsystem.matrix_W_5_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_1 = c.matrix_W[4,0]
;

save_

save_cell_subsystem.matrix_w_5_10

    _definition.id                '_cell_subsystem.matrix_W_5_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_10 = c.matrix_W[4,9]
;

save_

save_cell_subsystem.matrix_w_5_11

    _definition.id                '_cell_subsystem.matrix_W_5_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_11 = c.matrix_W[4,10]
;

save_

save_cell_subsystem.matrix_w_5_12

    _definition.id                '_cell_subsystem.matrix_W_5_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_12 = c.matrix_W[4,11]
;

save_

save_cell_subsystem.matrix_w_5_2

    _definition.id                '_cell_subsystem.matrix_W_5_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_2 = c.matrix_W[4,1]
;

save_

save_cell_subsystem.matrix_w_5_3

    _definition.id                '_cell_subsystem.matrix_W_5_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_3 = c.matrix_W[4,2]
;

save_

save_cell_subsystem.matrix_w_5_4

    _definition.id                '_cell_subsystem.matrix_W_5_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_4 = c.matrix_W[4,3]
;

save_

save_cell_subsystem.matrix_w_5_5

    _definition.id                '_cell_subsystem.matrix_W_5_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_5 = c.matrix_W[4,4]
;

save_

save_cell_subsystem.matrix_w_5_6

    _definition.id                '_cell_subsystem.matrix_W_5_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_6 = c.matrix_W[4,5]
;

save_

save_cell_subsystem.matrix_w_5_7

    _definition.id                '_cell_subsystem.matrix_W_5_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_7 = c.matrix_W[4,6]
;

save_

save_cell_subsystem.matrix_w_5_8

    _definition.id                '_cell_subsystem.matrix_W_5_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_8 = c.matrix_W[4,7]
;

save_

save_cell_subsystem.matrix_w_5_9

    _definition.id                '_cell_subsystem.matrix_W_5_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_5_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_5_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_5_9 = c.matrix_W[4,8]
;

save_

save_cell_subsystem.matrix_w_6_1

    _definition.id                '_cell_subsystem.matrix_W_6_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_1 = c.matrix_W[5,0]
;

save_

save_cell_subsystem.matrix_w_6_10

    _definition.id                '_cell_subsystem.matrix_W_6_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_10 = c.matrix_W[5,9]
;

save_

save_cell_subsystem.matrix_w_6_11

    _definition.id                '_cell_subsystem.matrix_W_6_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_11 = c.matrix_W[5,10]
;

save_

save_cell_subsystem.matrix_w_6_12

    _definition.id                '_cell_subsystem.matrix_W_6_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_12 = c.matrix_W[5,11]
;

save_

save_cell_subsystem.matrix_w_6_2

    _definition.id                '_cell_subsystem.matrix_W_6_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_2 = c.matrix_W[5,1]
;

save_

save_cell_subsystem.matrix_w_6_3

    _definition.id                '_cell_subsystem.matrix_W_6_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_3 = c.matrix_W[5,2]
;

save_

save_cell_subsystem.matrix_w_6_4

    _definition.id                '_cell_subsystem.matrix_W_6_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_4 = c.matrix_W[5,3]
;

save_

save_cell_subsystem.matrix_w_6_5

    _definition.id                '_cell_subsystem.matrix_W_6_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_5 = c.matrix_W[5,4]
;

save_

save_cell_subsystem.matrix_w_6_6

    _definition.id                '_cell_subsystem.matrix_W_6_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_6 = c.matrix_W[5,5]
;

save_

save_cell_subsystem.matrix_w_6_7

    _definition.id                '_cell_subsystem.matrix_W_6_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_7 = c.matrix_W[5,6]
;

save_

save_cell_subsystem.matrix_w_6_8

    _definition.id                '_cell_subsystem.matrix_W_6_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_8 = c.matrix_W[5,7]
;

save_

save_cell_subsystem.matrix_w_6_9

    _definition.id                '_cell_subsystem.matrix_W_6_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_6_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_6_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_6_9 = c.matrix_W[5,8]
;

save_

save_cell_subsystem.matrix_w_7_1

    _definition.id                '_cell_subsystem.matrix_W_7_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_1 = c.matrix_W[6,0]
;

save_

save_cell_subsystem.matrix_w_7_10

    _definition.id                '_cell_subsystem.matrix_W_7_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_10 = c.matrix_W[6,9]
;

save_

save_cell_subsystem.matrix_w_7_11

    _definition.id                '_cell_subsystem.matrix_W_7_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_11 = c.matrix_W[6,10]
;

save_

save_cell_subsystem.matrix_w_7_12

    _definition.id                '_cell_subsystem.matrix_W_7_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_12 = c.matrix_W[6,11]
;

save_

save_cell_subsystem.matrix_w_7_2

    _definition.id                '_cell_subsystem.matrix_W_7_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_2 = c.matrix_W[6,1]
;

save_

save_cell_subsystem.matrix_w_7_3

    _definition.id                '_cell_subsystem.matrix_W_7_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_3 = c.matrix_W[6,2]
;

save_

save_cell_subsystem.matrix_w_7_4

    _definition.id                '_cell_subsystem.matrix_W_7_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_4 = c.matrix_W[6,3]
;

save_

save_cell_subsystem.matrix_w_7_5

    _definition.id                '_cell_subsystem.matrix_W_7_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_5 = c.matrix_W[6,4]
;

save_

save_cell_subsystem.matrix_w_7_6

    _definition.id                '_cell_subsystem.matrix_W_7_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_6 = c.matrix_W[6,5]
;

save_

save_cell_subsystem.matrix_w_7_7

    _definition.id                '_cell_subsystem.matrix_W_7_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_7 = c.matrix_W[6,6]
;

save_

save_cell_subsystem.matrix_w_7_8

    _definition.id                '_cell_subsystem.matrix_W_7_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_8 = c.matrix_W[6,7]
;

save_

save_cell_subsystem.matrix_w_7_9

    _definition.id                '_cell_subsystem.matrix_W_7_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_7_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_7_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_7_9 = c.matrix_W[6,8]
;

save_

save_cell_subsystem.matrix_w_8_1

    _definition.id                '_cell_subsystem.matrix_W_8_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_1 = c.matrix_W[7,0]
;

save_

save_cell_subsystem.matrix_w_8_10

    _definition.id                '_cell_subsystem.matrix_W_8_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_10 = c.matrix_W[7,9]
;

save_

save_cell_subsystem.matrix_w_8_11

    _definition.id                '_cell_subsystem.matrix_W_8_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_11 = c.matrix_W[7,10]
;

save_

save_cell_subsystem.matrix_w_8_12

    _definition.id                '_cell_subsystem.matrix_W_8_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_12 = c.matrix_W[7,11]
;

save_

save_cell_subsystem.matrix_w_8_2

    _definition.id                '_cell_subsystem.matrix_W_8_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_2 = c.matrix_W[7,1]
;

save_

save_cell_subsystem.matrix_w_8_3

    _definition.id                '_cell_subsystem.matrix_W_8_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_3 = c.matrix_W[7,2]
;

save_

save_cell_subsystem.matrix_w_8_4

    _definition.id                '_cell_subsystem.matrix_W_8_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_4 = c.matrix_W[7,3]
;

save_

save_cell_subsystem.matrix_w_8_5

    _definition.id                '_cell_subsystem.matrix_W_8_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_5 = c.matrix_W[7,4]
;

save_

save_cell_subsystem.matrix_w_8_6

    _definition.id                '_cell_subsystem.matrix_W_8_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_6 = c.matrix_W[7,5]
;

save_

save_cell_subsystem.matrix_w_8_7

    _definition.id                '_cell_subsystem.matrix_W_8_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_7 = c.matrix_W[7,6]
;

save_

save_cell_subsystem.matrix_w_8_8

    _definition.id                '_cell_subsystem.matrix_W_8_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_8 = c.matrix_W[7,7]
;

save_

save_cell_subsystem.matrix_w_8_9

    _definition.id                '_cell_subsystem.matrix_W_8_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_8_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_8_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_8_9 = c.matrix_W[7,8]
;

save_

save_cell_subsystem.matrix_w_9_1

    _definition.id                '_cell_subsystem.matrix_W_9_1'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_1'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_1

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_1 = c.matrix_W[8,0]
;

save_

save_cell_subsystem.matrix_w_9_10

    _definition.id                '_cell_subsystem.matrix_W_9_10'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_10'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_10

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_10 = c.matrix_W[8,9]
;

save_

save_cell_subsystem.matrix_w_9_11

    _definition.id                '_cell_subsystem.matrix_W_9_11'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_11'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_11

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_11 = c.matrix_W[8,10]
;

save_

save_cell_subsystem.matrix_w_9_12

    _definition.id                '_cell_subsystem.matrix_W_9_12'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_12

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_12 = c.matrix_W[8,11]
;

save_

save_cell_subsystem.matrix_w_9_2

    _definition.id                '_cell_subsystem.matrix_W_9_2'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_2'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_2

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_2 = c.matrix_W[8,1]
;

save_

save_cell_subsystem.matrix_w_9_3

    _definition.id                '_cell_subsystem.matrix_W_9_3'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_3'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_3

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_3 = c.matrix_W[8,2]
;

save_

save_cell_subsystem.matrix_w_9_4

    _definition.id                '_cell_subsystem.matrix_W_9_4'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_4'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_4

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_4 = c.matrix_W[8,3]
;

save_

save_cell_subsystem.matrix_w_9_5

    _definition.id                '_cell_subsystem.matrix_W_9_5'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_5'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_5

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_5 = c.matrix_W[8,4]
;

save_

save_cell_subsystem.matrix_w_9_6

    _definition.id                '_cell_subsystem.matrix_W_9_6'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_6'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_6

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_6 = c.matrix_W[8,5]
;

save_

save_cell_subsystem.matrix_w_9_7

    _definition.id                '_cell_subsystem.matrix_W_9_7'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_7'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_7

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_7 = c.matrix_W[8,6]
;

save_

save_cell_subsystem.matrix_w_9_8

    _definition.id                '_cell_subsystem.matrix_W_9_8'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_8'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_8

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_8 = c.matrix_W[8,7]
;

save_

save_cell_subsystem.matrix_w_9_9

    _definition.id                '_cell_subsystem.matrix_W_9_9'
    _alias.definition_id          '_cell_subsystem_matrix_W_9_9'
    _name.category_id             cell_subsystem
    _name.object_id               matrix_W_9_9

    _import.get                   [{'file':templ_attr.cif  'save':matrix_w}]

    _method.purpose               Evaluation
    _method.expression
;
     With c  as  cell_subsystem

     _cell_subsystem.matrix_W_9_9 = c.matrix_W[8,8]
;

save_

save_CELL_SUBSYSTEMS

    _definition.id                CELL_SUBSYSTEMS
    _definition.scope             Category
    _definition.class             Set
    _definition.update            2016-11-17
    _description.text
;
      Data items in the CELL_SUBSYSTEMS category describe overall aspects
      of the subsystems present in a composite.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               CELL_SUBSYSTEMS

save_

save_cell_subsystems.number

    _definition.id                '_cell_subsystems.number'
    _alias.definition_id          '_cell_subsystems_number'
    _definition.update            2019-09-25
    _description.text
;
      The number of subsystems used to define the structural model of
      a composite structure.
;
    _name.category_id             cell_subsystems
    _name.object_id               number
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            2:

save_

save_CELL_WAVE_VECTOR

    _definition.id                CELL_WAVE_VECTOR
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the CELL_WAVE_VECTOR category list the
      independent modulation wave vectors q~i~. The diffraction
      vectors are indexed in the form
      ha*+kb*+lc*+sum~i~ (m~i~q~i~). sum~i~ is taken
      over all wave vectors. In this version of the dictionary, the
      index i has been restricted to be less than 9.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               CELL_WAVE_VECTOR
    _category_key.name            '_cell_wave_vector.seq_id'

save_

save_cell_wave_vector.seq_id

    _definition.id                '_cell_wave_vector.seq_id'
    _alias.definition_id          '_cell_wave_vector_seq_id'
    _definition.update            2019-09-25
    _description.text
;
      A numeric code to identify each independent wave vector. These
      codes define uniquely the reciprocal basis and, therefore,
      force the order of the Miller indices assigned to
      intensities, crystal faces etc.
;
    _name.category_id             cell_wave_vector
    _name.object_id               seq_id
    _type.purpose                 Key
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:
    _enumeration.default          1

save_

save_cell_wave_vector.x

    _definition.id                '_cell_wave_vector.x'
    _alias.definition_id          '_cell_wave_vector_x'
    _definition.update            2024-08-01
    _description.text
;
      Component of a wave vector along the reciprocal axis a^*^ of the
      reference structure.
;
    _name.category_id             cell_wave_vector
    _name.object_id               x
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  m  as  cell_wave_vector

                        _cell_wave_vector.x  =  m.xyz[0]
;

save_

save_cell_wave_vector.x_su

    _definition.id                '_cell_wave_vector.x_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _cell_wave_vector.x
;
    _name.category_id             cell_wave_vector
    _name.object_id               x_su
    _name.linked_item_id          '_cell_wave_vector.x'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_cell_wave_vector.xyz

    _definition.id                '_cell_wave_vector.xyz'
    _definition.update            2024-04-08
    _description.text
;
      Independent modulation wave vector(s) with which the whole
      diffraction pattern is indexed, expressed as fractions of the
      three reciprocal basis vectors of the reference structure. In
      the case of composites, the modulation wave vectors of each
      subsystem are expressed in terms of the reciprocal basis of its
      corresponding reference structure. Their number must match
      _cell_modulation_dimension. In the case of composites described
      in a single data block, the wave
      vectors are expressed in the three-dimensional basis chosen as
      reference in _cell.reciprocal_basis_description, which would
      correspond to the subsystem (if any) whose W matrix is the
      {(_cell.modulation_dimension + 3)*\
      (_cell.modulation_dimension + 3)} unit matrix. In this case,\
      the wave vectors used to describe the modulation of each
      subsystem are referred to their own reciprocal basis via the W
      matrices (for details see _cell_subsystem_matrix_W_ and
      _atom_site_Fourier_wave_vector_).
;
    _name.category_id             cell_wave_vector
    _name.object_id               xyz
    _type.purpose                 Measurand
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   none
    _method.purpose               Evaluation
    _method.expression
;
    With  m  as  cell_wave_vector

            _cell_wave_vector.xyz   =   [ m.x, m.y, m.z ]
;

save_

save_cell_wave_vector.xyz_su

    _definition.id                '_cell_wave_vector.xyz_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _cell_wave_vector.xyz
;
    _name.category_id             cell_wave_vector
    _name.object_id               xyz_su
    _name.linked_item_id          '_cell_wave_vector.xyz'
    _type.purpose                 SU
    _type.source                  Related
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   none

save_

save_cell_wave_vector.y

    _definition.id                '_cell_wave_vector.y'
    _alias.definition_id          '_cell_wave_vector_y'
    _definition.update            2024-08-01
    _description.text
;
      Component of a wave vector along the reciprocal axis b^*^ of the
      reference structure.
;
    _name.category_id             cell_wave_vector
    _name.object_id               y
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  m  as  cell_wave_vector

                        _cell_wave_vector.y  =  m.xyz[1]
;

save_

save_cell_wave_vector.y_su

    _definition.id                '_cell_wave_vector.y_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _cell_wave_vector.y
;
    _name.category_id             cell_wave_vector
    _name.object_id               y_su
    _name.linked_item_id          '_cell_wave_vector.y'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_cell_wave_vector.z

    _definition.id                '_cell_wave_vector.z'
    _alias.definition_id          '_cell_wave_vector_z'
    _definition.update            2024-08-01
    _description.text
;
      Component of a wave vector along the reciprocal axis c^*^ of the
      reference structure.
;
    _name.category_id             cell_wave_vector
    _name.object_id               z
    _units.code                   none

    _import.get
        [{'file':templ_attr.cif  'save':general_mod_param}]

    _method.purpose               Evaluation
    _method.expression
;
       With  m  as  cell_wave_vector

                        _cell_wave_vector.z  =  m.xyz[2]
;

save_

save_cell_wave_vector.z_su

    _definition.id                '_cell_wave_vector.z_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _cell_wave_vector.z
;
    _name.category_id             cell_wave_vector
    _name.object_id               z_su
    _name.linked_item_id          '_cell_wave_vector.z'
    _units.code                   none

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_CELL_WAVE_VECTORS

    _definition.id                CELL_WAVE_VECTORS
    _definition.scope             Category
    _definition.class             Set
    _definition.update            2024-08-09
    _description.text
;
      Data items in the CELL_WAVE_VECTORS category record overall details
      about the set of independent modulation wave vectors q~i~ and
      their measurement. The diffraction vectors are indexed in
      the form ha*+kb*+lc*+sum~i~ (m~i~q~i~). sum~i~ is taken
      over all wave vectors. In this version of the dictionary, the
      index i has been restricted to be less than 9.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               CELL_WAVE_VECTORS

save_

save_cell_wave_vectors.meas_details

    _definition.id                '_cell_wave_vectors.meas_details'
    _alias.definition_id          '_cell_wave_vectors_meas_details'
    _definition.update            2014-06-27
    _description.text
;
      Details about the method used to determine the independent
      modulation wave vector(s).
;
    _name.category_id             cell_wave_vectors
    _name.object_id               meas_details
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text

save_

save_cell_wave_vectors.pressure_max

    _definition.id                '_cell_wave_vectors.pressure_max'
    _alias.definition_id          '_cell_wave_vectors_pressure_max'
    _definition.update            2014-06-27
    _description.text
;
      The maximum value of the pressure in kilopascals defining the
      interval within which the modulation wave vector(s) were measured.
;
    _name.category_id             cell_wave_vectors
    _name.object_id               pressure_max
    _type.purpose                 Measurand
    _type.source                  Recorded
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   kilopascals

save_

save_cell_wave_vectors.pressure_max_su

    _definition.id                '_cell_wave_vectors.pressure_max_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _cell_wave_vectors.pressure_max
;
    _name.category_id             cell_wave_vectors
    _name.object_id               pressure_max_su
    _name.linked_item_id          '_cell_wave_vectors.pressure_max'
    _units.code                   kilopascals

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_cell_wave_vectors.pressure_min

    _definition.id                '_cell_wave_vectors.pressure_min'
    _alias.definition_id          '_cell_wave_vectors_pressure_min'
    _definition.update            2014-06-27
    _description.text
;
      The minimum value of the pressure in kilopascals defining the
      interval within which the modulation wave vector(s) were measured.
;
    _name.category_id             cell_wave_vectors
    _name.object_id               pressure_min
    _type.purpose                 Measurand
    _type.source                  Recorded
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   kilopascals

save_

save_cell_wave_vectors.pressure_min_su

    _definition.id                '_cell_wave_vectors.pressure_min_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _cell_wave_vectors.pressure_min
;
    _name.category_id             cell_wave_vectors
    _name.object_id               pressure_min_su
    _name.linked_item_id          '_cell_wave_vectors.pressure_min'
    _units.code                   kilopascals

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_cell_wave_vectors.temp_max

    _definition.id                '_cell_wave_vectors.temp_max'
    _alias.definition_id          '_cell_wave_vectors_temp_max'
    _definition.update            2014-06-27
    _description.text
;
      The maximum value of the temperature in kelvinsdefining the interval
      within which the modulation wave vector(s) were measured.
;
    _name.category_id             cell_wave_vectors
    _name.object_id               temp_max
    _type.purpose                 Measurand
    _type.source                  Recorded
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   kelvins

save_

save_cell_wave_vectors.temp_max_su

    _definition.id                '_cell_wave_vectors.temp_max_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _cell_wave_vectors.temp_max
;
    _name.category_id             cell_wave_vectors
    _name.object_id               temp_max_su
    _name.linked_item_id          '_cell_wave_vectors.temp_max'
    _units.code                   kelvins

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_cell_wave_vectors.temp_min

    _definition.id                '_cell_wave_vectors.temp_min'
    _alias.definition_id          '_cell_wave_vectors_temp_min'
    _definition.update            2014-06-27
    _description.text
;
      The minimum value of the temperature in kelvinsdefining the interval
      within which the modulation wave vector(s) were measured.
;
    _name.category_id             cell_wave_vectors
    _name.object_id               temp_min
    _type.purpose                 Measurand
    _type.source                  Recorded
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   kelvins

save_

save_cell_wave_vectors.temp_min_su

    _definition.id                '_cell_wave_vectors.temp_min_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _cell_wave_vectors.temp_min
;
    _name.category_id             cell_wave_vectors
    _name.object_id               temp_min_su
    _name.linked_item_id          '_cell_wave_vectors.temp_min'
    _units.code                   kelvins

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_cell_wave_vectors.variation

    _definition.id                '_cell_wave_vectors.variation'
    _alias.definition_id          '_cell_wave_vectors_variation'
    _definition.update            2014-06-27
    _description.text
;
      Details concerning the behaviour (and its experimental
      detection) of the wave vector(s) with temperature and/or
      pressure within the ranges specified by
      _cell_wave_vectors.pressure_max, _cell_wave_vectors.pressure_min,
      _cell_wave_vectors.temp_max and  _cell_wave_vectors.temp_min.
;
    _name.category_id             cell_wave_vectors
    _name.object_id               variation
    _type.purpose                 Describe
    _type.source                  Recorded
    _type.container               Single
    _type.contents                Text

save_

save_DIFFRN_REFLN

    _definition.id                DIFFRN_REFLN
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the DIFFRN_REFLN category record details about
      the intensities measured in the diffraction experiment. The
      DIFFRN_REFLN data items refer to individual intensity
      measurements and must be included in looped lists. (The
      DIFFRN_REFLNS data items specify the parameters that apply
      to all intensity measurements. The DIFFRN_REFLNS data items
      are not looped.) Data items in this category are extensions
      of the core CIF dictionary definitions to the indexing of
      diffraction intensities by higher-dimensional components.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               DIFFRN_REFLN

    loop_
      _category_key.name
         '_diffrn_refln.index_h'
         '_diffrn_refln.index_k'
         '_diffrn_refln.index_l'
         '_diffrn_refln.index_m_list'

save_

save_diffrn_refln.index_m_1

    _definition.id                '_diffrn_refln.index_m_1'
    _alias.definition_id          '_diffrn_refln_index_m_1'
    _name.category_id             diffrn_refln
    _name.object_id               index_m_1

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_refln

                   _diffrn_refln.index_m_1  =  r.index_m_list [0]
;

save_

save_diffrn_refln.index_m_2

    _definition.id                '_diffrn_refln.index_m_2'
    _alias.definition_id          '_diffrn_refln_index_m_2'
    _name.category_id             diffrn_refln
    _name.object_id               index_m_2

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_refln

                   _diffrn_refln.index_m_2  =  r.index_m_list [1]
;

save_

save_diffrn_refln.index_m_3

    _definition.id                '_diffrn_refln.index_m_3'
    _alias.definition_id          '_diffrn_refln_index_m_3'
    _name.category_id             diffrn_refln
    _name.object_id               index_m_3

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_refln

                   _diffrn_refln.index_m_3  =  r.index_m_list [2]
;

save_

save_diffrn_refln.index_m_4

    _definition.id                '_diffrn_refln.index_m_4'
    _alias.definition_id          '_diffrn_refln_index_m_4'
    _name.category_id             diffrn_refln
    _name.object_id               index_m_4

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_refln

                   _diffrn_refln.index_m_4  =  r.index_m_list [3]
;

save_

save_diffrn_refln.index_m_5

    _definition.id                '_diffrn_refln.index_m_5'
    _alias.definition_id          '_diffrn_refln_index_m_5'
    _name.category_id             diffrn_refln
    _name.object_id               index_m_5

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_refln

                   _diffrn_refln.index_m_5  =  r.index_m_list [4]
;

save_

save_diffrn_refln.index_m_6

    _definition.id                '_diffrn_refln.index_m_6'
    _alias.definition_id          '_diffrn_refln_index_m_6'
    _name.category_id             diffrn_refln
    _name.object_id               index_m_6

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_refln

                   _diffrn_refln.index_m_6  =  r.index_m_list [5]
;

save_

save_diffrn_refln.index_m_7

    _definition.id                '_diffrn_refln.index_m_7'
    _alias.definition_id          '_diffrn_refln_index_m_7'
    _name.category_id             diffrn_refln
    _name.object_id               index_m_7

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_refln

                   _diffrn_refln.index_m_7  =  r.index_m_list [6]
;

save_

save_diffrn_refln.index_m_8

    _definition.id                '_diffrn_refln.index_m_8'
    _alias.definition_id          '_diffrn_refln_index_m_8'
    _name.category_id             diffrn_refln
    _name.object_id               index_m_8

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_refln

                   _diffrn_refln.index_m_8  =  r.index_m_list [7]
;

save_

save_diffrn_refln.index_m_9

    _definition.id                '_diffrn_refln.index_m_9'
    _name.category_id             diffrn_refln
    _name.object_id               index_m_9

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_refln

                   _diffrn_refln.index_m_9  =  r.index_m_list [8]
;

save_

save_diffrn_refln.index_m_list

    _definition.id                '_diffrn_refln.index_m_list'
    _definition.update            2024-08-06
    _description.text
;
      Additional Miller indices needed to write the reciprocal vector
      of a certain reflection in the basis described in
      _cell_reciprocal_basis_description. Following the usual
      convention, such a vector would be expressed as

               H=h*a*+k*b*+l*c*+m1*q(1)+...+m9*q(9),

      where h,k,l are the usual _diffrn_refln.index_, and q(1)...q(9)
      represent the independent wave vectors given by
      _cell_wave_vector.xyz and identified by _cell_wave_vector.seq_id.
      Therefore, the total number of indices of a given reflection must
      match (_cell.modulation_dimension + 3) and the order of the
      additional indices must be consistent with the codes given in
      _cell_wave_vector.seq_id. These indices need not match
      _refln.index_m_list values if a transformation of the original
      measured cell has occurred.
;
    _name.category_id             diffrn_refln
    _name.object_id               index_m_list
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Integer

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With  r  as  diffrn_refln

           temp.index_m_list =
                  [ r.index_m_1, r.index_m_2, r.index_m_3, r.index_m_4,
                    r.index_m_5, r.index_m_6, r.index_m_7, r.index_m_8,
                    r.index_m_9 ]

         #Not meaningful indices are removed here

           _diffrn_refln.index_m_list =
                   temp.index_m_list[0:_cell.modulation_dimension - 1]

;

save_

save_diffrn_reflns.limit_index_m_1_max

    _definition.id                '_diffrn_reflns.limit_index_m_1_max'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_1_max'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_1_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_1_max  =  r.limit_index_m_max_list [0]
;

save_

save_diffrn_reflns.limit_index_m_1_min

    _definition.id                '_diffrn_reflns.limit_index_m_1_min'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_1_min'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_1_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_1_min  =  r.limit_index_m_min_list [0]
;

save_

save_diffrn_reflns.limit_index_m_2_max

    _definition.id                '_diffrn_reflns.limit_index_m_2_max'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_2_max'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_2_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_2_max  =  r.limit_index_m_max_list [1]
;

save_

save_diffrn_reflns.limit_index_m_2_min

    _definition.id                '_diffrn_reflns.limit_index_m_2_min'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_2_min'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_2_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_2_min  =  r.limit_index_m_min_list [1]
;

save_

save_diffrn_reflns.limit_index_m_3_max

    _definition.id                '_diffrn_reflns.limit_index_m_3_max'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_3_max'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_3_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_3_max  =  r.limit_index_m_max_list [2]
;

save_

save_diffrn_reflns.limit_index_m_3_min

    _definition.id                '_diffrn_reflns.limit_index_m_3_min'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_3_min'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_3_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_3_min  =  r.limit_index_m_min_list [2]
;

save_

save_diffrn_reflns.limit_index_m_4_max

    _definition.id                '_diffrn_reflns.limit_index_m_4_max'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_4_max'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_4_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_4_max  =  r.limit_index_m_max_list [3]
;

save_

save_diffrn_reflns.limit_index_m_4_min

    _definition.id                '_diffrn_reflns.limit_index_m_4_min'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_4_min'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_4_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_4_min  =  r.limit_index_m_min_list [3]
;

save_

save_diffrn_reflns.limit_index_m_5_max

    _definition.id                '_diffrn_reflns.limit_index_m_5_max'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_5_max'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_5_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_5_max  =  r.limit_index_m_max_list [4]
;

save_

save_diffrn_reflns.limit_index_m_5_min

    _definition.id                '_diffrn_reflns.limit_index_m_5_min'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_5_min'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_5_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_5_min  =  r.limit_index_m_min_list [4]
;

save_

save_diffrn_reflns.limit_index_m_6_max

    _definition.id                '_diffrn_reflns.limit_index_m_6_max'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_6_max'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_6_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_6_max  =  r.limit_index_m_max_list [5]
;

save_

save_diffrn_reflns.limit_index_m_6_min

    _definition.id                '_diffrn_reflns.limit_index_m_6_min'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_6_min'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_6_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_6_min  =  r.limit_index_m_min_list [5]
;

save_

save_diffrn_reflns.limit_index_m_7_max

    _definition.id                '_diffrn_reflns.limit_index_m_7_max'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_7_max'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_7_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_7_max  =  r.limit_index_m_max_list [6]
;

save_

save_diffrn_reflns.limit_index_m_7_min

    _definition.id                '_diffrn_reflns.limit_index_m_7_min'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_7_min'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_7_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_7_min  =  r.limit_index_m_min_list [6]
;

save_

save_diffrn_reflns.limit_index_m_8_max

    _definition.id                '_diffrn_reflns.limit_index_m_8_max'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_8_max'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_8_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_8_max  =  r.limit_index_m_max_list [7]
;

save_

save_diffrn_reflns.limit_index_m_8_min

    _definition.id                '_diffrn_reflns.limit_index_m_8_min'
    _alias.definition_id          '_diffrn_reflns_limit_index_m_8_min'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_8_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_8_min  =  r.limit_index_m_min_list [7]
;

save_

save_diffrn_reflns.limit_index_m_9_max

    _definition.id                '_diffrn_reflns.limit_index_m_9_max'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_9_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_9_max  =  r.limit_index_m_max_list [8]
;

save_

save_diffrn_reflns.limit_index_m_9_min

    _definition.id                '_diffrn_reflns.limit_index_m_9_min'
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_9_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_reflns

            _diffrn_reflns.limit_index_m_9_min  =  r.limit_index_m_min_list [8]
;

save_

save_diffrn_reflns.limit_index_m_max_list

    _definition.id                '_diffrn_reflns.limit_index_m_max_list'
    _definition.update            2024-08-06
    _description.text
;
      Maximum values of the additional Miller indices
      appearing in _diffrn_refln.index_m_list. The number of ranges must
      match _cell.modulation_dimension. The order of the additional
      indices must be consistent with the codes given in
      _cell.wave_vector_seq_id.
;
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_max_list
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Integer

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With  r  as  diffrn_reflns

         temp.limit_index_m_max_list =
                  [ r.limit_index_m_1_max, r.limit_index_m_2_max,
                    r.limit_index_m_3_max, r.limit_index_m_4_max,
                    r.limit_index_m_5_max, r.limit_index_m_6_max,
                    r.limit_index_m_7_max, r.limit_index_m_8_max,
                    r.limit_index_m_9_max ]

         #Not meaningful indices are removed here

         _diffrn_reflns.limit_index_m_max_list =
                   temp.limit_index_m_max_list[0:_cell.modulation_dimension - 1]
;

save_

save_diffrn_reflns.limit_index_m_min_list

    _definition.id                '_diffrn_reflns.limit_index_m_min_list'
    _definition.update            2024-08-06
    _description.text
;
      Minimum values of the additional Miller indices
      appearing in _diffrn_refln.index_m_list. The number of ranges must
      match _cell.modulation_dimension. The order of the additional
      indices must be consistent with the codes given in
      _cell.wave_vector_seq_id.
;
    _name.category_id             diffrn_reflns
    _name.object_id               limit_index_m_min_list
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Integer

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With  r  as  diffrn_reflns

         temp.limit_index_m_min_list =
                  [ r.limit_index_m_1_min, r.limit_index_m_2_min,
                    r.limit_index_m_3_min, r.limit_index_m_4_min,
                    r.limit_index_m_5_min, r.limit_index_m_6_min,
                    r.limit_index_m_7_min, r.limit_index_m_8_min,
                    r.limit_index_m_9_min ]

         #Not meaningful indices are removed here

         _diffrn_reflns.limit_index_m_min_list =
          temp.limit_index_m_min_list[0:_cell.modulation_dimension - 1]
;

save_

save_diffrn_reflns.satellite_order_max

    _definition.id                '_diffrn_reflns.satellite_order_max'
    _alias.definition_id          '_diffrn_reflns_satellite_order_max'
    _definition.update            2019-09-25
    _description.text
;
      Maximum order of observed satellites.
;
    _name.category_id             diffrn_reflns
    _name.object_id               satellite_order_max
    _type.purpose                 Number
    _type.source                  Derived
    _type.container               Single
    _type.contents                Integer
    _enumeration.range            0:

save_

save_DIFFRN_STANDARD_REFLN

    _definition.id                DIFFRN_STANDARD_REFLN
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the DIFFRN_STANDARD_REFLN category record
      details about the reflections treated as standards during the
      measurement of diffraction intensities. Note that these are the
      individual standard reflections, not the results of the analysis
      of the standard reflections. Data items in this category are
      extensions of  the core CIF dictionary definitions
      to the indexing of standard reflections by
      higher-dimensional components.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               DIFFRN_STANDARD_REFLN

    loop_
      _category_key.name
         '_diffrn_standard_refln.index_h'
         '_diffrn_standard_refln.index_k'
         '_diffrn_standard_refln.index_l'
         '_diffrn_standard_refln.index_m_list'

save_

save_diffrn_standard_refln.index_m_1

    _definition.id                '_diffrn_standard_refln.index_m_1'
    _alias.definition_id          '_diffrn_standard_refln_index_m_1'
    _name.category_id             diffrn_standard_refln
    _name.object_id               index_m_1

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_standard_refln

              _diffrn_standard_refln.index_m_1  =  r.index_m_list [0]
;

save_

save_diffrn_standard_refln.index_m_2

    _definition.id                '_diffrn_standard_refln.index_m_2'
    _alias.definition_id          '_diffrn_standard_refln_index_m_2'
    _name.category_id             diffrn_standard_refln
    _name.object_id               index_m_2

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_standard_refln

              _diffrn_standard_refln.index_m_2  =  r.index_m_list [1]
;

save_

save_diffrn_standard_refln.index_m_3

    _definition.id                '_diffrn_standard_refln.index_m_3'
    _alias.definition_id          '_diffrn_standard_refln_index_m_3'
    _name.category_id             diffrn_standard_refln
    _name.object_id               index_m_3

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_standard_refln

              _diffrn_standard_refln.index_m_3  =  r.index_m_list [2]
;

save_

save_diffrn_standard_refln.index_m_4

    _definition.id                '_diffrn_standard_refln.index_m_4'
    _alias.definition_id          '_diffrn_standard_refln_index_m_4'
    _name.category_id             diffrn_standard_refln
    _name.object_id               index_m_4

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_standard_refln

              _diffrn_standard_refln.index_m_4  =  r.index_m_list [3]
;

save_

save_diffrn_standard_refln.index_m_5

    _definition.id                '_diffrn_standard_refln.index_m_5'
    _alias.definition_id          '_diffrn_standard_refln_index_m_5'
    _name.category_id             diffrn_standard_refln
    _name.object_id               index_m_5

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_standard_refln

              _diffrn_standard_refln.index_m_5  =  r.index_m_list [4]
;

save_

save_diffrn_standard_refln.index_m_6

    _definition.id                '_diffrn_standard_refln.index_m_6'
    _alias.definition_id          '_diffrn_standard_refln_index_m_6'
    _name.category_id             diffrn_standard_refln
    _name.object_id               index_m_6

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_standard_refln

              _diffrn_standard_refln.index_m_6  =  r.index_m_list [5]
;

save_

save_diffrn_standard_refln.index_m_7

    _definition.id                '_diffrn_standard_refln.index_m_7'
    _alias.definition_id          '_diffrn_standard_refln_index_m_7'
    _name.category_id             diffrn_standard_refln
    _name.object_id               index_m_7

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_standard_refln

              _diffrn_standard_refln.index_m_7  =  r.index_m_list [6]
;

save_

save_diffrn_standard_refln.index_m_8

    _definition.id                '_diffrn_standard_refln.index_m_8'
    _alias.definition_id          '_diffrn_standard_refln_index_m_8'
    _name.category_id             diffrn_standard_refln
    _name.object_id               index_m_8

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_standard_refln

              _diffrn_standard_refln.index_m_8  =  r.index_m_list [7]
;

save_

save_diffrn_standard_refln.index_m_9

    _definition.id                '_diffrn_standard_refln.index_m_9'
    _name.category_id             diffrn_standard_refln
    _name.object_id               index_m_9

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  diffrn_standard_refln

              _diffrn_standard_refln.index_m_9  =  r.index_m_list [8]
;

save_

save_diffrn_standard_refln.index_m_list

    _definition.id                '_diffrn_standard_refln.index_m_list'
    _definition.update            2024-08-06
    _description.text
;
      Additional Miller indices needed to write the reciprocal vectors
      of the standard intensities used in the diffraction measurement
      process, in the basis described in
      _cell.reciprocal_basis_description. The total number of indices
      of a given standard reflection must match
      (_cell.modulation_dimension + 3) and the order of the
      additional indices must be consistent with the codes given in
      _cell_wave_vector.seq_id.
;
    _name.category_id             diffrn_standard_refln
    _name.object_id               index_m_list
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Integer

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With  r  as  diffrn_standard_refln

         temp.index_m_list =
                  [ r.index_m_1, r.index_m_2, r.index_m_3, r.index_m_4,
                    r.index_m_5, r.index_m_6, r.index_m_7, r.index_m_8,
                    r.index_m_9 ]

         #Not meaningful indices are removed here

           _diffrn_standard_refln.index_m_list =
                  temp.index_m_list[0:_cell.modulation_dimension - 1]
;

save_

save_exptl_crystal.type_of_structure

    _definition.id                '_exptl_crystal.type_of_structure'
    _alias.definition_id          '_exptl_crystal_type_of_structure'
    _definition.update            2014-06-27
    _description.text
;
     The type of structure. This is used to check the consistency of a
     CIF: the data blocks that are expected and/or certain characteristic
     parameters depend on whether the material is classified as crystalline
     (periodic in three dimensions), modulated or composite. It must be
     present for archiving purposes.
;
    _name.category_id             exptl_crystal
    _name.object_id               type_of_structure
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         cryst                    'crystalline structure'
         mod                      'modulated structure'
         comp                     'composite (misfit) structure'

    _enumeration.default          cryst

save_

save_exptl_crystal_face.index_m_1

    _definition.id                '_exptl_crystal_face.index_m_1'
    _alias.definition_id          '_exptl_crystal_face_index_m_1'
    _name.category_id             exptl_crystal_face
    _name.object_id               index_m_1

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  f  as  exptl_crystal_face

              _exptl_crystal_face.index_m_1  =  f.index_m_list [0]
;

save_

save_exptl_crystal_face.index_m_2

    _definition.id                '_exptl_crystal_face.index_m_2'
    _alias.definition_id          '_exptl_crystal_face_index_m_2'
    _name.category_id             exptl_crystal_face
    _name.object_id               index_m_2

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  f  as  exptl_crystal_face

              _exptl_crystal_face.index_m_2  =  f.index_m_list [1]
;

save_

save_exptl_crystal_face.index_m_3

    _definition.id                '_exptl_crystal_face.index_m_3'
    _alias.definition_id          '_exptl_crystal_face_index_m_3'
    _name.category_id             exptl_crystal_face
    _name.object_id               index_m_3

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  f  as  exptl_crystal_face

              _exptl_crystal_face.index_m_3  =  f.index_m_list [2]
;

save_

save_exptl_crystal_face.index_m_4

    _definition.id                '_exptl_crystal_face.index_m_4'
    _alias.definition_id          '_exptl_crystal_face_index_m_4'
    _name.category_id             exptl_crystal_face
    _name.object_id               index_m_4

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  f  as  exptl_crystal_face

              _exptl_crystal_face.index_m_4  =  f.index_m_list [3]
;

save_

save_exptl_crystal_face.index_m_5

    _definition.id                '_exptl_crystal_face.index_m_5'
    _alias.definition_id          '_exptl_crystal_face_index_m_5'
    _name.category_id             exptl_crystal_face
    _name.object_id               index_m_5

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  f  as  exptl_crystal_face

              _exptl_crystal_face.index_m_5  =  f.index_m_list [4]
;

save_

save_exptl_crystal_face.index_m_6

    _definition.id                '_exptl_crystal_face.index_m_6'
    _alias.definition_id          '_exptl_crystal_face_index_m_6'
    _name.category_id             exptl_crystal_face
    _name.object_id               index_m_6

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  f  as  exptl_crystal_face

              _exptl_crystal_face.index_m_6  =  f.index_m_list [5]
;

save_

save_exptl_crystal_face.index_m_7

    _definition.id                '_exptl_crystal_face.index_m_7'
    _alias.definition_id          '_exptl_crystal_face_index_m_7'
    _name.category_id             exptl_crystal_face
    _name.object_id               index_m_7

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  f  as  exptl_crystal_face

              _exptl_crystal_face.index_m_7  =  f.index_m_list [6]
;

save_

save_exptl_crystal_face.index_m_8

    _definition.id                '_exptl_crystal_face.index_m_8'
    _alias.definition_id          '_exptl_crystal_face_index_m_8'
    _name.category_id             exptl_crystal_face
    _name.object_id               index_m_8

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  f  as  exptl_crystal_face

              _exptl_crystal_face.index_m_8  =  f.index_m_list [7]
;

save_

save_exptl_crystal_face.index_m_9

    _definition.id                '_exptl_crystal_face.index_m_9'
    _name.category_id             exptl_crystal_face
    _name.object_id               index_m_9

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  f  as  exptl_crystal_face

              _exptl_crystal_face.index_m_9  =  f.index_m_list [8]
;

save_

save_exptl_crystal_face.index_m_list

    _definition.id                '_exptl_crystal_face.index_m_list'
    _definition.update            2024-08-06
    _description.text
;
      Additional Miller indices of the crystal face associated with the
      value _exptl_crystal_face_perp_dist when the face is indexed
      using a multidimensional scheme. The total number of indices must
      match (_cell.modulation_dimension + 3). The order of the indices
      must be consistent with the codes given in
      _cell_wave_vector.seq_id.
;
    _name.category_id             exptl_crystal_face
    _name.object_id               index_m_list
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Integer

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With  f  as  exptl_crystal_face

           temp.index_m_list  =
                  [ f.index_m_1, f.index_m_2, f.index_m_3, f.index_m_4,
                    f.index_m_5, f.index_m_6, f.index_m_7, f.index_m_8,
                    f.index_m_9 ]

         #Not meaningful indices are removed here

           _exptl_crystal_face.index_m_list =
                   temp.index_m_list[0:_cell.modulation_dimension - 1]
;

save_

save_function.crenel

    _definition.id                '_function.Crenel'
    _definition.update            2024-07-26
    _description.text
;
      The function:

                o = Crenel(c, w, x4)

      returns, 1 if x4 belongs to the interval [c-w/2,c+w/2], 0 otherwise.
      x4 is a particular value of the internal coordinate, c is the centre of a
      crenel function in internal space and w is its width. The use of this
      function is restricted to one-dimensional modulated structures.
;
    _name.category_id             function
    _name.object_id               Crenel
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _method.purpose               Evaluation
    _method.expression
;
    #     Function Crenel( c  :[Single, Real],
    #                      w  :[Single, Real],
    #                      x4 :[Single,Real] )
    #      {
    #
    #        Crenel = 0.0
    #
    #        If ( c-w/2.0 <= x4 and x4 <= c+w/2.0 ) Crenel = 1.0
    #
    #      }

    # Heavier alternative: only atom label and x4

      Function Crenel( atlab :[Single, Code],
                       x4    :[Single,Real] )
      {

        Crenel = -1.0  # Atom not in list of crenel modulation or
                       # null crenel width

        Loop o as atom_site_occ_special_func {

          If (atlab == o.atom_site_label and o.crenel_w != 0.0){

            Crenel = 0.0

            If ( o.crenel_c-o.crenel_w/2.0 <= x4 and
                                x4 <= o.crenel_c+o.crenel_w/2.0 ) Crenel = 1.0

            Break

          } # End of If

        }   # End of Loop

      }
;

save_

save_function.dsawtooth

    _definition.id                '_function.DSawtooth'
    _definition.update            2024-08-06
    _description.text
;
      The function:

                s = DSawtooth(a, c, w, x4)

      returns

                2* a * ((x4-c)/w)

      for x4 belonging to the interval [c-(w/2), c+(w/2)], where a is
      the array containing the the amplitudes (maximum displacements)
      along each crystallographic axis, w is the width of the
      sawtooth, x4 is a particular value of the internal coordinate
      and c is the centre of the function in internal space. The use
      of this function is restricted to one-dimensional modulated
      structures.
;
    _name.category_id             function
    _name.object_id               DSawtooth
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _method.purpose               Evaluation
    _method.expression
;
    #      Function dSawtooth( a  :[Matrix, Real] ,
    #                          c  :[Single, Real] ,
    #                          w  :[Single, Real] ,
    #                          x4 :[Single,Real] )
    #      {
    #
    #        dSawtooth = [0.0,0.0,0.0]
    #
    #        If ( c-w/2.0 <= x4 and x4 <= c+w/2.0 ) dSawtooth = 2*a*(x4-c)/w
    #
    #      }

    # Heavier alternative: only atom label and x4

      Function DSawtooth( atlab :[Single, Code],
                          x4    :[Single,Real] )
        {

    # Atom not in list of sawtooth modulation or null sawtooth width
        DSawtooth = [-1.0,-1.0,-1.0]

        Loop d as atom_site_displace_special_func {

          If (atlab == d.atom_site_label and d.sawtooth_w != 0.0){

            DSawtooth = [0.0,0.0,0.0]

            If ( d.sawtooth_c-d.sawtooth_w/2.0 <= x4 and
                                         x4 <= d.sawtooth_c+d.sawtooth_w/2.0 )

                 DSawtooth = 2*d.sawtooth_axyz*(x4- d.sawtooth_c)/d.sawtooth_w

            Break

          } # End of If

        }   # End of Loop

      }
;

save_

save_function.dzigzag

    _definition.id                '_function.DZigzag'
    _definition.update            2024-08-06
    _description.text
;
      The function:

                z = DZigzag(a, c, w, x4)

      returns

                2* a * ((x4-c)/w)

      for x4 belonging to the interval [c-(w/2), c+(w/2)] or

               -2* a * ((x4-c)/w)

      for x4 in the interval [c+1/2-(w/2), c+1/2+(w/2)]

      where a is the array containing the the amplitudes (maximum
      displacements) along each crystallographic axis, w is the width
      of the zigzag, x4 is a particular value of the internal
      coordinate and c is the centre of the function in internal
      space. The use of this function is restricted to one-dimensional
      modulated structures.
;
    _name.category_id             function
    _name.object_id               DZigzag
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _method.purpose               Evaluation
    _method.expression
;
    #      Function DZigzag( a  :[Matrix, Real] ,
    #                        c  :[Single, Real] ,
    #                        w  :[Single, Real] ,
    #                        x4 :[Single,Real] )
    #      {
    #
    #        DZigzag = [0.0,0.0,0.0]
    #
    #        If ( c-w/2.0 <= x4 and x4 <= c+w/2.0 ) DZigzag = 2*a*(x4-c)/w
    #
    #        Else if ( c+0.5-w/2.0 <= x4 and x4 <= c+0.5+w/2.0 )
    #              DZigzag = -2*a*(x4-c)/w
    #
    #
    #      }

    # Heavier alternative: only atom label and x4

      Function DZigzag( atlab :[Single, Code],
                        x4    :[Single,Real] )
      {

    # Atom not in list of sawtooth modulation or null zigzag width
        DZigzag = [-1.0,-1.0,-1.0]

        Loop d as atom_site_displace_special_func {

          If (atlab == d.atom_site_label and d.zigzag_w != 0.0){

            DZigzag = [0.0,0.0,0.0]

            If ( d.zigzag_c-d.zigzag_w/2.0 <= x4 and
                                            x4 <= d.zigzag_c+d.zigzag_w/2.0 )

                     DZigzag = 2*d.zigzag_axyz*(x4- d.zigzag_c)/d.zigzag_w

            Else if ( d.zigzag_c+0.5-d.zigzag_w/2.0 <= x4 and
                                        x4 <= d.zigzag_c+0.5+d.zigzag_w/2.0 )

                     DZigzag = -2*d.zigzag_axyz*(x4- d.zigzag_c)/d.zigzag_w

            Break

          } # End of If

        }   # End of Loop

      }
;

save_

save_function.rsawtooth

    _definition.id                '_function.Rsawtooth'
    _definition.update            2024-08-06
    _description.text
;
      The function:

                s = RSawtooth(a, c, w, x4)

      returns

                2* a * ((x4-c)/w)

      for x4 belonging to the interval [c-(w/2), c+(w/2)], where a is
      the array containing the the amplitudes (maximum rotations)
      around each crystallographic axis, w is the width of the
      sawtooth, x4 is a particular value of the internal coordinate
      and c is the centre of the function in internal space. The use
      of this function is restricted to one-dimensional modulated
      structures.
;
    _name.category_id             function
    _name.object_id               RSawtooth
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _method.purpose               Evaluation
    _method.expression
;
    #      Function RSawtooth( a  :[Matrix, Real] ,
    #                          c  :[Single, Real] ,
    #                          w  :[Single, Real] ,
    #                          x4 :[Single,Real] )
    #      {
    #
    #        RSawtooth = [0.0,0.0,0.0]
    #
    #        If ( c-w/2.0 <= x4 and x4 <= c+w/2.0 ) RSawtooth = 2*a*(x4-c)/w
    #
    #      }

    # Heavier alternative: only atom label and x4

      Function RSawtooth( atlab :[Single, Code],
                          x4    :[Single,Real] )
        {

    # Atom not in list of sawtooth modulation or null sawtooth width
        RSawtooth = [-1.0,-1.0,-1.0]

        Loop r as atom_site_rot_special_func {

          If (atlab == r.atom_site_label and r.sawtooth_w != 0.0){

            RSawtooth = [0.0,0.0,0.0]

            If ( r.sawtooth_c-r.sawtooth_w/2.0 <= x4 and
                                          x4 <= r.sawtooth_c+r.sawtooth_w/2.0 )

                 RSawtooth = 2*r.sawtooth_axyz*(x4- r.sawtooth_c)/r.sawtooth_w

            Break

          } # End of If

        }   # End of Loop

      }
;

save_

save_function.rzigzag

    _definition.id                '_function.RZigzag'
    _definition.update            2024-08-06
    _description.text
;
      The function:

                z = Zigzag(a, c, w, x4)

      returns

                2* a * ((x4-c)/w)

      for x4 belonging to the interval [c-(w/2), c+(w/2)] or

               -2* a * ((x4-c)/w)

      for x4 in the interval [c+1/2-(w/2), c+1/2+(w/2)]

      where a is the array containing the the amplitudes (maximum
      rotations) around each crystallographic axis, w is the width of
      the zigzag, x4 is a particular value of the internal coordinate
      and c is the centre of the function in internal space. The use
      of this function is restricted to one-dimensional modulated
      structures.
;
    _name.category_id             function
    _name.object_id               RZigzag
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _method.purpose               Evaluation
    _method.expression
;
    #      Function RZigzag( a  :[Matrix, Real] ,
    #                        c  :[Single, Real] ,
    #                        w  :[Single, Real] ,
    #                        x4 :[Single,Real] )
    #      {
    #
    #        RZigzag = [0.0,0.0,0.0]
    #
    #        If ( c-w/2.0 <= x4 and x4 <= c+w/2.0 ) RZigzag = 2*a*(x4-c)/w
    #
    #        Else if ( c+0.5-w/2.0 <= x4 and x4 <= c+0.5+w/2.0 )
    #             RZigzag = -2*a*(x4-c)/w
    #
    #
    #      }

    # Heavier alternative: only atom label and x4

      Function RZigzag( atlab :[Single, Code],
                        x4    :[Single,Real] )
      {

    # Atom not in list of sawtooth modulation or null zigzag width
        RZigzag = [-1.0,-1.0,-1.0]

        Loop r as atom_site_rot_special_func {

          If (atlab == r.atom_site_label and r.zigzag_w != 0.0){

            RZigzag = [0.0,0.0,0.0]

            If ( r.zigzag_c-r.zigzag_w/2.0 <= x4 and
                                            x4 <= r.zigzag_c+r.zigzag_w/2.0 )

                     RZigzag = 2*r.zigzag_axyz*(x4- r.zigzag_c)/r.zigzag_w

            Else if ( r.zigzag_c+0.5-r.zigzag_w/2.0 <= x4 and
                                        x4 <= r.zigzag_c+0.5+r.zigzag_w/2.0 )

                     RZigzag = -2*r.zigzag_axyz*(x4- r.zigzag_c)/r.zigzag_w

            Break

          } # End of If

        }   # End of Loop

      }
;

save_

save_GEOM_ANGLE

    _definition.id                GEOM_ANGLE
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the GEOM_ANGLE category record
      details about the bond angles, as calculated from the
      ATOM, CELL and SYMMETRY data. These extensions
      to the core CIF dictionary definitions record the maximum,
      minimum and average values of angles and extend the
      symmetry-operation code used in angle listings to the
      higher-dimensional superspace form. Many GEOM_ANGLE
      datanames are redefined due to the consequent change
      in the way that they are calculated, even if the
      calculation method is not explicit in either this
      dictionary or the core.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               GEOM_ANGLE

    loop_
      _category_key.name
         '_geom_angle.atom_site_label_1'
         '_geom_angle.atom_site_label_2'
         '_geom_angle.atom_site_label_3'
         '_geom_angle.site_ssg_symmetry_1'
         '_geom_angle.site_ssg_symmetry_2'
         '_geom_angle.site_ssg_symmetry_3'

    _description_example.case
;
    #\#CIF_2.0

    # - - - - data truncated for brevity - - - -

    loop_
     _geom_angle.atom_site_label_1
     _geom_angle.atom_site_label_2
     _geom_angle.atom_site_label_3
     _geom_angle.site_ssg_symmetry_1
     _geom_angle.site_ssg_symmetry_2
     _geom_angle.site_ssg_symmetry_3
     _geom_angle.value_av
     _geom_angle.value_min
     _geom_angle.value_max
     _geom_angle.publ_flag
     C02  C01  O09  .  .  .  118.6(3)  117.0(3)  119.7(3)  ?
     C02  C01  O10  .  .  .  116.8(3)  116.0(3)  117.7(3)  ?
     O09  C01  O10  .  .  .  124.7(3)  123.9(3)  125.5(4)  ?
     C01  C02  C03  .  .  .  119.1(3)  118.1(3)  119.7(3)  ?
     C01  C02  C07  .  .  .  122.4(3)  121.7(3)  123.1(3)  ?
     C03  C02  C07  .  .  .  118.5(3)  117.8(4)  119.4(3)  ?
     C02  C03  C04  .  .  .  121.6(3)  120.9(3)  122.3(3)  ?
     C03  C04  C05  .  .  .  118.1(4)  117.4(4)  118.9(4)  ?
     C04  C05  C06  .  .  .  122.6(4)  121.4(4)  124.1(4)  ?
     C04  C05  F08  .  .  .  118.9(4)  118.1(4)  119.4(4)  ?

    # - - - - data truncated for brevity - - - -

    #=======================================================================

    Example based on the article:
    Andreas Schonleber, Sander van Smaalen, Hans-Christoph Weiss and Andreas J.
    Kesel (2014) Acta Cryst. B70, 652-659. doi:10.1107/S2052520614007707
    N-H...O and C-H...F hydrogen bonds in the incommensurately modulated
    crystal structure of adamantan-1-ammonium 4-fluorobenzoate
;

save_

save_geom_angle.distances_av

    _definition.id                '_geom_angle.distances_av'
    _definition.update            2024-08-06
    _description.text
;
     The pair of average distances between sites 1 - 2 and 2 - 3.
;
    _name.category_id             geom_angle
    _name.object_id               distances_av
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[2]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_angle.distances_av_su

    _definition.id                '_geom_angle.distances_av_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _geom_angle.distances_av.
;
    _name.category_id             geom_angle
    _name.object_id               distances_av_su
    _name.linked_item_id          '_geom_angle.distances_av'
    _type.purpose                 SU
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[2]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_angle.distances_max

    _definition.id                '_geom_angle.distances_max'
    _definition.update            2024-08-06
    _description.text
;
     The pair of maximum distances between sites 1 - 2 and 2 - 3.
;
    _name.category_id             geom_angle
    _name.object_id               distances_max
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[2]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_angle.distances_max_su

    _definition.id                '_geom_angle.distances_max_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _geom_angle.distances_max.
;
    _name.category_id             geom_angle
    _name.object_id               distances_max_su
    _name.linked_item_id          '_geom_angle.distances_max'
    _type.purpose                 SU
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[2]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_angle.distances_min

    _definition.id                '_geom_angle.distances_min'
    _definition.update            2024-08-06
    _description.text
;
     The pair of minimum distances between sites 1 - 2 and 2 - 3.
;
    _name.category_id             geom_angle
    _name.object_id               distances_min
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[2]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_angle.distances_min_su

    _definition.id                '_geom_angle.distances_min_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _geom_angle.distances_min.
;
    _name.category_id             geom_angle
    _name.object_id               distances_min_su
    _name.linked_item_id          '_geom_angle.distances_min'
    _type.purpose                 SU
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[2]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_angle.site_ssg_symmetry_1

    _definition.id                '_geom_angle.site_ssg_symmetry_1'
    _alias.definition_id          '_geom_angle_site_ssg_symmetry_1'
    _name.category_id             geom_angle
    _name.object_id               site_ssg_symmetry_1

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_geom_angle.site_ssg_symmetry_2

    _definition.id                '_geom_angle.site_ssg_symmetry_2'
    _alias.definition_id          '_geom_angle_site_ssg_symmetry_2'
    _name.category_id             geom_angle
    _name.object_id               site_ssg_symmetry_2

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_geom_angle.site_ssg_symmetry_3

    _definition.id                '_geom_angle.site_ssg_symmetry_3'
    _alias.definition_id          '_geom_angle_site_ssg_symmetry_3'
    _name.category_id             geom_angle
    _name.object_id               site_ssg_symmetry_3

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_geom_angle.value_av

    _definition.id                '_geom_angle.value_av'
    _alias.definition_id          '_geom_angle_av'
    _definition.update            2024-05-05
    _description.text
;
      Average angle bounded by _geom_angle.atom_site_label_1,
      *_2, and *_3. The site at *_2 is at the apex of the angle.
;
    _name.category_id             geom_angle
    _name.object_id               value_av
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _units.code                   degrees

save_

save_geom_angle.value_av_su

    _definition.id                '_geom_angle.value_av_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_angle.value_av
;
    _name.category_id             geom_angle
    _name.object_id               value_av_su
    _name.linked_item_id          '_geom_angle.value_av'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_angle.value_max

    _definition.id                '_geom_angle.value_max'
    _alias.definition_id          '_geom_angle_max'
    _definition.update            2024-05-05
    _description.text
;
      Maximum angle bounded by _geom_angle.atom_site_label_1,
      *_2, and *_3. The site at *_2 is at the apex of the angle.
;
    _name.category_id             geom_angle
    _name.object_id               value_max
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _units.code                   degrees

save_

save_geom_angle.value_max_su

    _definition.id                '_geom_angle.value_max_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_angle.value_max
;
    _name.category_id             geom_angle
    _name.object_id               value_max_su
    _name.linked_item_id          '_geom_angle.value_max'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_angle.value_min

    _definition.id                '_geom_angle.value_min'
    _alias.definition_id          '_geom_angle_min'
    _definition.update            2024-05-05
    _description.text
;
      Minimum angle bounded by _geom_angle.atom_site_label_1,
      *_2, and *_3. The site at *_2 is at the apex of the angle.
;
    _name.category_id             geom_angle
    _name.object_id               value_min
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _units.code                   degrees

save_

save_geom_angle.value_min_su

    _definition.id                '_geom_angle.value_min_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_angle.value_min
;
    _name.category_id             geom_angle
    _name.object_id               value_min_su
    _name.linked_item_id          '_geom_angle.value_min'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_GEOM_BOND

    _definition.id                GEOM_BOND
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the GEOM_BOND category record
      details about bonds, as calculated from the
      ATOM, CELL and SYMMETRY data. This category extends the
      symmetry-operation code used in bond listings to the
      higher-dimensional superspace form and therefore
      redefines many datanames to reflect the changed
      method of distance calculation.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               GEOM_BOND

    loop_
      _category_key.name
         '_geom_bond.atom_site_label_1'
         '_geom_bond.atom_site_label_2'
         '_geom_bond.site_ssg_symmetry_1'
         '_geom_bond.site_ssg_symmetry_2'

    _description_example.case
;
    #\#CIF_2.0

    # - - - - data truncated for brevity - - - -

    loop_
     _geom_bond.atom_site_label_1
     _geom_bond.atom_site_label_2
     _geom_bond.site_ssg_symmetry_1
     _geom_bond.site_ssg_symmetry_2
     _geom_bond.distance_av
     _geom_bond.distance_min
     _geom_bond.distance_max
     _geom_bond.publ_flag
     Ba2a  O5b  .  9_5555    3.194(5)   2.861(5)   3.528(5)  ?
     Ba2a  O5b  .  10_5555   3.194(5)   2.861(5)   3.528(5)  ?
     Ba2a  O1b  .  .         2.898(9)   2.795(9)   3.000(9)  ?
     Ba2a  O1b  .  9_5555    2.733(9)   2.693(9)   2.774(9)  ?
     Ba2a  O3b  .  .         2.965(6)   2.830(6)   3.100(6)  ?
     Ba2a  O3b  .  9_5555    2.801(6)   2.720(6)   2.885(6)  ?
     Ba2a  O3b  .  2_5555    2.965(6)   2.830(6)   3.100(6)  ?
     Ba2a  O3b  .  10_5555   2.801(6)   2.720(6)   2.885(6)  ?
     Ba2a  O4a  .  5_5455    3.045(4)   2.808(8)   3.286(8)  ?
     Ba2b  O1a  .  6_5545    2.873(7)   2.807(9)   2.938(9)  ?
     Ba2b  O1a  .  14_5545   2.746(7)   2.691(9)   2.803(9)  ?

    # - - - - data truncated for brevity - - - -

    #=======================================================================

    Example based on the article:
    Heribert A. Graetsch, Chandra Shekar Pandey, Jurgen Schreuer,
    Manfred Burianek and Manfred Muhlberg (2014) Acta Cryst. B70, 743-749.
    doi:10.1107/S2052520614011676
    Incommensurate modulations of relaxor ferroelectric
    Ca~0.24~Ba~0.76~Nb~2~O~6~ (CBN24) and Ca~0.31~Ba~0.69~Nb~2~O~6~ (CBN31)
;

save_

save_geom_bond.distance_av

    _definition.id                '_geom_bond.distance_av'
    _alias.definition_id          '_geom_bond_distance_av'
    _definition.update            2014-06-27
    _description.text
;
      Average value of the intramolecular bond distance between the sites
      identified by *.atom_site_label_1 and *.atom_site_label_2.
;
    _name.category_id             geom_bond
    _name.object_id               distance_av
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_bond.distance_av_su

    _definition.id                '_geom_bond.distance_av_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_bond.distance_av
;
    _name.category_id             geom_bond
    _name.object_id               av_su
    _name.linked_item_id          '_geom_bond.distance_av'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_bond.distance_max

    _definition.id                '_geom_bond.distance_max'
    _alias.definition_id          '_geom_bond_distance_max'
    _definition.update            2014-06-27
    _description.text
;
      Maximum value of the intramolecular bond distance between the sites
      identified by *.atom_site_label_1 and *.atom_site_label_2.
;
    _name.category_id             geom_bond
    _name.object_id               distance_max
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_bond.distance_max_su

    _definition.id                '_geom_bond.distance_max_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_bond.distance_max
;
    _name.category_id             geom_bond
    _name.object_id               max_su
    _name.linked_item_id          '_geom_bond.distance_max'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_bond.distance_min

    _definition.id                '_geom_bond.distance_min'
    _alias.definition_id          '_geom_bond_distance_min'
    _definition.update            2014-06-27
    _description.text
;
      Minimum value of the intramolecular bond distance between the sites
      identified by *.atom_site_label_1 and *.atom_site_label_2.
;
    _name.category_id             geom_bond
    _name.object_id               distance_min
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_bond.distance_min_su

    _definition.id                '_geom_bond.distance_min_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_bond.distance_min
;
    _name.category_id             geom_bond
    _name.object_id               distance_min_su
    _name.linked_item_id          '_geom_bond.distance_min'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_bond.site_ssg_symmetry_1

    _definition.id                '_geom_bond.site_ssg_symmetry_1'
    _alias.definition_id          '_geom_bond_site_ssg_symmetry_1'
    _name.category_id             geom_bond
    _name.object_id               site_ssg_symmetry_1

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_geom_bond.site_ssg_symmetry_2

    _definition.id                '_geom_bond.site_ssg_symmetry_2'
    _alias.definition_id          '_geom_bond_site_ssg_symmetry_2'
    _name.category_id             geom_bond
    _name.object_id               site_ssg_symmetry_2

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_GEOM_CONTACT

    _definition.id                GEOM_CONTACT
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      The CATEGORY of data items used to specify the interatomic
      contact distances in the structural model. This category extends
      the symmetry-operation code used in bond listings to the
      higher-dimensional superspace form and therefore redefines many
      datanames to reflect the changed method of distance calculation.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               GEOM_CONTACT

    loop_
      _category_key.name
         '_geom_contact.atom_site_label_1'
         '_geom_contact.atom_site_label_2'
         '_geom_contact.site_ssg_symmetry_1'
         '_geom_contact.site_ssg_symmetry_2'

save_

save_geom_contact.distance_av

    _definition.id                '_geom_contact.distance_av'
    _alias.definition_id          '_geom_contact_distance_av'
    _definition.update            2014-06-27
    _description.text
;
      Average value of the intermolecular distance between the atomic
      sites identified by *.atom_site_label_1 and *.atom_site_label_2.
;
    _name.category_id             geom_contact
    _name.object_id               distance_av
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_contact.distance_av_su

    _definition.id                '_geom_contact.distance_av_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_contact.distance_av
;
    _name.category_id             geom_contact
    _name.object_id               av_su
    _name.linked_item_id          '_geom_contact.distance_av'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_contact.distance_max

    _definition.id                '_geom_contact.distance_max'
    _alias.definition_id          '_geom_contact_distance_max'
    _definition.update            2014-06-27
    _description.text
;
      Maximum value of the intermolecular distance between the atomic
      sites identified by *.atom_site_label_1 and *.atom_site_label_2.
;
    _name.category_id             geom_contact
    _name.object_id               distance_max
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_contact.distance_max_su

    _definition.id                '_geom_contact.distance_max_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_contact.distance_max
;
    _name.category_id             geom_contact
    _name.object_id               max_su
    _name.linked_item_id          '_geom_contact.distance_max'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_contact.distance_min

    _definition.id                '_geom_contact.distance_min'
    _alias.definition_id          '_geom_contact_distance_min'
    _definition.update            2014-06-27
    _description.text
;
      Minimum value of the intermolecular distance between the atomic
      sites identified by *.atom_site_label_1 and *.atom_site_label_2.
;
    _name.category_id             geom_contact
    _name.object_id               distance_min
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_contact.distance_min_su

    _definition.id                '_geom_contact.distance_min_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_contact.distance_min
;
    _name.category_id             geom_contact
    _name.object_id               distance_min_su
    _name.linked_item_id          '_geom_contact.distance_min'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_contact.site_ssg_symmetry_1

    _definition.id                '_geom_contact.site_ssg_symmetry_1'
    _alias.definition_id          '_geom_contact_site_ssg_symmetry_1'
    _name.category_id             geom_contact
    _name.object_id               site_ssg_symmetry_1

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_geom_contact.site_ssg_symmetry_2

    _definition.id                '_geom_contact.site_ssg_symmetry_2'
    _alias.definition_id          '_geom_contact_site_ssg_symmetry_2'
    _name.category_id             geom_contact
    _name.object_id               site_ssg_symmetry_2

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_GEOM_HBOND

    _definition.id                GEOM_HBOND
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
     The CATEGORY of data items used to specify the hydrogen bond
     distances in the structural model as derived from atomic sites. This
     category extends the symmetry-operation code used in bond listings
     to the higher-dimensional superspace form and therefore redefines many
     datanames to reflect the changed method of distance and angle
     calculation.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               GEOM_HBOND

    loop_
      _category_key.name
         '_geom_hbond.atom_site_label_D'
         '_geom_hbond.atom_site_label_H'
         '_geom_hbond.atom_site_label_A'
         '_geom_hbond.site_ssg_symmetry_D'
         '_geom_hbond.site_ssg_symmetry_H'
         '_geom_hbond.site_ssg_symmetry_A'

save_

save_geom_hbond.angle_dha_av

    _definition.id                '_geom_hbond.angle_DHA_av'
    _alias.definition_id          '_geom_hbond_angle_DHA_av'
    _definition.update            2024-07-31
    _description.text
;
     The average value of the angle subtended by the sites identified by
     the _geom_hbond key names.The hydrogen at site *_H is at the apex
     of the angle.
;
    _name.category_id             geom_hbond
    _name.object_id               angle_DHA_av
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.:180.
    _units.code                   degrees

save_

save_geom_hbond.angle_dha_av_su

    _definition.id                '_geom_hbond.angle_DHA_av_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.angle_DHA_av.
;
    _name.category_id             geom_hbond
    _name.object_id               angle_DHA_av_su
    _name.linked_item_id          '_geom_hbond.angle_DHA_av'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.angle_dha_max

    _definition.id                '_geom_hbond.angle_DHA_max'
    _alias.definition_id          '_geom_hbond_angle_DHA_max'
    _definition.update            2024-07-31
    _description.text
;
     The maximum value of the angle subtended by the sites identified by
     the _geom_hbond key names.The hydrogen at site *_H is at the apex
     of the angle.
;
    _name.category_id             geom_hbond
    _name.object_id               angle_DHA_max
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.:180.
    _units.code                   degrees

save_

save_geom_hbond.angle_dha_max_su

    _definition.id                '_geom_hbond.angle_DHA_max_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.angle_DHA_max.
;
    _name.category_id             geom_hbond
    _name.object_id               angle_DHA_max_su
    _name.linked_item_id          '_geom_hbond.angle_DHA_max'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.angle_dha_min

    _definition.id                '_geom_hbond.angle_DHA_min'
    _alias.definition_id          '_geom_hbond_angle_DHA_min'
    _definition.update            2024-07-31
    _description.text
;
     The minimum value of the angle subtended by the sites identified by
     the _geom_hbond key names.The hydrogen at site *_H is at the apex
     of the angle.
;
    _name.category_id             geom_hbond
    _name.object_id               angle_DHA_min
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.:180.
    _units.code                   degrees

save_

save_geom_hbond.angle_dha_min_su

    _definition.id                '_geom_hbond.angle_DHA_min_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.angle_DHA_min.
;
    _name.category_id             geom_hbond
    _name.object_id               angle_DHA_min_su
    _name.linked_item_id          '_geom_hbond.angle_DHA_min'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.distance_da_av

    _definition.id                '_geom_hbond.distance_DA_av'
    _alias.definition_id          '_geom_hbond_distance_DA_av'
    _definition.update            2024-07-31
    _description.text
;
     The average distance between the donor and acceptor sites in the
     hydrogen bond identified by the _geom_hbond key names.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DA_av
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_hbond.distance_da_av_su

    _definition.id                '_geom_hbond.distance_DA_av_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.distance_DA_av.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DA_av_su
    _name.linked_item_id          '_geom_hbond.distance_DA_av'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.distance_da_max

    _definition.id                '_geom_hbond.distance_DA_max'
    _alias.definition_id          '_geom_hbond_distance_DA_max'
    _definition.update            2024-07-31
    _description.text
;
     The maximum distance between the donor and acceptor sites in the
     hydrogen bond identified by the _geom_hbond key names.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DA_max
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_hbond.distance_da_max_su

    _definition.id                '_geom_hbond.distance_DA_max_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.distance_DA_max.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DA_max_su
    _name.linked_item_id          '_geom_hbond.distance_DA_max'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.distance_da_min

    _definition.id                '_geom_hbond.distance_DA_min'
    _alias.definition_id          '_geom_hbond_distance_DA_min'
    _definition.update            2024-07-31
    _description.text
;
     The minimum distance between the donor and acceptor sites in the
     hydrogen bond identified by the _geom_hbond key names.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DA_min
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_hbond.distance_da_min_su

    _definition.id                '_geom_hbond.distance_DA_min_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.distance_DA_min.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DA_min_su
    _name.linked_item_id          '_geom_hbond.distance_DA_min'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.distance_dh_av

    _definition.id                '_geom_hbond.distance_DH_av'
    _alias.definition_id          '_geom_hbond_distance_DH_av'
    _definition.update            2024-07-31
    _description.text
;
     The average distance between the donor and hydrogen sites in the
     hydrogen bond identified by the _geom_hbond key names.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DH_av
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_hbond.distance_dh_av_su

    _definition.id                '_geom_hbond.distance_DH_av_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.distance_DH_av.

;
    _name.category_id             geom_hbond
    _name.object_id               distance_DH_av_su
    _name.linked_item_id          '_geom_hbond.distance_DH_av'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.distance_dh_max

    _definition.id                '_geom_hbond.distance_DH_max'
    _alias.definition_id          '_geom_hbond_distance_DH_max'
    _definition.update            2024-07-31
    _description.text
;
     The maximum distance between the donor and hydrogen sites in the
     hydrogen bond identified by the _geom_hbond key names.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DH_max
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_hbond.distance_dh_max_su

    _definition.id                '_geom_hbond.distance_DH_max_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.distance_DH_max.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DH_max_su
    _name.linked_item_id          '_geom_hbond.distance_DH_max'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.distance_dh_min

    _definition.id                '_geom_hbond.distance_DH_min'
    _alias.definition_id          '_geom_hbond_distance_DH_min'
    _definition.update            2024-07-31
    _description.text
;
     The minimum distance between the donor and hydrogen sites in the
     hydrogen bond identified by the _geom_hbond key names.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DH_min
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_hbond.distance_dh_min_su

    _definition.id                '_geom_hbond.distance_DH_min_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.distance_DH_min.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_DH_min_su
    _name.linked_item_id          '_geom_hbond.distance_DH_min'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.distance_ha_av

    _definition.id                '_geom_hbond.distance_HA_av'
    _alias.definition_id          '_geom_hbond_distance_HA_av'
    _definition.update            2024-07-31
    _description.text
;
     The average distance between the hydrogen and acceptor sites in the
     hydrogen bond identified by the _geom_hbond key names.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_HA_av
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_hbond.distance_ha_av_su

    _definition.id                '_geom_hbond.distance_HA_av_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.distance_HA_av.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_HA_av_su
    _name.linked_item_id          '_geom_hbond.distance_HA_av'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.distance_ha_max

    _definition.id                '_geom_hbond.distance_HA_max'
    _alias.definition_id          '_geom_hbond_distance_max_av'
    _definition.update            2024-07-31
    _description.text
;
     The maximum distance between the hydrogen and acceptor sites in the
     hydrogen bond identified by the _geom_hbond key names.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_HA_max
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_hbond.distance_ha_max_su

    _definition.id                '_geom_hbond.distance_HA_max_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.distance_HA_max.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_HA_max_su
    _name.linked_item_id          '_geom_hbond.distance_HA_max'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.distance_ha_min

    _definition.id                '_geom_hbond.distance_HA_min'
    _alias.definition_id          '_geom_hbond_distance_min_av'
    _definition.update            2024-07-31
    _description.text
;
     The minimum distance between the hydrogen and acceptor sites in the
     hydrogen bond identified by the _geom_hbond key names.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_HA_min
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _units.code                   angstroms

save_

save_geom_hbond.distance_ha_min_su

    _definition.id                '_geom_hbond.distance_HA_min_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of the average angle given in
     _geom_hbond.distance_HA_min.
;
    _name.category_id             geom_hbond
    _name.object_id               distance_HA_min_su
    _name.linked_item_id          '_geom_hbond.distance_HA_min'
    _units.code                   angstroms

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_hbond.site_ssg_symmetry_a

    _definition.id                '_geom_hbond.site_ssg_symmetry_A'
    _alias.definition_id          '_geom_hbond_site_ssg_symmetry_A'
    _name.category_id             geom_hbond
    _name.object_id               site_ssg_symmetry_A

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_geom_hbond.site_ssg_symmetry_d

    _definition.id                '_geom_hbond.site_ssg_symmetry_D'
    _alias.definition_id          '_geom_hbond_site_ssg_symmetry_D'
    _name.category_id             geom_hbond
    _name.object_id               site_ssg_symmetry_D

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_geom_hbond.site_ssg_symmetry_h

    _definition.id                '_geom_hbond.site_ssg_symmetry_H'
    _alias.definition_id          '_geom_hbond_site_ssg_symmetry_H'
    _name.category_id             geom_hbond
    _name.object_id               site_ssg_symmetry_H

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_GEOM_TORSION

    _definition.id                GEOM_TORSION
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
     The CATEGORY of data items used to specify the torsion angles in the
     structural model as derived from the atomic sites. This category
     extends the symmetry-operation code used in bond listings to the
     higher-dimensional superspace form and therefore redefines many
     datanames to reflect the changed method of distance and angle
     calculation.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               GEOM_TORSION

    loop_
      _category_key.name
         '_geom_torsion.atom_site_label_1'
         '_geom_torsion.atom_site_label_2'
         '_geom_torsion.atom_site_label_3'
         '_geom_torsion.atom_site_label_4'
         '_geom_torsion.site_ssg_symmetry_1'
         '_geom_torsion.site_ssg_symmetry_2'
         '_geom_torsion.site_ssg_symmetry_3'
         '_geom_torsion.site_ssg_symmetry_4'

    _description_example.case
;
    #\#CIF_2.0

    # - - - - data truncated for brevity - - - -

    loop_
     _geom_torsion.atom_site_label_1
     _geom_torsion.atom_site_label_2
     _geom_torsion.atom_site_label_3
     _geom_torsion.atom_site_label_4
     _geom_torsion.site_ssg_symmetry_1
     _geom_torsion.site_ssg_symmetry_2
     _geom_torsion.site_ssg_symmetry_3
     _geom_torsion.site_ssg_symmetry_4
     _geom_torsion.angle_av
     _geom_torsion.angle_min
     _geom_torsion.angle_max
     O10  C01  C02  C04  .  .  .  .    0.8(3)     -9.8(3)    9.0(3)
     O09  C01  C02  C06  .  .  .  .    0.6(4)    -15.6(4)   15.1(4)
     O09  C01  C02  C04  .  .  .  .  -46.8(3)  -180.00(6)  179.6(3)
     O10  C01  C02  C06  .  .  .  .   -8.8(3)   -179.9(3)  179.4(3)

    # - - - - data truncated for brevity - - - -

    #=======================================================================

    Example based on the article:
    Andreas Schonleber, Sander van Smaalen, Hans-Christoph Weiss and Andreas J.
    Kesel (2014) Acta Cryst. B70, 652-659. doi:10.1107/S2052520614007707
    N-H...O and C-H...F hydrogen bonds in the incommensurately modulated
    crystal structure of adamantan-1-ammonium 4-fluorobenzoate
;

save_

save_geom_torsion.angle_av

    _definition.id                '_geom_torsion.angle_av'
    _alias.definition_id          '_geom_torsion_av'
    _definition.update            2024-05-05
    _description.text
;
     Average torsion angle bounded by the four atom sites
     identified by the _geom_torsion_atom_site_label_ codes.
     These must match labels specified as _atom_site.label
     in the atom list. The torsion-angle definition should
     be that of Klyne and Prelog (1960).
     Reference: Klyne, W. & Prelog, V. (1960).
                Experientia, 16, 521-523.
                Description of steric relationships across single bonds.
;
    _name.category_id             geom_torsion
    _name.object_id               angle_av
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _units.code                   degrees

save_

save_geom_torsion.angle_av_su

    _definition.id                '_geom_torsion.angle_av_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_torsion.angle_av
;
    _name.category_id             geom_torsion
    _name.object_id               angle_av_su
    _name.linked_item_id          '_geom_torsion.angle_av'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_torsion.angle_max

    _definition.id                '_geom_torsion.angle_max'
    _alias.definition_id          '_geom_torsion_max'
    _definition.update            2024-05-05
    _description.text
;
     Maximum torsion angle; see _geom_torsion.angle_av.
;
    _name.category_id             geom_torsion
    _name.object_id               angle_max
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _units.code                   degrees

save_

save_geom_torsion.angle_max_su

    _definition.id                '_geom_torsion.angle_max_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_torsion.angle_max
;
    _name.category_id             geom_torsion
    _name.object_id               angle_max_su
    _name.linked_item_id          '_geom_torsion.angle_max'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_torsion.angle_min

    _definition.id                '_geom_torsion.angle_min'
    _alias.definition_id          '_geom_torsion_min'
    _definition.update            2024-05-05
    _description.text
;
     Minimum torsion angle; see _geom_torsion.angle_av.
;
    _name.category_id             geom_torsion
    _name.object_id               angle_min
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Single
    _type.contents                Real
    _units.code                   degrees

save_

save_geom_torsion.angle_min_su

    _definition.id                '_geom_torsion.angle_min_su'
    _definition.update            2024-08-01
    _description.text
;
     Standard uncertainty of _geom_torsion.angle_min
;
    _name.category_id             geom_torsion
    _name.object_id               angle_min_su
    _name.linked_item_id          '_geom_torsion.angle_min'
    _units.code                   degrees

    _import.get                   [{'file':templ_attr.cif  'save':general_su}]

save_

save_geom_torsion.distances_av

    _definition.id                '_geom_torsion.distances_av'
    _definition.update            2024-08-06
    _description.text
;
     Average distances between sites 1 - 2, 2 - 3 and 3 - 4.
;
    _name.category_id             geom_torsion
    _name.object_id               distances_av
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_torsion.distances_av_su

    _definition.id                '_geom_torsion.distances_av_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _geom_torsion.distances_av.
;
    _name.category_id             geom_torsion
    _name.object_id               distances_av_su
    _name.linked_item_id          '_geom_torsion.distances_av'
    _type.purpose                 SU
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_torsion.distances_max

    _definition.id                '_geom_torsion.distances_max'
    _definition.update            2024-08-06
    _description.text
;
     Maximum distances between sites 1 - 2, 2 - 3 and 3 - 4.
;
    _name.category_id             geom_torsion
    _name.object_id               distances_max
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_torsion.distances_max_su

    _definition.id                '_geom_torsion.distances_max_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _geom_torsion.distances_max.
;
    _name.category_id             geom_torsion
    _name.object_id               distances_max_su
    _name.linked_item_id          '_geom_torsion.distances_max'
    _type.purpose                 SU
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_torsion.distances_min

    _definition.id                '_geom_torsion.distances_min'
    _definition.update            2024-08-06
    _description.text
;
     Maximum distances between sites 1 - 2, 2 - 3 and 3 - 4.
;
    _name.category_id             geom_torsion
    _name.object_id               distances_min
    _type.purpose                 Measurand
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_torsion.distances_min_su

    _definition.id                '_geom_torsion.distances_min_su'
    _definition.update            2024-08-06
    _description.text
;
     Standard uncertainty of _geom_torsion.distances_min.
;
    _name.category_id             geom_torsion
    _name.object_id               distances_min_su
    _name.linked_item_id          '_geom_torsion.distances_min'
    _type.purpose                 SU
    _type.source                  Derived
    _type.container               Matrix
    _type.dimension               '[3]'
    _type.contents                Real
    _units.code                   angstroms

save_

save_geom_torsion.site_ssg_symmetry_1

    _definition.id                '_geom_torsion.site_ssg_symmetry_1'
    _alias.definition_id          '_geom_torsion_site_ssg_symmetry_1'
    _name.category_id             geom_torsion
    _name.object_id               site_ssg_symmetry_1

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_geom_torsion.site_ssg_symmetry_2

    _definition.id                '_geom_torsion.site_ssg_symmetry_2'
    _alias.definition_id          '_geom_torsion_site_ssg_symmetry_2'
    _name.category_id             geom_torsion
    _name.object_id               site_ssg_symmetry_2

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_geom_torsion.site_ssg_symmetry_3

    _definition.id                '_geom_torsion.site_ssg_symmetry_3'
    _alias.definition_id          '_geom_torsion_site_ssg_symmetry_3'
    _name.category_id             geom_torsion
    _name.object_id               site_ssg_symmetry_3

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_geom_torsion.site_ssg_symmetry_4

    _definition.id                '_geom_torsion.site_ssg_symmetry_4'
    _alias.definition_id          '_geom_torsion_site_ssg_symmetry_4'
    _name.category_id             geom_torsion
    _name.object_id               site_ssg_symmetry_4

    _import.get
        [{'file':templ_attr.cif  'save':site_ssg_symmetry}]

save_

save_REFINE

    _definition.id                REFINE
    _definition.scope             Category
    _definition.class             Set
    _definition.update            2024-08-09
    _description.text
;
      Data items in the REFINE category record
      details about the structure refinement parameters. The
      new items in this category extend those of the core CIF
      dictionary and are specific to the refinement of
      modulated structures.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               REFINE

save_

save_refine.ls_mod_func_description

    _definition.id                '_refine.ls_mod_func_description'
    _alias.definition_id          '_refine_ls_mod_func_description'
    _definition.update            2014-06-27
    _description.text
;
      Types of modulation present in the structural model and their
      parameterization.
;
    _name.category_id             refine
    _name.object_id               ls_mod_func_description
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text
    _description_example.case     'Only displacive modulation. Fourier series.'
    _description_example.detail
;
    Modulation of atom S(1) described by a non-standard linear sawtooth
    function
;

save_

save_refine.ls_mod_hydrogen_treatment

    _definition.id                '_refine.ls_mod_hydrogen_treatment'
    _alias.definition_id          '_refine_ls_mod_hydrogen_treatment'
    _definition.update            2014-06-27
    _description.text
;
      Treatment of hydrogen-atom modulation parameters in refinement.
;
    _name.category_id             refine
    _name.object_id               ls_mod_hydrogen_treatment
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         refA
             'refined H-atom displacive modulation parameters only'
         refxyzA
             'refined H-atom coords and displacive modulation params only'
         refP
             'refined H-atom occupational modulation parameters only'
         refUP
             'refined H-atom U and occupational modulation parameters only'
         nomod
             'no modulation of H-atom parameters'

    _enumeration.default          nomod

save_

save_refine.ls_mod_overall_phason_coeff

    _definition.id                '_refine.ls_mod_overall_phason_coeff'
    _alias.definition_id          '_refine_ls_mod_overall_phason_coeff'
    _definition.update            2014-06-27
    _description.text
;
     Phason coefficient used to calculate the overall phason correction.
;
    _name.category_id             refine
    _name.object_id               ls_mod_overall_phason_coeff
    _type.purpose                 Measurand
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            0.0:
    _enumeration.default          0.0
    _units.code                   none

save_

save_refine.ls_mod_overall_phason_formula

    _definition.id                '_refine.ls_mod_overall_phason_formula'
    _alias.definition_id          '_refine_ls_mod_overall_phason_formula'
    _definition.update            2014-06-27
    _description.text
;
      The expression for the overall phason correction, if used.
;
    _name.category_id             refine
    _name.object_id               ls_mod_overall_phason_formula
    _type.purpose                 State
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

    loop_
      _enumeration_set.state
      _enumeration_set.detail
         Axe            'Axe, J. D. (1980). Phys. Rev. B, 21, 4181-4190.'
         Ovr            'Overhauser, A. W. (1971). Phys. Rev. B, 3, 3173-3182.'

save_

save_REFLN

    _definition.id                REFLN
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      Data items in the REFLN category record details about the
      reflections used to determine the ATOM_SITE data items.
      The REFLN data items refer to individual reflections and
      must be included in looped lists. The REFLNS data items
      specify the parameters that apply to all reflections. The
      REFLNS data items are not looped. Data items in this category
      are extensions of the core CIF dictionary definitions to the
      indexing of reflections used in the refinement by
      higher-dimensional components.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               REFLN

    loop_
      _category_key.name
         '_refln.index_h'
         '_refln.index_k'
         '_refln.index_l'
         '_refln.index_m_list'

save_

save_refln.index_m_1

    _definition.id                '_refln.index_m_1'
    _alias.definition_id          '_refln_index_m_1'
    _name.category_id             refln
    _name.object_id               index_m_1

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  refln

                   _refln.index_m_1  =  r.index_m_list [0]
;

save_

save_refln.index_m_2

    _definition.id                '_refln.index_m_2'
    _alias.definition_id          '_refln_index_m_2'
    _name.category_id             refln
    _name.object_id               index_m_2

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  refln

                   _refln.index_m_2  =  r.index_m_list [1]
;

save_

save_refln.index_m_3

    _definition.id                '_refln.index_m_3'
    _alias.definition_id          '_refln_index_m_3'
    _name.category_id             refln
    _name.object_id               index_m_3

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  refln

                   _refln.index_m_3  =  r.index_m_list [2]
;

save_

save_refln.index_m_4

    _definition.id                '_refln.index_m_4'
    _alias.definition_id          '_refln_index_m_4'
    _name.category_id             refln
    _name.object_id               index_m_4

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  refln

                   _refln.index_m_4  =  r.index_m_list [3]
;

save_

save_refln.index_m_5

    _definition.id                '_refln.index_m_5'
    _alias.definition_id          '_refln_index_m_5'
    _name.category_id             refln
    _name.object_id               index_m_5

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  refln

                   _refln.index_m_5  =  r.index_m_list [4]
;

save_

save_refln.index_m_6

    _definition.id                '_refln.index_m_6'
    _alias.definition_id          '_refln_index_m_6'
    _name.category_id             refln
    _name.object_id               index_m_6

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  refln

                   _refln.index_m_6  =  r.index_m_list [5]
;

save_

save_refln.index_m_7

    _definition.id                '_refln.index_m_7'
    _alias.definition_id          '_refln_index_m_7'
    _name.category_id             refln
    _name.object_id               index_m_7

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  refln

                   _refln.index_m_7  =  r.index_m_list [6]
;

save_

save_refln.index_m_8

    _definition.id                '_refln.index_m_8'
    _alias.definition_id          '_refln_index_m_8'
    _name.category_id             refln
    _name.object_id               index_m_8

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  refln

                   _refln.index_m_8  =  r.index_m_list [7]
;

save_

save_refln.index_m_9

    _definition.id                '_refln.index_m_9'
    _name.category_id             refln
    _name.object_id               index_m_9

    _import.get                   [{'file':templ_attr.cif  'save':ms_index}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  refln

                   _refln.index_m_9  =  r.index_m_list [8]
;

save_

save_refln.index_m_list

    _definition.id                '_refln.index_m_list'
    _definition.update            2024-08-06
    _description.text
;
      Additional Miller indices of a particular reflection in the basis
      described in _cell_reciprocal_basis_description. The total number
      of indices must match (_cell.modulation_dimension + 3). The
      order of the additional indices must be consistent with the codes
      given in _cell_wave_vector.seq_id.
;
    _name.category_id             refln
    _name.object_id               index_m_list
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Integer

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With  r  as  refln

         temp.index_m_list  =
                  [ r.index_m_1, r.index_m_2, r.index_m_3, r.index_m_4,
                    r.index_m_5, r.index_m_6, r.index_m_7, r.index_m_8,
                    r.index_m_9 ]

         #Not meaningful indices are removed here

           _refln.index_m_list =
                temp.index_m_list[0:_cell.modulation_dimension - 1]
;

save_

save_REFLNS

    _definition.id                REFLNS
    _definition.scope             Category
    _definition.class             Set
    _definition.update            2024-08-09
    _description.text
;
      Data items in the REFLNS category record details about the
      reflections used to determine the ATOM_SITE data items.
      The REFLN data items refer to individual reflections and
      must be included in looped lists. The REFLNS data items
      specify the parameters that apply to all reflections. The
      REFLNS data items are not looped. Data items in this category
      extend the core CIF dictionary definitions providing independent
      checks on the range of values recorded for each of the
      additional Miller indices given in the REFLN category.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               REFLNS

save_

save_reflns.limit_index_m_1_max

    _definition.id                '_reflns.limit_index_m_1_max'
    _alias.definition_id          '_reflns_limit_index_m_1_max'
    _name.category_id             reflns
    _name.object_id               limit_index_m_1_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_1_max  =  r.limit_index_m_max_list [0]
;

save_

save_reflns.limit_index_m_1_min

    _definition.id                '_reflns.limit_index_m_1_min'
    _alias.definition_id          '_reflns_limit_index_m_1_min'
    _name.category_id             reflns
    _name.object_id               limit_index_m_1_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_1_min  =  r.limit_index_m_min_list [0]
;

save_

save_reflns.limit_index_m_2_max

    _definition.id                '_reflns.limit_index_m_2_max'
    _alias.definition_id          '_reflns_limit_index_m_2_max'
    _name.category_id             reflns
    _name.object_id               limit_index_m_2_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_2_max  =  r.limit_index_m_max_list [1]
;

save_

save_reflns.limit_index_m_2_min

    _definition.id                '_reflns.limit_index_m_2_min'
    _alias.definition_id          '_reflns_limit_index_m_2_min'
    _name.category_id             reflns
    _name.object_id               limit_index_m_2_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_2_min  =  r.limit_index_m_min_list [1]
;

save_

save_reflns.limit_index_m_3_max

    _definition.id                '_reflns.limit_index_m_3_max'
    _alias.definition_id          '_reflns_limit_index_m_3_max'
    _name.category_id             reflns
    _name.object_id               limit_index_m_3_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_3_max  =  r.limit_index_m_max_list [2]
;

save_

save_reflns.limit_index_m_3_min

    _definition.id                '_reflns.limit_index_m_3_min'
    _alias.definition_id          '_reflns_limit_index_m_3_min'
    _name.category_id             reflns
    _name.object_id               limit_index_m_3_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_3_min  =  r.limit_index_m_min_list [2]
;

save_

save_reflns.limit_index_m_4_max

    _definition.id                '_reflns.limit_index_m_4_max'
    _alias.definition_id          '_reflns_limit_index_m_4_max'
    _name.category_id             reflns
    _name.object_id               limit_index_m_4_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_4_max  =  r.limit_index_m_max_list [3]
;

save_

save_reflns.limit_index_m_4_min

    _definition.id                '_reflns.limit_index_m_4_min'
    _alias.definition_id          '_reflns_limit_index_m_4_min'
    _name.category_id             reflns
    _name.object_id               limit_index_m_4_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_4_min  =  r.limit_index_m_min_list [3]
;

save_

save_reflns.limit_index_m_5_max

    _definition.id                '_reflns.limit_index_m_5_max'
    _alias.definition_id          '_reflns_limit_index_m_5_max'
    _name.category_id             reflns
    _name.object_id               limit_index_m_5_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_5_max  =  r.limit_index_m_max_list [4]
;

save_

save_reflns.limit_index_m_5_min

    _definition.id                '_reflns.limit_index_m_5_min'
    _alias.definition_id          '_reflns_limit_index_m_5_min'
    _name.category_id             reflns
    _name.object_id               limit_index_m_5_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_5_min  =  r.limit_index_m_min_list [4]
;

save_

save_reflns.limit_index_m_6_max

    _definition.id                '_reflns.limit_index_m_6_max'
    _alias.definition_id          '_reflns_limit_index_m_6_max'
    _name.category_id             reflns
    _name.object_id               limit_index_m_6_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_6_max  =  r.limit_index_m_max_list [5]
;

save_

save_reflns.limit_index_m_6_min

    _definition.id                '_reflns.limit_index_m_6_min'
    _alias.definition_id          '_reflns_limit_index_m_6_min'
    _name.category_id             reflns
    _name.object_id               limit_index_m_6_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_6_min  =  r.limit_index_m_min_list [5]
;

save_

save_reflns.limit_index_m_7_max

    _definition.id                '_reflns.limit_index_m_7_max'
    _alias.definition_id          '_reflns_limit_index_m_7_max'
    _name.category_id             reflns
    _name.object_id               limit_index_m_7_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_7_max  =  r.limit_index_m_max_list [6]
;

save_

save_reflns.limit_index_m_7_min

    _definition.id                '_reflns.limit_index_m_7_min'
    _alias.definition_id          '_reflns_limit_index_m_7_min'
    _name.category_id             reflns
    _name.object_id               limit_index_m_7_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_7_min  =  r.limit_index_m_min_list [6]
;

save_

save_reflns.limit_index_m_8_max

    _definition.id                '_reflns.limit_index_m_8_max'
    _alias.definition_id          '_reflns_limit_index_m_8_max'
    _name.category_id             reflns
    _name.object_id               limit_index_m_8_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_8_max  =  r.limit_index_m_max_list [7]
;

save_

save_reflns.limit_index_m_8_min

    _definition.id                '_reflns.limit_index_m_8_min'
    _alias.definition_id          '_reflns_limit_index_m_8_min'
    _name.category_id             reflns
    _name.object_id               limit_index_m_8_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_8_min  =  r.limit_index_m_min_list [7]
;

save_

save_reflns.limit_index_m_9_max

    _definition.id                '_reflns.limit_index_m_9_max'
    _name.category_id             reflns
    _name.object_id               limit_index_m_9_max

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_max}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_9_max  =  r.limit_index_m_max_list [8]
;

save_

save_reflns.limit_index_m_9_min

    _definition.id                '_reflns.limit_index_m_9_min'
    _name.category_id             reflns
    _name.object_id               limit_index_m_9_min

    _import.get
        [{'file':templ_attr.cif  'save':index_limit_min}]

    _method.purpose               Evaluation
    _method.expression
;
       With  r  as  reflns

                   _reflns.limit_index_m_9_min  =  r.limit_index_m_min_list [8]
;

save_

save_reflns.limit_index_m_max_list

    _definition.id                '_reflns.limit_index_m_max_list'
    _definition.update            2024-08-06
    _description.text
;
      Maximum of the additional Miller indices
      appearing in _refln.index_m_. The number of ranges must match
      _cell_modulation_dimension. The order of the additional indices
      must be consistent with the codes given in
      _cell.wave_vector_seq_id. These need not be the same as
      the _reflns.limit_index_m_.
;
    _name.category_id             reflns
    _name.object_id               limit_index_m_max_list
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Integer

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With  r  as  reflns

         temp.limit_index_m_max_list =
                  [ r.limit_index_m_1_max, r.limit_index_m_2_max,
                    r.limit_index_m_3_max, r.limit_index_m_4_max,
                    r.limit_index_m_5_max, r.limit_index_m_6_max,
                    r.limit_index_m_7_max, r.limit_index_m_8_max,
                    r.limit_index_m_9_max ]

         #Not meaningful indices are removed here

         _reflns.limit_index_m_max_list =
             temp.limit_index_m_max_list [0:_cell.modulation_dimension - 1]
;

save_

save_reflns.limit_index_m_min_list

    _definition.id                '_reflns.limit_index_m_min_list'
    _definition.update            2024-08-06
    _description.text
;
      Minimum values of the additional Miller indices
      appearing in _refln.index_m_. The number of ranges must match
      _cell_modulation_dimension. The order of the additional indices
      must be consistent with the codes given in
      _cell.wave_vector_seq_id. These need not be the same as
      the _reflns.limit_index_m_.
;
    _name.category_id             reflns
    _name.object_id               limit_index_m_min_list
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Matrix
    _type.contents                Integer

    loop_
      _method.purpose
      _method.expression
         Definition
;
         With c as cell

         _type.dimension = '[c.modulation_dimension]'
;
         Evaluation
;
         With  r  as  reflns

         temp.limit_index_m_min_list =
                  [ r.limit_index_m_1_min, r.limit_index_m_2_min,
                    r.limit_index_m_3_min, r.limit_index_m_4_min,
                    r.limit_index_m_5_min, r.limit_index_m_6_min,
                    r.limit_index_m_7_min, r.limit_index_m_8_min,
                    r.limit_index_m_9_min ]

         #Not meaningful indices are removed here

         _reflns.limit_index_m_min_list =
            temp.limit_index_m_min_list [0:_cell.modulation_dimension - 1]
;

save_

save_space_group.ssg_it_number

    _definition.id                '_space_group.ssg_IT_number'
    _alias.definition_id          '_space_group_ssg_IT_number'
    _definition.update            2014-06-27
    _description.text
;
      Superspace-group number from International Tables for
      Crystallography, Vol. C (2006). Valid only for one-dimensional
      modulated structures.
      Reference: International Tables for Crystallography (2006). Vol. C,
                 Chapter 9.8. John Wiley & Sons, Ltd.
                 Incommensurate and commensurate modulated structures
;
    _name.category_id             space_group
    _name.object_id               ssg_IT_number
    _type.purpose                 Number
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Real
    _enumeration.range            1.1:

save_

save_space_group.ssg_name

    _definition.id                '_space_group.ssg_name'
    _alias.definition_id          '_space_group_ssg_name'
    _definition.update            2014-06-27
    _description.text
;
      Superspace-group symbol conforming to an alternative definition
      from that given in _space_group_ssg_name_IT and
      _space_group_ssg_name_WJJ for one-dimensional modulated
      structures or to the superspace-group name for higher dimensions.
      When necessary, indicate the origin and the setting. Use a colon
      ':' as a separator between the different parts of the
      superspace-group symbol. Within each part, leave a space
      between each component. Rules for the notation for
      Hermann-Mauguin and Hall symbols (if present) are given in the
      symmetry CIF dictionary (cif_sym.dic) and, partially, in
      _space_group_ssg_name_IT and _space_group_ssg_name_WJJ.
      For composites described in a single data block, the superspace
      group describes the symmetry of the whole structure. The
      symmetry of each subsystem can be derived using the
      appropriate W matrices.
;
    _name.category_id             space_group
    _name.object_id               ssg_name
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text
    _description_example.case     'W:-P -2xb -2ya:q q'
    _description_example.detail   "Hall's notation"

save_

save_space_group.ssg_name_it

    _definition.id                '_space_group.ssg_name_IT'
    _alias.definition_id          '_space_group_ssg_name_IT'
    _definition.update            2014-06-27
    _description.text
;
      Superspace-group symbol as given in International Tables for
      Crystallography, Vol. C (2006). Valid only for one-dimensional
      modulated structures. The symbol is divided into three parts:
      the Hermann-Mauguin space-group symbol of the reference
      structure, the modulation wave vector  and the phase shift
      (or internal translation) associated with each component of
      the space group. Each component of the space-group name is
      separated by a space. Subscripts should appear without special
      symbols and bars should be given as negative signs. The
      components of the modulation wave vector (in parentheses) and
      the phase shifts are also separated by a space. For composites
      described in a single data block, the superspace group
      describes the symmetry of the whole structure. The symmetry
      of each subsystem can be derived using the appropriate W
      matrices.
      Reference: International Tables for Crystallography (2006). Vol. C,
                 Chapter 9.8. John Wiley & Sons, Ltd.
                 Incommensurate and commensurate modulated structures
;
    _name.category_id             space_group
    _name.object_id               ssg_name_IT
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text
    _description_example.case     'P n m a (0 0 \g) 0 s 0'

save_

save_space_group.ssg_name_wjj

    _definition.id                '_space_group.ssg_name_WJJ'
    _alias.definition_id          '_space_group_ssg_name_WJJ'
    _definition.update            2014-06-27
    _description.text
;
      Superspace-group symbol as given by de Wolff, Janssen & Janner
      (1981). Valid only for one-dimensional modulated structures.
      The symbol is divided into three parts separated by colons ':':
      the superspace lattice symbol, the Hermann-Mauguin space-group
      symbol of the reference structure and the phase shift (or
      internal translation) associated with each component of the
      space group. Each component of the space-group name is separated
      by a space. Subscripts should appear without special symbols and
      bars should be given as negative signs. The phase shifts are
      also separated by a space. For composites described in a single
      data block, the superspace group describes the symmetry of the
      whole structure. The symmetry of each subsystem can be derived
      using the appropriate W matrices.
      Reference: Wolff, P. M. de, Janssen, T. & Janner, A. (1981).
                 Acta Cryst. A37, 625-636.
                 The superspace groups for incommensurate crystal
                 structures with a one-dimensional modulation
;
    _name.category_id             space_group
    _name.object_id               ssg_name_WJJ
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text
    _description_example.case     'P:P c m n:s s -1'

save_

save_space_group.ssg_wjj_code

    _definition.id                '_space_group.ssg_WJJ_code'
    _alias.definition_id          '_space_group_ssg_WJJ_code'
    _definition.update            2014-06-27
    _description.text
;
      Superspace-group code as given by de Wolff, Janssen & Janner
      (1981). Valid only for one-dimensional modulated structures.
      Reference: Wolff, P. M. de, Janssen, T. & Janner, A. (1981).
                 Acta Cryst. A37, 625-636.
                 The superspace groups for incommensurate crystal
                 structures with a one-dimensional modulation
;
    _name.category_id             space_group
    _name.object_id               ssg_WJJ_code
    _type.purpose                 Describe
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Text
    _description_example.case     28a.10.1/2

save_

save_SPACE_GROUP_SYMOP

    _definition.id                SPACE_GROUP_SYMOP
    _definition.scope             Category
    _definition.class             Loop
    _definition.update            2024-08-09
    _description.text
;
      The SPACE_GROUP_SYMOP category introduced in the symmetry CIF
      dictionary (cif_sym.dic) is intended to replace the original
      core SYMMETRY_EQUIV category. It contains information about the
      symmetry operations of the space group. For modulated structures,
      superspace-group descriptions may be included in the same
      category, but include the _ssg_ flag to indicate their
      dimensionality of > 3.
;
    _name.category_id             CIF_MS_HEAD
    _name.object_id               SPACE_GROUP_SYMOP
    _category_key.name            '_space_group_symop.ssg_id'
    _description_example.case
;
    #\#CIF_2.0

    # - - - - data truncated for brevity - - - -

    _space_group.crystal_system              trigonal
    _space_group.ssg_name                    'R-3m(00\g)0s'

    loop_
     _space_group_symop.ssg_id
     _space_group_symop.ssg_operation_algebraic
     1  x1,x2,x3,x4
     2  -x2,x1-x2,x3,x4
     3  -x1+x2,-x1,x3,x4
     4  x2,x1,-x3,-x4+1/2
     5  x1-x2,-x2,-x3,-x4+1/2
     6  -x1,-x1+x2,-x3,-x4+1/2
     7  -x1,-x2,-x3,-x4
     8  x2,-x1+x2,-x3,-x4
     9  x1-x2,x1,-x3,-x4
     10 -x2,-x1,x3,x4+1/2
     11 -x1+x2,x2,x3,x4+1/2
     12 x1,x1-x2,x3,x4+1/2
     13 x1+2/3,x2+1/3,x3+1/3,x4
     14 -x2+2/3,x1-x2+1/3,x3+1/3,x4
     15 -x1+x2+2/3,-x1+1/3,x3+1/3,x4
     16  x2+2/3,x1+1/3,-x3+1/3,-x4+1/2
     17  x1-x2+2/3,-x2+1/3,-x3+1/3,-x4+1/2
     18 -x1+2/3,-x1+x2+1/3,-x3+1/3,-x4+1/2
     19 -x1+2/3,-x2+1/3,-x3+1/3,-x4

    # - - - - data truncated for brevity - - - -

    #=======================================================================

    Example based on the article: O. Gourdon, V. Petricek, M. Dusek,
    P. Bezdicka, S.  Durovic, D. Gyepesovad and M. Evain (1999) Acta
    Cryst. B55, 841-848. doi:10.1107/S0108768199006485 Determination
    of the modulated structure of Sr~14/11~CoO~3~ through a (3 +
    1)-dimensional space description and using non-harmonic ADPs
;

save_

save_space_group_symop.ssg_id

    _definition.id                '_space_group_symop.ssg_id'
    _alias.definition_id          '_space_group_symop_ssg_id'
    _definition.update            2014-06-27
    _description.text
;
      A numeric code identifying each entry in the
      _space_group_symop_ssg_operation_algebraic list.
;
    _name.category_id             space_group_symop
    _name.object_id               ssg_id
    _type.purpose                 Key
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

save_

save_space_group_symop.ssg_operation_algebraic

    _definition.id                '_space_group_symop.ssg_operation_algebraic'
    _alias.definition_id          '_space_group_symop_ssg_operation_algebraic'
    _definition.update            2014-06-27
    _description.text
;
      A parsable string giving one of the symmetry operations of the
      superspace group in algebraic form. These data will generally be
      repeated in a loop. Use symbols as necessary according to
      _cell_modulation_dimension.
      All symmetry operations should be entered, including the
      identity operation, those for lattice centring and that for
      a centre of symmetry, if present. The symbolic notation for
      coordinates is such that the identity operation is expressed
      as x1,x2,x3,...,xn.

      _space_group_symop_ssg_operation_algebraic must always be present
      in a CIF corresponding to a modulated structure.
;
    _name.category_id             space_group_symop
    _name.object_id               ssg_operation_algebraic
    _type.purpose                 Composite
    _type.source                  Assigned
    _type.container               Single
    _type.contents                Code

save_

    loop_
      _dictionary_audit.version
      _dictionary_audit.date
      _dictionary_audit.revision
         3.0.0                    2014-06-27
;
       Initial conversion to DDLm (Syd Hall)
;
         3.1.0                    2016-11-17
;
       Substantial edits to conform to current DDLm, CIF2 syntax
       (James Hester).
;
         3.2.0                    2017-03-11
;
       Returned all additional indices to main dictionary, removed
       category_id from templates(James Hester)
;
         3.2.1                    2019-09-25
;
       Corrected a typo in the definition of the _geom_torsion.angle
       data item.

       Changed the content type of multiple data items from 'Count' to
       'Integer' and assigned the appropriate enumeration range if
       needed.
;
         3.2.2                    2022-01-15
;
       Corrected some typos in *.id data items, they included a
       trailing blank.  Changed
       save_save_geom_angle.site_ssg_symmetry_1 to
       save_geom_angle.site_ssg_symmetry_1 Changed
       _atom_site_sites_axes.matrix_seq_id to
       _atom_sites_axes.matrix_seq_id
;
         3.2.3                    2023-07-08
;
       Added for completitude _atom_site_rot_Fourier.id as the key for
       the category _ATOM_SITE_ROT_FOURIER.
;
         3.2.4                    2024-12-12
;
        Added for back compatibility:

        _cell.commen_supercell_matrix_1_1 to _cell.commen_supercell_matrix_3_3.
         Aliased to _jana_cell_commen_supercell_matrix_ tags.

        _atom_site_Fourier_wave_vector.q1_coeff to
         _atom_site_Fourier_wave_vector.q3_coeff (These tags are also
         present in cif_mag.dic) Aliased to
         _jana_atom_site_Fourier_wave_vector_q1_coeff, etc.

         Added the aliases:

        _jana_atom_site_crenel_ortho_func_c
        _jana_atom_site_crenel_ortho_func_eps
        _jana_atom_site_crenel_ortho_func_w
        _jana_atom_site_displace_crenel_ortho_atom_site_label
        _jana_atom_site_displace_crenel_ortho_axis
        _jana_atom_site_displace_crenel_ortho_id
        _jana_atom_site_displace_crenel_ortho_param_coeff
        _jana_atom_site_displace_Legendre_atom_site_label
        _jana_atom_site_displace_Legendre_axis
        _jana_atom_site_displace_Legendre_param_order
        _jana_atom_site_displace_Legendre_param_coeff
        _jana_atom_site_occ_crenel_ortho_atom_site_label
        _jana_atom_site_occ_crenel_ortho_id
        _jana_atom_site_occ_crenel_ortho_param_coeff
        _jana_atom_site_occ_Legendre_atom_site_label
        _jana_atom_site_occ_Legendre_param_order
        _jana_atom_site_occ_Legendre_param_coeff
        _jana_atom_site_U_crenel_ortho_atom_site_label
        _jana_atom_site_U_crenel_ortho_tens_elem
        _jana_atom_site_U_crenel_ortho_id
        _jana_atom_site_U_crenel_ortho_param_coeff
        _jana_atom_site_U_Legendre_atom_site_label
        _jana_atom_site_U_Legendre_tens_elem
        _jana_atom_site_U_Legendre_param_order
        _jana_atom_site_U_Legendre_param_coeff
        _jana_atom_site_displace_XHarm_site_label
        _jana_atom_site_displace_XHarm_axis
        _jana_atom_site_displace_XHarm_param_order
        _jana_atom_site_displace_XHarm_param_coeff
        _jana_atom_site_occ_XHarm_atom_site_label
        _jana_atom_site_occ_XHarm_param_order
        _jana_atom_site_occ_XHarm_param_coeff
        _jana_atom_site_U_XHarm_atom_site_label
        _jana_atom_site_U_XHarm_tens_elem
        _jana_atom_site_U_XHarm_param_order
        _jana_atom_site_U_XHarm_param_coeff

        Added units (cycles) to:

        _atom_site_displace_special_func.sawtooth_c
        _atom_site_displace_special_func.sawtooth_w
        _atom_site_displace_special_func.zigzag_c
        _atom_site_displace_special_func.zigzag_w
        _atom_site_occ_special_func.crenel_c
        _atom_site_occ_special_func.crenel_w
        _atom_sites_modulation.global_phase_list
        _atom_sites_modulation.global_phase_t_

        Added units (none) to:

        _atom_site_displace_Fourier_param.cos
        _atom_site_displace_Fourier_param.modulus
        _atom_site_displace_Fourier_param.sin
        _atom_site_displace_Legendre.coeff
        _atom_site_displace_special_func.sawtooth
        _atom_site_displace_special_func.sawtooth_axyz
        _atom_site_displace_special_func.sawtooth_ax
        _atom_site_displace_special_func.sawtooth_ay
        _atom_site_displace_special_func.sawtooth_az
        _atom_site_displace_special_func.zigzag_axyz
        _atom_site_displace_xharm.coeff
        _atom_site_occ_Fourier_param.cos
        _atom_site_occ_Fourier_param.modulus
        _atom_site_occ_Fourier_param.sin
        _atom_site_occ_Legendre.coeff
        _atom_site_occ_xharm.coeff
        _atom_site_phason.coeff OJO
        _cell_wave_vector.x
        _cell_wave_vector.xyz
        _cell_wave_vector.y
        _cell_wave_vector.z

        Added the SU items:

        _atom_site_displace_Fourier_param.cos_su
        _atom_site_displace_Fourier_param.modulus_su
        _atom_site_displace_Fourier_param.sin_su
        _atom_site_displace_Legendre.coeff_su
        _atom_site_displace_ortho.coeff_su
        _atom_site_displace_special_func.sawtooth_su
        _atom_site_displace_special_func.sawtooth_axyz_su
        _atom_site_displace_special_func.sawtooth_ax_su
        _atom_site_displace_special_func.sawtooth_ay_su
        _atom_site_displace_special_func.sawtooth_az_su
        _atom_site_displace_special_func.sawtooth_c_su
        _atom_site_displace_special_func.sawtooth_w_su
        _atom_site_displace_special_func.zigzag_axyz_su
        _atom_site_displace_special_func.zigzag_c_su
        _atom_site_displace_special_func.zigzag_w_su
        _atom_site_displace_xharm.coeff_su
        _atom_site_occ_Fourier_param.cos_su
        _atom_site_occ_Fourier_param.modulus_su
        _atom_site_occ_Fourier_param.sin_su
        _atom_site_occ_Legendre.coeff_su
        _atom_site_occ_ortho.coeff_su
        _atom_site_occ_special_func.crenel_c_su
        _atom_site_occ_special_func.crenel_w_su
        _atom_site_occ_xharm.coeff_su
        _atom_site_phason.coeff_su OJO
        _atom_site_rot_Fourier_param.cos_su
        _atom_site_rot_Fourier_param.modulus_su
        _atom_site_rot_Fourier_param.sin_su
        _atom_site_rot_Legendre.coeff_su
        _atom_site_rot_ortho.coeff_su
        _atom_site_rot_special_func.sawtooth_su
        _atom_site_rot_special_func.sawtooth_axyz_su
        _atom_site_rot_special_func.sawtooth_ax_su
        _atom_site_rot_special_func.sawtooth_ay_su
        _atom_site_rot_special_func.sawtooth_az_su
        _atom_site_rot_special_func.sawtooth_c_su
        _atom_site_rot_special_func.sawtooth_w_su
        _atom_site_rot_special_func.zigzag_axyz_su
        _atom_site_rot_special_func.zigzag_c_su
        _atom_site_rot_special_func.zigzag_w_su
        _atom_site_rot_xharm.coeff_su
        _atom_site_U_Fourier_param.cos_su
        _atom_site_U_Fourier_param.modulus_su
        _atom_site_U_Fourier_param.sin_su
        _atom_site_U_Legendre.coeff_su
        _atom_site_U_ortho.coeff_su
        _atom_site_U_xharm.coeff_su
        _cell_wave_vector.x_su
        _cell_wave_vector.xyz_su
        _cell_wave_vector.y_su
        _cell_wave_vector.z_su
        _cell_wave_vectors.pressure_max_su
        _cell_wave_vectors.pressure_min_su
        _cell_wave_vectors.temp_max_su
        _cell_wave_vectors.temp_min_su
        _geom_angle.av_su
        _geom_angle.max_su
        _geom_angle.min_su
        _geom_bond.distance_av_su
        _geom_bond.distance_max_su
        _geom_bond.distance_min_su
        _geom_contact.distance_av_su
        _geom_contact.distance_max_su
        _geom_contact.distance_min_su
        _geom_torsion.av_su
        _geom_torsion.max_su
        _geom_torsion.min_su

        Added a complete description (including modulation) of the Gram-Charlier
        expansion (up to 6th order) describing anharmonic ADPs. Too long
        to list here.

        Examples added to categories:

        ATOM_SITE_DISPLACE_FOURIER
        ATOM_SITE_DISPLACE_LEGENDRE
        ATOM_SITE_DISPLACE_ORTHO
        ATOM_SITE_OCC_FOURIER
        ATOM_SITE_ROT_FOURIER
        ATOM_SITE_U_FOURIER

        2024-04-28:
        Removed _enumeration_default for _atom_site_Fourier_wave_vector.seq_id.
        It is a key for loops of the category _ATOM_SITE_FOURIER_WAVE_VECTOR,
        so it must be always present.

        Where appropriate, _type.contents of numeric codes, changed from Code
        to Integer.

        Added the average, maximum and minimum distances within the categories
        GEOM_ANGLE and GEOM_TORSION.

        2024-04-29:
        Added _atom_site_Fourier_wave_vector.q1_coeff_seq_id,
        _atom_site_Fourier_wave_vector.q2_coeff_seq_id and
        _atom_site_Fourier_wave_vector.q3_coeff_seq_id

        Without these items _atom_site_Fourier_wave_vector.q1_coeff, etc. are
        sensitive to the order of _cell_wave_vector_ irrespective of the
        values of _cell_wave_vector_seq_id.

        2024-05-05:
        _name.object_id changed in some data names belonging to the GEOM_
        categories, according to the definitions in cif_core.

        Extended to 8, for consistency, the number of components in
        _atom_site_Fourier_wave_vector.q_coeff_seq_id and
        _atom_site_Fourier_wave_vector.q_coeff.

        2024-05-06:
        Revision of the examples syntax.

        2024-07-26:
        Revision of methods syntax
        Minor updates of some tags. _definition.update modified in
        templ_attr.cif file.

        2024-07-27:
        Revision of the definitions of transformed axes for translations and
        rotations

        Added GEOM_HBOND category.

        2024-07-28:
        Added category.id to the individual elements of the W matrix, as it has
        been removed from templ_attr.cif (1.4.11)

        Modified the functions Sawtooth and Zigzag, to cover translations and
        rotations

        2024-07-31:
        Added  _import.get  [{"file":'templ_attr.cif' "save":'general_su'}] to
        all single SU items.

        Common attributes of *.matrix_seq_id items included in templ_attr.cif
        file, in save_transf_matrix_id

        Common attributes of modulation parameters items included in
        templ_attr.cif file, in save_general_mod_param

        Large rewording of _description.text of many items to avoid excesive
        verbosity.

        Modified the definitions of GEOM_HBOND category, according the the core.

        2024-08-01:
        Deployment of the new save frames of templ_attr.cif.

        2024-08-06:
        Added the categories:
        ATOM_SITE_ANHARMONIC_ADP
        ATOM_SITE_ANHARMONIC_ADP_FOURIER
        ATOM_SITE_ANHARMONIC_ADP_FOURIER_PARAM
        ATOM_SITE_ANHARMONIC_ADP_LEGENDRE
        ATOM_SITE_ANHARMONIC_ADP_ORTHO
        ATOM_SITE_ANHARMONIC_ADP_XHARM

        Common attributes of *.ssg_symmetry_ items included in templ_attr.cif
        file, in save_site_ssg_symmetry

        Common attributes of _atom_site_Fourier_wave_vector.q_coeff
        and _atom_site_Fourier_wave_vector.q_coeff_seq_id items
        included in templ_attr.cif file, in save_q_coeff_element and
        save_q_coeff_seq_element, respectively.

        Changed _type.container List to Matrix to reinforce the
        numeric contents.  The fixed upper limit of dimensions, is
        calculated trough methods, where necessary, defining
        _type.dimension in terms of _cell.modulation_dimension.

        Affected items:

        _atom_site_Fourier_wave_vector.q_coeff,
        _atom_site_Fourier_wave_vector.q_coeff_seq_id,
        _atom_sites_modulation.global_phase_list, _cell_subsystem.matrix_W,
        _diffrn_refln.index_m_list, _diffrn_reflns.limit_index_m_max_list,
        _diffrn_reflns.limit_index_m_min_list, _exptl_crystal_face.index_m_list,
        _refln.index_m_list, _reflns.limit_index_m_max_list and
        _reflns.limit_index_m_min_list

        Changed _type.purpose to Number (it was erroneusly assigned to Key) in
        the following items:

        _atom_site_displace_Legendre.order', _atom_site_displace_xharm.order,
        _atom_site_occ_Legendre.order, _atom_site_occ_xharm.order,
        _atom_site_rot_Legendre.order, _atom_site_rot_xharm.order,
        _atom_site_U_Legendre.order,_atom_site_U_xharm.order

        2024-08-07
        Removed methods for _atom_site_displace_special_func.sawtooth,
        _atom_site_displace_special_func.zigzag,
        _atom_site_rot_special_func.sawtooth,
        _atom_site_rot_special_func.zigzag and
        _atom_site_occ_special_func.crenel.
        Evaluation methods compute missing tags in terms of present tags,
        never define functions of undefined variables...

        Now the attributes of those items are:
        _type_purpose    Describe
        _type_source     Recorded
        _type.container  Single
        _type.contents   Text

        Revised the common exampe of categories ATOM_SITE_ROT_FOURIER and
        ATOM_SITE_ROT_FOURIER_PARAM. Now translations are fractions of the
        axes.

        2024-08-09
        Changed MS_GROUP to CIF_MS_HEAD.

        2024-12-12
        Technical fixes (JRH)
;
